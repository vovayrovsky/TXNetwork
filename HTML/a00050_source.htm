<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>TXNetwork: Исходный файл TXLib.h</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="Doxyfile.css" rel="stylesheet" type="text/css" />
<link href="Doxyfile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TXNetwork
   &#160;<span id="projectnumber">v. 0.5.1a</span>
   </div>
   <div id="projectbrief">&nbsp;ALL? Windows network in a sandbox :)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.8.10 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00050_source.htm','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Example04/TXLib.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//           [These sections are for folding control  in Code::Blocks]</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//{          [Best viewed with &quot;Fold all on file open&quot; option enabled]             [best screen width is 115 chars]</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span><span class="comment">//           $Copyright: (C) Ded (Ilya Dedinsky, http://txlib.ru) &lt;mail@txlib.ru&gt; $</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span><span class="comment">//}</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#if !defined (__TXLIB_H_INCLUDED)                // &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; The code is here, unfold it &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#define       __TXLIB_H_INCLUDED</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//{          Version information</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#define _TX_V_FROM_CVS(_1,file,ver,rev,date,auth,_2)  &quot;TXLib [Ver: &quot; #ver &quot;, Rev: &quot; #rev &quot;]&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#define _TX_A_FROM_CVS(_1,file,ver,rev,date,auth,_2)  &quot;Copyright (C) &quot; auth</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#define _TX_v_FROM_CVS(_1,file,ver,rev,date,auth,_2)  ((0x##ver &lt;&lt; 16) | 0x##rev)</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">   82</a></span>&#160;<span class="preprocessor">#define _TX_VERSION           _TX_V_FROM_CVS ($VersionInfo: , TXLib.h, 00173a, 105, 2014-08-09 16:37:26 +0400, &quot;Ded (Ilya Dedinsky, http://txlib.ru) &lt;mail@txlib.ru&gt;&quot;, $)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#define _TX_AUTHOR            _TX_A_FROM_CVS ($VersionInfo: , TXLib.h, 00173a, 105, 2014-08-09 16:37:26 +0400, &quot;Ded (Ilya Dedinsky, http://txlib.ru) &lt;mail@txlib.ru&gt;&quot;, $)</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="a00064.htm#ga6b76c63cd895c2be63ac8e690028623b">  105</a></span>&#160;<span class="preprocessor">#define _TX_VER               _TX_v_FROM_CVS ($VersionInfo: , TXLib.h, 00173a, 105, 2014-08-09 16:37:26 +0400, &quot;Ded (Ilya Dedinsky, http://txlib.ru) &lt;mail@txlib.ru&gt;&quot;, $)</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//{          Compiler- and platform-specific</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span><span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#if !defined (__cplusplus)</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">    #ifdef __GNUC__</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">    #error TXLib.h: Must use C++ to compile TXLib.h.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">    #error CHECK source file EXTENSION. Maybe it is &quot;.C&quot;. It must be &quot;.CPP&quot;.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">    #error If your file is named, for example, &quot;Untitled.C&quot;, go to menu [File], then</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">    #error then [Save As] and rename it to &quot;Untitled.CPP&quot;. Please do NOT use spaces.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#if !defined (WIN32) &amp;&amp; !defined (__WIN32__) &amp;&amp; !defined(_WIN32) &amp;&amp; !defined(_WIN32_WINNT)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">    #ifdef __GNUC__</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">    #error TXLib.h: Windows (MSVC/Win32 or GCC/MinGW) is the only supported system, sorry.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">    #error In Linux or iOS, you should write your own TXLib and share it with your friends,</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">    #error or use wine.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#if  defined (UNICODE) || defined (_UNICODE)</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">    #ifdef __GNUC__</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">    #warning TXLib.h: Disabling the UNICODE</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">    #undef   UNICODE                            // Burn Unicode, burn</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">    #undef  _UNICODE</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">    #if defined (_WINDOWS_H) || defined (_INC_WINDOWS) || defined (_WINDOWS_) || defined (__WINDOWS__)</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">    #ifdef __GNUC__</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">    #error TXLib.h: Should include &quot;TXLib.h&quot; BEFORE or INSTEAD of &lt;Windows.h&gt; in UNICODE mode.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">    #error REARRANGE your #include directives, or DISABLE the UNICODE mode.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#if  defined (__STRICT_ANSI__)                   // Try to extend strict ANSI rules</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">    #undef  __STRICT_ANSI__</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">    #define __STRICT_ANSI__UNDEFINED</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">    #if defined (_STRING_H_) || defined (_INC_STRING) || defined (_STDIO_H_) || defined (_INC_STDIO)</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">    #ifdef __GNUC__</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">    #error TXLib.h: Should include &quot;TXLib.h&quot; BEFORE &lt;string.h&gt; or &lt;stdio.h&gt; in Strict ANSI mode.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">    #error REARRANGE your #include directives, or DISABLE ANSI-compliancy.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">    #error --------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">    #error</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#if  defined (__GNUC__)</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">    #define _GCC_VER                ( __GNUC__*100 + __GNUC_MINOR__*10 + __GNUC_PATCHLEVEL__ )</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">    #if (_GCC_VER &gt;= 420)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wall&quot;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Weffc++&quot;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wextra&quot;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wcast-align&quot;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wcast-qual&quot;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wchar-subscripts&quot;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wconversion&quot;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wctor-dtor-privacy&quot;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wempty-body&quot;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wfloat-equal&quot;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wformat-nonliteral&quot;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wformat-security&quot;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wformat&quot;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wlogical-op&quot;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wmissing-declarations&quot;</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wnon-virtual-dtor&quot;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Woverloaded-virtual&quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wpacked&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wpointer-arith&quot;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wredundant-decls&quot;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wshadow&quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wsign-promo&quot;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wstrict-aliasing&quot;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wstrict-null-sentinel&quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wstrict-overflow&quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wswitch-default&quot;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wswitch-enum&quot;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wsync-nand&quot;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wundef&quot;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wunused&quot;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wvariadic-macros&quot;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Winline&quot;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wmissing-field-initializers&quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wold-style-cast&quot;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wunreachable-code&quot;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wunused-function&quot;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">        #if (_GCC_VER &gt;= 461)</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wsuggest-attribute=noreturn&quot;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">        #if (_GCC_VER &gt;= 471)</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wnarrowing&quot;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">        #if (_GCC_VER &gt;= 472)</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wliteral-suffix&quot;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">        #if (_GCC_VER &gt;= 481)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Waggressive-loop-optimizations&quot;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wvarargs&quot;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">        #if (_GCC_VER &gt;= 510)</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wconditionally-supported&quot;</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wformat-signedness&quot;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wopenmp-simd&quot;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wsuggest-final-methods&quot;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wsuggest-final-types&quot;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic warning &quot;-Wsuggest-override&quot;</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="comment">// These warning settings for TXLib.h only and will be re-enabled at end of file:</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">        #if (_GCC_VER &gt;= 460)</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">        #pragma GCC push_options</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">        #pragma GCC optimize           &quot;O3&quot;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">        #pragma GCC optimize           &quot;no-strict-aliasing&quot;</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wnon-virtual-dtor&quot;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wshadow&quot;</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wsign-conversion&quot;</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wstrict-aliasing&quot;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">        #pragma GCC diagnostic ignored &quot;-Wunused-label&quot;    // Just for fun in _txCanvas_OnCmdAbout()</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">    #if (_GCC_VER &gt;= 420)</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">        #define _tx_thread          __thread</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">        #define _tx_thread</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">    #if (_GCC_VER &gt;= 472)</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">        #define _tx_explicit        explicit</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">        #define _tx_override        override</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">        #if !defined (_TX_TESTING)                         // This is not a fair play, but this pragma is the only way to clear the</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">        #pragma GCC system_header                          // &quot;override controls (override/final) only available with -std=c++11</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">        #endif                                             // or -std=gnu++11&quot; warning when -std=... command line option is not set.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">        #define _tx_explicit</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">        #define _tx_override</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">    #define _TX_CHECK_FORMAT( arg )  __attribute__ (( format (printf, (arg), (arg)+1) ))</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">inline</span> T _txNOP (T value)       { <span class="keywordflow">return</span> value; }  <span class="comment">// To suppress performance warnings in assert etc</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// From MinGW\include\float.h which is replaced by MinGW\lib\gcc\i686-pc-mingw32\x.x.x\include\float.h</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> __declspec (dllimport) unsigned <span class="keywordtype">int</span> __cdecl _controlfp (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> unNew, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> unMask);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    extern &quot;C&quot;                        <span class="keywordtype">void</span>         __cdecl _fpreset   (<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">    #define _TX_CHECK_FORMAT( arg )</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">    #define _txNOP( value )         ( value )</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#if  defined (_MSC_VER)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4616)             // #pragma warning : warning number &#39;n&#39; out of range, must be between &#39;4001&#39; and &#39;4999&#39;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">    #pragma warning (disable: 5032)             // detected #pragma warning (push) with no corresponding #pragma warning (pop)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">    #pragma warning (push, 4)                   // Set maximum warning level. This &#39;push&#39; is to set the level only. It will NOT be popped.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4514)             // unreferenced inline function has been removed</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4710)             // function not inlined</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4786)             // identifier was truncated to &#39;255&#39; characters in the debug information</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// These warning settings for TXLib.h only and will be re-enabled at end of file:</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">    #pragma warning (push)</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4619)             // #pragma warning: there is no warning number &#39;n&#39;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4127)             // conditional expression is constant</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4351)             // new behavior: elements of array will be default initialized</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4702)             // unreachable code</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4481)             // nonstandard extension used: override specifier &#39;override&#39;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">    #pragma warning (disable: 4702)             // unreachable code</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">    #define _tx_thread              __declspec (thread)</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">    #if  (_MSC_VER == 1200)                     // MSVC 6 (1998)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">        #define _MSC_VER_6                      // Flag the bad dog</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">        #pragma warning (disable: 4511)         // copy constructor could not be generated</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">        #pragma warning (disable: 4512)         // assignment operator could not be generated</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">        #pragma warning (disable: 4514)         // unreferenced inline function has been removed</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor">        #pragma warning (disable: 4663)         // C++ language change: to explicitly specialize class template</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">        #pragma warning (disable: 4710)         // function not inlined</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">        #pragma warning (disable: 4786)         // identifier was truncated to &#39;255&#39; characters in the debug information</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">        #if !defined (WINVER)</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">            #define   WINVER        0x0400      // MSVC 6: Defaults to Windows 95</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">        #if !defined (NDEBUG)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">            #define _CRTDBG_MAP_ALLOC 1         // Set debug mode heap allocation</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">        #define AC_SRC_ALPHA          0x01      // Copied from Windows SDK 7.0a.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">    #if (_MSC_VER &gt;= 1400)                      // MSVC 8 (2005) or greater</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">        #pragma warning (disable: 26135)            // missing locking annotation</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">        #pragma warning (disable: 28125)            // the function must be called from within a try/except block</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">        #pragma warning (disable: 28159)            // consider using another function instead</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">        #pragma setlocale           (&quot;russian&quot;) // Set source file encoding, see also _TX_CP</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">        #if !defined (NDEBUG)</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">            #pragma check_stack     (on)        // Turn on stack probes at runtime</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">            #pragma strict_gs_check (push, on)  // Detects stack buffer overruns</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">        #define _CRT_SECURE_CPP_OVERLOAD_SECURE_NAMES 1</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">        #define _TX_TRUNCATE        , _TRUNCATE</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">        #define _tx_explicit        explicit</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">        #define _tx_override        override</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">        #define _tx_explicit</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">        #define _tx_override</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#if !(defined (_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1400))</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">    #define  strcpy_s               strcpy      // MSVC prior to 8 (2005) versions and GCC</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">    #define  strncpy_s              strncpy     //   do NOT have secure variants of these</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">    #define  strncat_s              strncat     //   functions, so use insecure ones.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">    #define  wcsncpy_s              wcsncpy     //   ...</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="preprocessor">    #define _snprintf_s            _snprintf    //</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">    #define _vsnprintf_s           _vsnprintf   //</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor">    #define  strerror_s(   buf, code )              (              strncpy  ((buf), strerror ((int)(code)), sizeof(buf)-1) )</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">    #define  getenv_s( sz, buf, sizeof_buf, name )  ( (void)(sz),  strncpy  ((buf), getenv (name),         (sizeof_buf)-1) )</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">    #define  strtok_s(     buf, delim, ctx )        ( (void)(ctx), strtok   ((buf), (delim)) )</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">    #define  fopen_s(  file, name, mode )           ( *(file) = fopen ((name), (mode)) )</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">    #if !( defined (_GCC_VER) &amp;&amp; (_GCC_VER &gt;= 510) &amp;&amp;  defined (__x86_64__) )  // At least GCC 5.1.0 x64 already has it</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor">    #define  ctime_s( buf, sizeof_buf, time )       ( strncpy ((buf), ctime (time), (sizeof_buf)-1) )</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">    #if !( defined (_GCC_VER) &amp;&amp; (_GCC_VER &gt;= 471) &amp;&amp;  defined (__x86_64__) )  // At least GCC 4.7.1 x64 already has it</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">    #define _controlfp_s( oldCtl, newCtl, mask )    ( *(oldCtl) = _controlfp (newCtl, mask), 0 )</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">    #define _TX_TRUNCATE</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor">#if  defined (__INTEL_COMPILER)</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">    #pragma warning (disable:  174)             // remark: expression has no effect</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">    #pragma warning (disable:  304)             // remark: access control not specified (&quot;public&quot; by default)</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">    #pragma warning (disable:  444)             // remark: destructor for base class &quot;...&quot; is not virtual</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">    #pragma warning (disable:  522)             // remark: function &quot;...&quot; redeclared &quot;inline&quot; after being called</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">    #pragma warning (disable:  981)             // remark: operands are evaluated in unspecified order</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">    #pragma warning (disable: 1684)             // conversion from pointer to same-sized integral type (potential portability problem)</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#if !defined (WINVER)</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">    #define   WINVER                0x0500      // Defaults to Windows 2000</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor">    #define   WINDOWS_ENABLE_CPLUSPLUS          // Allow use of type-limit macros in &lt;basetsd.h&gt;,</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">#endif                                          //   they allowed by default if WINVER &gt;= 0x0600.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor">#if !defined (_WIN32_WINNT)</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">    #define   _WIN32_WINNT          WINVER      // Defaults to the same as WINVER</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">#if !defined (_WIN32_IE)</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">    #define   _WIN32_IE             WINVER      // Defaults to the same as WINVER</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#define _USE_MATH_DEFINES                       // math.h&#39;s M_PI etc.</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keyword">namespace </span><a class="code" href="a00057.htm">std</a> { <span class="keyword">enum</span> nomeow_t { nomeow }; }     <span class="comment">// Vital additions to C++ standard. Should contact C++ std committee.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">//{          The Includes</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">#ifdef _MSC_VER_6</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">    #pragma warning (push, 3)                   // MSVC 6: At level 4, some std headers emit warnings O_o</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">#include &lt;io.h&gt;</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor">#include &lt;direct.h&gt;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#include &lt;process.h&gt;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">#include &lt;locale.h&gt;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#include &lt;float.h&gt;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#include &lt;exception&gt;</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor">#include &lt;conio.h&gt;</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#include &lt;windows.h&gt;</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">#include &lt;tlhelp32.h&gt;</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#include &lt;shellapi.h&gt;</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor">#if  defined (_MSC_VER)</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#pragma warning (disable: 6001)                 // Uninitialized variable usage &quot;*ppidls&quot;</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">#include &lt;shlobj.h&gt;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#if  defined (_MSC_VER)</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor">#pragma warning (default: 6001)                 // Uninitialized variable usage &quot;*ppidls&quot;</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">#if defined (_MSC_VER)</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#include &lt;crtdbg.h&gt;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#ifdef _MSC_VER_6</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">    #pragma warning (pop)                       // MSVC 6: Restore max level</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">#ifdef __STRICT_ANSI__UNDEFINED</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">    #define  __STRICT_ANSI__                    // Redefine back</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">//{          The namespaces</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">#ifdef FOR_DOXYGEN_ONLY</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword">namespace </span>{ <span class="keyword">namespace </span><a class="code" href="a00058.htm">TX</a> { }}</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="keyword">namespace </span>{ <span class="keyword">namespace </span><a class="code" href="a00058.htm">TX</a> {                       <span class="comment">// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; The main code is here, unfold it &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">//{          TXLIB INTERFACE</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//           Интерфейс библиотеки</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">//{          Initialization</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;HWND <a class="code" href="a00059.htm#gafce21ce98474d5559f316b3d47cdbfab">txCreateWindow</a> (<span class="keywordtype">double</span> sizeX, <span class="keywordtype">double</span> sizeY, <span class="keywordtype">bool</span> centered = <span class="keyword">true</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keyword">inline</span> HDC&amp; <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keywordtype">bool</span> forced = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga96652018e2f835ab629ddf52c1686d67">txSetDefaults</a> (HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga6971b22d5486b242e20a8dea1f21422a">txOK</a>();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;POINT <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#gaf8a8dcec482504bdc989fd1d9fc2f1d5">txGetExtentX</a> (HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#ga6f5e36abe5f158a1b0a47e69c480f493">txGetExtentY</a> (HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keyword">inline</span> HWND <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>();</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="a00059.htm#ga0fc0db1a7c287bec31625bdf3a21922e">txVersion</a>();</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#gacd2416cd6b89106ab6700d0c75922bee">txVersionNumber</a>();</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a> (<span class="keywordtype">bool</span> fileNameOnly = <span class="keyword">true</span>);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">//{          Setting the parameters</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="keyword">const</span> COLORREF</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">#ifdef FOR_DOXYGEN_ONLY</span></div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="a00059.htm#ga3e94cfad3d9080241f84129d6e5c09b5">  844</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="a00059.htm#ga3e94cfad3d9080241f84129d6e5c09b5">txColors</a> {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a9f0adfcb24eeb418fc39fe950db65ec8">  847</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a9f0adfcb24eeb418fc39fe950db65ec8">TX_BLACK</a>         = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (  0,   0,   0),   </div>
<div class="line"><a name="l00848"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aac23422a0b96bfc917484ba1fb0990de">  848</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aac23422a0b96bfc917484ba1fb0990de">TX_BLUE</a>          = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (  0,   0, 128),   </div>
<div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aa13a0e0eb4587540bd06cb5d55083032">  849</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aa13a0e0eb4587540bd06cb5d55083032">TX_GREEN</a>         = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (  0, 128,   0),   </div>
<div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a3f59cd6ad2f1c2cea3f1b4f93baae64d">  850</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a3f59cd6ad2f1c2cea3f1b4f93baae64d">TX_CYAN</a>          = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (  0, 128, 128),   </div>
<div class="line"><a name="l00851"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a342ad901a39ab4b40f091f6699b64927">  851</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a342ad901a39ab4b40f091f6699b64927">TX_RED</a>           = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (128,   0,   0),   </div>
<div class="line"><a name="l00852"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aec305e1fce8a99fca3c442364389e22b">  852</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aec305e1fce8a99fca3c442364389e22b">TX_MAGENTA</a>       = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (128,   0, 128),   </div>
<div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ad71bcc76691c708c653567bc70129e4b">  853</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ad71bcc76691c708c653567bc70129e4b">TX_BROWN</a>         = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (128, 128,   0),   </div>
<div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ab192f19b013a2563740be0da4e7252d9">  854</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ab192f19b013a2563740be0da4e7252d9">TX_ORANGE</a>        = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (255, 128,   0),   </div>
<div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aaefd282232c1503377c5a5e3545c579a">  855</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aaefd282232c1503377c5a5e3545c579a">TX_GRAY</a>          = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (160, 160, 160),   </div>
<div class="line"><a name="l00856"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a5308a5fc6c34169a8af67630a5a750d5">  856</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a5308a5fc6c34169a8af67630a5a750d5">TX_DARKGRAY</a>      = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (128, 128, 128),   </div>
<div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5abec0ab16c8a1ed55e137c20f80cdd25e">  857</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5abec0ab16c8a1ed55e137c20f80cdd25e">TX_LIGHTGRAY</a>     = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (192, 192, 192),   </div>
<div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a00514ed69e9dd0fafeb324c0258f9030">  858</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a00514ed69e9dd0fafeb324c0258f9030">TX_LIGHTBLUE</a>     = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (  0,   0, 255),   </div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ae45f1e493cce7ef326f8bd9e8c684c6b">  859</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ae45f1e493cce7ef326f8bd9e8c684c6b">TX_LIGHTGREEN</a>    = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (  0, 255, 128),   </div>
<div class="line"><a name="l00860"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a05b6100527e0b7a96dcda198a1439382">  860</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a05b6100527e0b7a96dcda198a1439382">TX_LIGHTCYAN</a>     = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (  0, 255, 255),   </div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a1c1e8dec8618fe54eee9e569a828a504">  861</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a1c1e8dec8618fe54eee9e569a828a504">TX_LIGHTRED</a>      = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (255,   0, 128),   </div>
<div class="line"><a name="l00862"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5af3ef6cac77e7ca01e271a3562ceeb52f">  862</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5af3ef6cac77e7ca01e271a3562ceeb52f">TX_LIGHTMAGENTA</a>  = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (255,   0, 255),   </div>
<div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ae197423002e969d08646554e8b647454">  863</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ae197423002e969d08646554e8b647454">TX_PINK</a>          = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (255, 128, 255),   </div>
<div class="line"><a name="l00864"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a2331cdb79541487869e7c2445a2eb5f0">  864</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a2331cdb79541487869e7c2445a2eb5f0">TX_YELLOW</a>        = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (255, 255, 128),   </div>
<div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a4992f4f094a8e2ae9fdb68cfff1f6025">  865</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a4992f4f094a8e2ae9fdb68cfff1f6025">TX_WHITE</a>         = <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (255, 255, 255),   </div>
<div class="line"><a name="l00866"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">  866</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>   = 0xFFFFFFFF,            </div>
<div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a081ac86689e98e0c036e960e9cb159ac">  867</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a081ac86689e98e0c036e960e9cb159ac">TX_NULL</a>          = <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>,        </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//  Цветовые каналы (компоненты) - см. txExtractColor(), txRGB2HSL(), txHSL2RGB()</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div>
<div class="line"><a name="l00871"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aba144158f057694f9f08189c0b6a7d65">  871</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aba144158f057694f9f08189c0b6a7d65">TX_HUE</a>          = 0x04000000,             </div>
<div class="line"><a name="l00872"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a18419bb9192c947fb25d517765dd04cc">  872</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a18419bb9192c947fb25d517765dd04cc">TX_SATURATION</a>   = 0x05000000,             </div>
<div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5acc91e717a52d475213f0201bfae5341e">  873</a></span>&#160;    <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5acc91e717a52d475213f0201bfae5341e">TX_LIGHTNESS</a>    = 0x06000000;             </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="preprocessor">#ifdef FOR_DOXYGEN_ONLY</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    };</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#ifdef FOR_DOXYGEN_ONLY</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;COLORREF <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (<span class="keywordtype">int</span> red, <span class="keywordtype">int</span> green, <span class="keywordtype">int</span> blue);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a> (COLORREF color, <span class="keywordtype">double</span> thickness = 1, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#define txSetColour txSetColor</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga5320ee0e9d6a16dbe492d28158eb33ec">txColor</a> (<span class="keywordtype">double</span> red, <span class="keywordtype">double</span> green, <span class="keywordtype">double</span> blue, <span class="keywordtype">double</span> thickness = 1, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;COLORREF <a class="code" href="a00059.htm#ga446033e514db3f5b4f0ac9ae511cb1f6">txGetColor</a> (HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a> (COLORREF color, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor">#define txSetFillColour txSetFillColor</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga8826459bc7d9b47431c2c0ef214bce8b">txFillColor</a> (<span class="keywordtype">double</span> red, <span class="keywordtype">double</span> green, <span class="keywordtype">double</span> blue, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;COLORREF <a class="code" href="a00059.htm#gac195074aa335131697243614f12b049c">txGetFillColor</a> (HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gafad118f7658b7fc982ad5b052ed6d296">txSetROP2</a> (<span class="keywordtype">int</span> mode = R2_COPYPEN, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (COLORREF color, COLORREF component);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;COLORREF <a class="code" href="a00059.htm#ga0dc8953591b63696392ec581c6b25f7c">txRGB2HSL</a> (COLORREF rgbColor);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;COLORREF <a class="code" href="a00059.htm#ga1a87b7cd3e5a74e4dc6828d42d03fffa">txHSL2RGB</a> (COLORREF hslColor);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">//{          Drawing</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gae9c886ec2e8af26ce24325c5eebaaa9c">txClear</a> (HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaffd22a69ddbcfae7ac35ee3a6aac68a4">txSetPixel</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, COLORREF color, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gab19f6b1ecae9e2fc07ad73bd34741391">txPixel</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> red, <span class="keywordtype">double</span> green, <span class="keywordtype">double</span> blue, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="keyword">inline</span> COLORREF <a class="code" href="a00059.htm#ga84acaeb16745f95fa84b22e48f4d351f">txGetPixel</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga6eb18624049385b1f2a6dbf29461092e">txRectangle</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga14d1129ff586e19fc4d689888bf8dc2b">txPolygon</a> (<span class="keyword">const</span> POINT points[], <span class="keywordtype">int</span> numPoints, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gac6ec3514093e5ac1637a883bd65d9300">txEllipse</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaa14e9c2a46cf713efaa1f850074d8adc">txCircle</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> r);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga14ba2d5b1dfdfd09e94248d3ecd808a3">txArc</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> startAngle, <span class="keywordtype">double</span> totalAngle, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaef1c6ba744e887a2aab87e4694822a85">txPie</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> startAngle, <span class="keywordtype">double</span> totalAngle, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga2d410925d21cb3b243d3eff7c63d434f">txChord</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> startAngle, <span class="keywordtype">double</span> totalAngle, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga2bf158fe69c8341faec28e9b1c76c5ff">txFloodFill</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, COLORREF color = <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>, DWORD mode = FLOODFILLSURFACE, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaf5f3dec18e058830a6eb85ca127472df">txTriangle</a> (<span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> x2, <span class="keywordtype">double</span> y2, <span class="keywordtype">double</span> x3, <span class="keywordtype">double</span> y3);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaf5f3dec18e058830a6eb85ca127472df">txTriangle</a> (<span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> x2, <span class="keywordtype">double</span> y2, <span class="keywordtype">double</span> x3, <span class="keywordtype">double</span> y3)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    (void)x1; (void)y1; (void)x2; (void)y2; (void)x3; (void)y3;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    MessageBox (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(),</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;               <span class="stringliteral">&quot;Эта функция не реализована в библиотеке, потому что вы легко можете реализовать ее сами\n&quot;</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;               <span class="stringliteral">&quot;как функцию с параметрами, используя txPolygon(). См. \&quot;Пример с функциями с параметрами\&quot;.    &quot;</span>,</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;               <span class="stringliteral">&quot;TXLib сообщает&quot;</span>, MB_ICONINFORMATION);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    }</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00059.htm#gac76227ff55076802ea267be18b4d7a8d">txDrawMan</a> (<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> sizeX, <span class="keywordtype">int</span> sizeY, COLORREF color, <span class="keywordtype">double</span> handL, <span class="keywordtype">double</span> handR, <span class="keywordtype">double</span> twist,</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                <span class="keywordtype">double</span> head, <span class="keywordtype">double</span> eyes, <span class="keywordtype">double</span> wink, <span class="keywordtype">double</span> crazy, <span class="keywordtype">double</span> smile, <span class="keywordtype">double</span> hair, <span class="keywordtype">double</span> wind);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">//{          Drawing text</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga7412858e48e26d02792018f26c9bf095">txTextOut</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">char</span> text[], HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaa7451f04a577b18cd412100fc482471e">txDrawText</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keyword">const</span> <span class="keywordtype">char</span> text[],</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                 <span class="keywordtype">unsigned</span> format = DT_CENTER | DT_VCENTER | DT_WORDBREAK | DT_WORD_ELLIPSIS, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaf641d0fd6b8816e61d097cfb10de53d9">txSelectFont</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> name[], <span class="keywordtype">double</span> sizeY, <span class="keywordtype">double</span> sizeX = -1,</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                   <span class="keywordtype">int</span> bold = FW_DONTCARE, <span class="keywordtype">bool</span> italic = <span class="keyword">false</span>, <span class="keywordtype">bool</span> underline = <span class="keyword">false</span>, <span class="keywordtype">bool</span> strikeout = <span class="keyword">false</span>, <span class="keywordtype">double</span> angle = 0,</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                   HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;SIZE <a class="code" href="a00059.htm#ga593d51d633b7dc3aa06b34ef55b8047f">txGetTextExtent</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> text[], HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#gae9753c8c27223efbbe87be36d6525359">txGetTextExtentX</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> text[], HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#ga269080a240637dd6d9060b6972c1c7c6">txGetTextExtentY</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> text[], HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#gaf70ef41eb21f9c5781aa616c32c75608">txSetTextAlign</a> (<span class="keywordtype">unsigned</span> align = TA_CENTER | TA_BASELINE, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;LOGFONT* <a class="code" href="a00059.htm#ga1dc38c08e812d5f5a3c8f752a97c2bb2">txFontExist</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> name[]);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">//{          Drawing to memory DC and image loading</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;HDC <a class="code" href="a00059.htm#ga2f1b4b81b2b9280bb58c2d79930e2a63">txCreateCompatibleDC</a> (<span class="keywordtype">double</span> sizeX, <span class="keywordtype">double</span> sizeY, HBITMAP bitmap = NULL);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;HDC <a class="code" href="a00059.htm#ga28123a5be2ad65c41550ccb558138476">txLoadImage</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> filename[], <span class="keywordtype">unsigned</span> imageFlags = IMAGE_BITMAP, <span class="keywordtype">unsigned</span> loadFlags = LR_LOADFROMFILE);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">//@ {</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga505f212582bf9b2bf95a4ef15f84af42">txDeleteDC</a> (HDC  dc);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga505f212582bf9b2bf95a4ef15f84af42">txDeleteDC</a> (HDC* dc);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">//@ }</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height,</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;               HDC src,  <span class="keywordtype">double</span> xSrc = 0, <span class="keywordtype">double</span> ySrc = 0, DWORD rOp = SRCCOPY);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keyword">inline</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, HDC src,</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;               <span class="keywordtype">double</span> xSrc = 0, <span class="keywordtype">double</span> ySrc = 0, <span class="keywordtype">double</span> width = 0, <span class="keywordtype">double</span> height = 0, DWORD rOp = SRCCOPY);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gab4b1096971ee1f427e9f0211c2b2dea4">txTransparentBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height,</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                       HDC src,  <span class="keywordtype">double</span> xSrc = 0, <span class="keywordtype">double</span> ySrc = 0, COLORREF transColor = <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a9f0adfcb24eeb418fc39fe950db65ec8">TX_BLACK</a>);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="keyword">inline</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gab4b1096971ee1f427e9f0211c2b2dea4">txTransparentBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, HDC src,</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                       <span class="keywordtype">double</span> xSrc = 0, <span class="keywordtype">double</span> ySrc = 0, <span class="keywordtype">double</span> width = 0, <span class="keywordtype">double</span> height = 0, COLORREF transColor = <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a9f0adfcb24eeb418fc39fe950db65ec8">TX_BLACK</a>);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga44dbdbacdbfd2d838f1c78b48c6c4475">txAlphaBlend</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height,</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                   HDC src,  <span class="keywordtype">double</span> xSrc = 0, <span class="keywordtype">double</span> ySrc = 0, <span class="keywordtype">double</span> alpha = 1.0, <span class="keywordtype">unsigned</span> format = AC_SRC_ALPHA);</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="keyword">inline</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga44dbdbacdbfd2d838f1c78b48c6c4475">txAlphaBlend</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, HDC src,</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                   <span class="keywordtype">double</span> xSrc = 0, <span class="keywordtype">double</span> ySrc = 0, <span class="keywordtype">double</span> width = 0, <span class="keywordtype">double</span> height = 0, <span class="keywordtype">double</span> alpha = 1.0,</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                   <span class="keywordtype">unsigned</span> format = AC_SRC_ALPHA);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gadbf205883201eba91653fe541baedf71">txSaveImage</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a>());</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">//{          Utility functions</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="keywordtype">double</span> <a class="code" href="a00059.htm#ga56227ddccbe156355eaca50264bf3334">txSleep</a> (<span class="keywordtype">double</span> time);</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00059.htm#gae92e621aaed81f90e4d142356e38762a">txBegin</a>();</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00059.htm#ga809dc04afd5348247846ee01ce9a06e6">txEnd</a>();</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00059.htm#gaff3d9c60900531f438a19216485bdd41">txUpdateWindow</a> (<span class="keywordtype">int</span> update = <span class="keyword">true</span>);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gad4545266069ed42c29d01e7aa68d82d6">txSelectObject</a> (HGDIOBJ obj, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">//                 +--&lt;&lt;&lt; Это текст помощи, который вы уже читали. Ищите дальше! Жмите [F3] или &quot;Найти далее&quot;</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment">//                 |</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">//                 v</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment">//               txIDontWantToHaveAPauseAfterMyProgramBeforeTheWindowWillClose_AndIWillNotBeAskingWhereIsMyPicture();</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment">//     +--&lt;&lt;&lt; Это _прототип_ функции, а надо найти ее _определение_. Ищите дальше! Жмите [F3] или &quot;Найти далее&quot;</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">//     |</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment">//     v</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga93cecf6b117fc403c0488f388b78a6d1">txIDontWantToHaveAPauseAfterMyProgramBeforeTheWindowWillClose_AndIWillNotBeAskingWhereIsMyPicture</a>();</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gac9d8435ced05ddc5c29a1a5c9f58f752">txDestroyWindow</a>();</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="keywordtype">double</span> <a class="code" href="a00059.htm#gaebe0b0f6b1324031ee6b9461ba5b0ab3">txQueryPerformance</a>();</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment">//{          Mouse functions</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="keyword">inline</span> POINT <a class="code" href="a00060.htm#ga452a1a7dc5d3f467c8b79b9db3ea053e">txMousePos</a>();</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00060.htm#ga6adbdb491a8eec2a4209c54874ae7b7d">txMouseX</a>();</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00060.htm#ga572acf2310d35defaa9a37a2ec260576">txMouseY</a>();</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="a00060.htm#ga9da82cc7df5b5e082153f20b206762b4">txMouseButtons</a>();</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="comment">//{          Console functions</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (<span class="keywordtype">unsigned</span> colors = 0x07);</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#ga9f2215b90264133de36ed7c2120f75f5">txGetConsoleAttr</a>();</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga2cb63c12d9206e9ed2b2c83c9a08f68e">txClearConsole</a>();</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;POINT <a class="code" href="a00059.htm#gaee548f7b5672cbcbb99246e0291d7336">txSetConsoleCursorPos</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y);</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;POINT <a class="code" href="a00059.htm#ga3227242c57eef33049cdaee655f4faee">txGetConsoleCursorPos</a>();</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;POINT <a class="code" href="a00059.htm#ga56faf7c36cf0112165fb705fedf6ec8e">txGetConsoleFontSize</a>();</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaa148d2040d20ed74cf46ab186c35f9ed">txTextCursor</a> (<span class="keywordtype">bool</span> blink = <span class="keyword">true</span>);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment">//{          Other staff not related to drawing</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga177f8bcb7544821ea4b5bd0571fe7196">txPlaySound</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> filename[] = NULL, DWORD mode = SND_ASYNC);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* text, <span class="keyword">const</span> <span class="keywordtype">char</span>* header = <span class="stringliteral">&quot;TXLib сообщает&quot;</span>, <span class="keywordtype">unsigned</span> flags = 0);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (<span class="keywordtype">unsigned</span> flags, <span class="keyword">const</span> <span class="keywordtype">char</span> title[], <span class="keyword">const</span> <span class="keywordtype">char</span> format[], ...) _TX_CHECK_FORMAT (3);</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00062.htm#ga2b7cded1074eb3d4b25af75b4ffed73a">txOutputDebugPrintf</a> (const <span class="keywordtype">char</span> format[], ...) _TX_CHECK_FORMAT (1);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="preprocessor">#ifndef _MSC_VER_6</span></div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;</div>
<div class="line"><a name="l02847"></a><span class="lineno"><a class="line" href="a00062.htm#gab960e009ed70b2fae96c4bca6cbd39bc"> 2847</a></span>&#160;<span class="preprocessor">    #define sizearr( arr )    ( sizeof (get_size_of_an_array_with_unknown_or_nonconst_size_ (arr)) )</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="comment">//  See explanation here: http://blogs.msdn.com/b/the1/archive/2004/05/07/128242.aspx</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> N&gt; char (&amp;get_size_of_an_array_with_unknown_or_nonconst_size_ (T (&amp;) [N])) [N]; <span class="comment">// ;)</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;</div>
<div class="line"><a name="l02860"></a><span class="lineno"><a class="line" href="a00062.htm#gaf13b370e460b5a25a00c37c1a1c10927"> 2860</a></span>&#160;<span class="preprocessor">#define SIZEARR( arr )        ( sizeof (arr) / sizeof (0[arr]) )</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00062.htm#gaa4558a3bf2a126a9e19c5a3655520787">random</a> (<span class="keywordtype">int</span> range);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="a00062.htm#gaa4558a3bf2a126a9e19c5a3655520787">random</a> (<span class="keywordtype">double</span> left, <span class="keywordtype">double</span> right);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tx, <span class="keyword">typename</span> Ta, <span class="keyword">typename</span> Tb&gt;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (Tx x, Ta a, Tb b);</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tx, <span class="keyword">typename</span> Ta, <span class="keyword">typename</span> Tb&gt;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (std::nomeow_t, Tx x, Ta a, Tb b);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (<span class="keyword">const</span> POINT&amp; pt, <span class="keyword">const</span> RECT&amp; rect);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (<span class="keyword">const</span> COORD&amp; pt, <span class="keyword">const</span> SMALL_RECT&amp; rect);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;</div>
<div class="line"><a name="l03019"></a><span class="lineno"><a class="line" href="a00062.htm#ga62a815bcebe103c8d30f23a878615988"> 3019</a></span>&#160;<span class="preprocessor">#define MAX( a, b )     ( (a) &gt; (b) ? (a) : (b) )</span></div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div>
<div class="line"><a name="l03042"></a><span class="lineno"><a class="line" href="a00062.htm#gada1fc1ec7742eaee6a6268966f7ac065"> 3042</a></span>&#160;<span class="preprocessor">#define MIN( a, b )     ( (a) &lt; (b) ? (a) : (b) )</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="preprocessor">#if defined (__STDC_VERSION__) &amp;&amp; __STDC_VERSION__ &gt;= 199901L  // C99 case</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="preprocessor">    #define ROUND( x )  ( (long) round (x) )</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;</div>
<div class="line"><a name="l03066"></a><span class="lineno"><a class="line" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12"> 3066</a></span>&#160;<span class="preprocessor">    #define ROUND( x )  ( (long) floor ((x) + 0.5) )</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00062.htm#ga5de732de72c46b992ac2feeac2de7e42">tx_fpreset</a>();</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;</div>
<div class="line"><a name="l03104"></a><span class="lineno"><a class="line" href="a00062.htm#gaf59817ad656dcbb3f9baebeb4d7f82f7"> 3104</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="a00062.htm#gaf59817ad656dcbb3f9baebeb4d7f82f7">txPI</a> = asin (1.0) * 2;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="keyword">inline</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="keywordtype">double</span> <a class="code" href="a00062.htm#ga74ff1048e0d6bc458c9904fbbe0a6026">txSqr</a> (<span class="keywordtype">double</span> x)</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    {</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    <span class="keywordtype">double</span> sqr = pow (sqrt (x) * sqrt (x), sqrt (4.0));  <span class="comment">// Бурная вычислительная деятельность</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <span class="keywordtype">char</span> str[1024] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    _snprintf_s (str, <span class="keyword">sizeof</span> (str), <span class="stringliteral">&quot;Возведение дало %g!&quot;</span> <span class="stringliteral">&quot;!!&quot;</span> <span class="stringliteral">&quot;!!&quot;</span> <span class="stringliteral">&quot; Вы рады????    &quot;</span>, sqr);</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (str, <span class="stringliteral">&quot;Получен ОТВЕТ!&quot;</span> <span class="stringliteral">&quot;!!&quot;</span>, MB_ICONEXCLAMATION | MB_YESNO) != IDNO ||</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        (</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;        <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (<span class="stringliteral">&quot;Жаль...&quot;</span>, <span class="stringliteral">&quot;А я так старалась&quot;</span>, MB_ICONINFORMATION),</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (<span class="stringliteral">&quot;Уйду я от вас       &quot;</span>, <span class="stringliteral">&quot;Злые вы...&quot;</span>,  MB_ICONSTOP),</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        exit (EXIT_FAILURE), 0</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;        );</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (1, NULL, <span class="stringliteral">&quot;\n%s\n&quot;</span>, <span class="stringliteral">&quot;Высшая математика!  \0&quot;</span>  <span class="comment">// А как это работает, а?</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                                     <span class="stringliteral">&quot;С ума сойти...      \0&quot;</span>  <span class="comment">//</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                                     <span class="stringliteral">&quot;а КЭП подтверждает  \0&quot;</span>  <span class="comment">//       и кто это будет</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                                     <span class="stringliteral">&quot;Главное - отчитаться\0&quot;</span>  <span class="comment">//       поддерживать?..</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                                     <span class="stringliteral">&quot;Невероятно, но факт \0&quot;</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                                     <span class="stringliteral">&quot;Кто бы мог подумать?\0&quot;</span> + GetTickCount() % 6 * 21);</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="keywordflow">return</span> sqr;  <span class="comment">// Все же вернем значение. Мы же не звери</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    }</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="preprocessor">#ifdef FOR_DOXYGEN_ONLY</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"><a class="line" href="a00062.htm#gad2296e7bc6bc51ec0739aad2e8ee0a9c"> 3184</a></span>&#160;<span class="preprocessor">#define _TX_DESTROY_3D</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="preprocessor">#ifdef _TX_DESTROY_3D</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="preprocessor">    #define z 0                    // Читайте &quot;Флатландию&quot; Эбботта!</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;</div>
<div class="line"><a name="l03212"></a><span class="lineno"><a class="line" href="a00062.htm#ga779aead84bda35892b48c54418144d4d"> 3212</a></span>&#160;<span class="preprocessor">#define ZERO( type )    zero &lt;type&gt; ()</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span> T zero();</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;<span class="comment">//{ C++03 version</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;</div>
<div class="line"><a name="l03280"></a><span class="lineno"><a class="line" href="a00062.htm#ga885111ebb42a2b91ec43be798fc62325"> 3280</a></span>&#160;<span class="preprocessor">#define  TX_AUTO_FUNC(           param_t, param, func )                  \</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<span class="preprocessor">        _TX_AUTO_FUNC( __LINE__, param_t, param, func )</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="preprocessor">#define _TX_AUTO_FUNC( n,        param_t, param, func )                  \</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="preprocessor">        _TX_AUTO_FUN2( n,        param_t, param, func )</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="preprocessor">#define _TX_AUTO_FUN2( n,        param_t, param, func )                  \</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;<span class="preprocessor">    struct _TX_AUTO_FUNC_##n                                             \</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="preprocessor">        {                                                                \</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<span class="preprocessor">        typedef _TX_AUTO_FUNC_##n this_t;                                \</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;<span class="preprocessor">        param_t&amp; param;                                                  \</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;<span class="preprocessor">                                                                         \</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;<span class="preprocessor">        _TX_AUTO_FUNC_##n (param_t&amp; __p) : param (__p) {       }         \</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="preprocessor">       ~_TX_AUTO_FUNC_##n ()                           { func; }         \</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;<span class="preprocessor">                                                                         \</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;<span class="preprocessor">        private: this_t&amp; operator= (const this_t&amp;)     { return *this; } \</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;<span class="preprocessor">        }                                                                \</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="preprocessor">        _TX_AUTO_FUNC_##n (param)</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;<span class="comment">//{ C++0x version, use MSVS 2010 or GCC v.4.5+ and -std=c++0x in command line</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="preprocessor">#define  tx_auto_func(    func )  _tx_auto_fun1 ( __LINE__, func )</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;<span class="preprocessor">#define _tx_auto_fun1( n, func )  _tx_auto_fun2 ( n,        func )</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;<span class="preprocessor">#define _tx_auto_fun2( n, func )  auto _tx_auto_func_##n = _tx_auto_func ([&amp;]() { func; })</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="keyword">struct </span>_tx_auto_func_</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    {</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <span class="keyword">typedef</span> _tx_auto_func_ this_t;</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    T func_;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    _tx_explicit _tx_auto_func_ (T func) : func_ (func) {}</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                ~_tx_auto_func_ () { func_(); }</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    <span class="keyword">private</span>: this_t&amp; operator= (<span class="keyword">const</span> this_t&amp;) { <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    };</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;_tx_auto_func_&lt;T&gt; _tx_auto_func  (T   func)</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="keywordflow">return</span>        _tx_auto_func_ &lt;T&gt; (func);</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    }</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="comment">//{ Compatibility</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;<span class="preprocessor">#define TX_FINALLY( param_t, param, func )  TX_AUTO_FUNC (param_t, param, func)</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;<span class="preprocessor">#define tx_finally( func )                  tx_auto_func (func)</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="preprocessor">#if !defined (NDEBUG)</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="preprocessor">    #undef  assert</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"><a class="line" href="a00062.htm#ga934291e39288d75c477c6022e67920e1"> 3378</a></span>&#160;<span class="preprocessor">    #define assert( cond )    _txNOP ( !(cond)? (TX_ERROR (&quot;\a&quot; &quot;ВНЕЗАПНО: Логическая ошибка: &quot;    \</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="preprocessor">                                                           &quot;Неверно, что \&quot;%s\&quot;.&quot; TX_COMMA #cond), \</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="preprocessor">                                                 0/(int)!!(cond)) : 1 )</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;<span class="preprocessor">    #undef  assert</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="preprocessor">    #define assert( cond )    ((void) 1)</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="preprocessor">#if !defined (NDEBUG)</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"><a class="line" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7"> 3417</a></span>&#160;<span class="preprocessor">    #define asserted          || TX_ERROR (&quot;\a&quot; &quot;Обнаружен нулевой или ложный результат.&quot;)</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;<span class="preprocessor">    #define asserted          || _txNOP (0)</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="preprocessor">#define verified              asserted  </span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="preprocessor">#define TX_NEEDED             asserted  </span></div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="preprocessor">#if !defined (NDEBUG)</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;<span class="preprocessor">    #undef  verify</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"><a class="line" href="a00062.htm#ga14fecb1c008314444a74c1fe7d9a113b"> 3463</a></span>&#160;<span class="preprocessor">    #define verify            assert</span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="preprocessor">    #undef  verify</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="preprocessor">    #define verify( expr )    ( expr )</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="comment">// Variadic macros not supported in Strict ANSI mode and in MSVC prior to MSVC 8 (2005)</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="preprocessor">#if defined (__STRICT_ANSI__) || defined (_MSC_VER) &amp;&amp; (_MSC_VER &lt; 1400)</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="preprocessor">    #define TX_ERROR( msg )   _txError (__FILE__, __LINE__, __TX_FUNCTION__, msg)</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"><a class="line" href="a00062.htm#ga5cd767f8040c04a51cb0173bf9255247"> 3504</a></span>&#160;<span class="preprocessor">    #define TX_ERROR( ... )   _txError (__FILE__, __LINE__, __TX_FUNCTION__, __VA_ARGS__)</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="preprocessor">#define TX_THROW              TX_ERROR  </span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="preprocessor">#if !defined (NDEBUG)</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"><a class="line" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220"> 3531</a></span>&#160;<span class="preprocessor">    #define TX_DEBUG_ERROR    TX_ERROR</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;<span class="preprocessor">    #define TX_DEBUG_ERROR(m) ((void) 0)</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00062.htm#ga7b470eef58eabacf9c7820ce6d392506">txDump</a> (<span class="keyword">const</span> <span class="keywordtype">void</span>* address, <span class="keyword">const</span> <span class="keywordtype">char</span> name[] = <span class="stringliteral">&quot;txDump()&quot;</span>);</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03574"></a><span class="lineno"><a class="line" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba"> 3574</a></span>&#160;<span class="preprocessor">#define _                     ,</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"><a class="line" href="a00062.htm#gaaff3c8e496327bec13a821061787878f"> 3575</a></span>&#160;<span class="preprocessor">#define TX_COMMA              ,  </span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;<span class="preprocessor">#if   defined (__GNUC__)</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;<span class="preprocessor">    #define __TX_COMPILER__   &quot;GNU g++ &quot;            TX_PREPROCESS (__GNUC__)       &quot;.&quot;  \</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;<span class="preprocessor">                                                    TX_PREPROCESS (__GNUC_MINOR__) &quot;.&quot;  \</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;<span class="preprocessor">                                                    TX_PREPROCESS (__GNUC_PATCHLEVEL__) \</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="preprocessor">                              &quot;, std=&quot;              TX_PREPROCESS (__cplusplus)</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;<span class="preprocessor">#elif defined (_MSC_VER)</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;<span class="preprocessor">    #define __TX_COMPILER__   &quot;MSVS &quot;               TX_PREPROCESS (_MSC_VER)            \</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="preprocessor">                              &quot;, std=&quot;              TX_PREPROCESS (__cplusplus)</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="preprocessor">#elif defined (__INTEL_COMPILER)</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;<span class="preprocessor">    #define __TX_COMPILER__   &quot;Intel C++ &quot;          TX_PREPROCESS (__INTEL_COMPILER)    \</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;<span class="preprocessor">                              &quot;, std=&quot;              TX_PREPROCESS (__cplusplus)</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"><a class="line" href="a00062.htm#gadd1c9ccd036228402b807abaea14f7ee"> 3599</a></span>&#160;<span class="preprocessor">    #define __TX_COMPILER__   &quot;Unknown C++, std=&quot;   TX_PREPROCESS (__cplusplus)</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;</div>
<div class="line"><a name="l03609"></a><span class="lineno"><a class="line" href="a00062.htm#ga973d717438fe468dd5a5d8d45ede5312"> 3609</a></span>&#160;<span class="preprocessor">#define __TX_FILELINE__       __FILE__ &quot; (&quot; TX_PREPROCESS (__LINE__) &quot;)&quot;</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="preprocessor">#if defined (__GNUC__)</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;<span class="preprocessor">    #define __TX_FUNCTION__   __PRETTY_FUNCTION__</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;<span class="preprocessor">#elif defined (__FUNCSIG__)</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;<span class="preprocessor">    #define __TX_FUNCTION__   __FUNCSIG__</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;<span class="preprocessor">#elif defined (__FUNCTION__)</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;<span class="preprocessor">    #define __TX_FUNCTION__   __FUNCTION__</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;<span class="preprocessor">#elif defined (__INTEL_COMPILER) &amp;&amp; (__INTEL_COMPILER &gt;= 600)</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="preprocessor">    #define __TX_FUNCTION__   __FUNCTION__</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;<span class="preprocessor">#elif defined (__BORLANDC__) &amp;&amp; (__BORLANDC__ &gt;= 0x550)</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;<span class="preprocessor">    #define __TX_FUNCTION__   __FUNC__</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="preprocessor">#elif defined (__STDC_VERSION__) &amp;&amp; (__STDC_VERSION__ &gt;= 199901)</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="preprocessor">    #define __TX_FUNCTION__   __func__</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="preprocessor">#elif defined (__PYTHON__)</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="preprocessor">    #error No Python. No. Using parseltongue languages can lead you to Slytherin.</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"><a class="line" href="a00062.htm#gab170f39ac0e379c324c73495f14a1309"> 3643</a></span>&#160;<span class="preprocessor">    #define __TX_FUNCTION__   &quot;(&quot; __TX_FILELINE__ &quot;)&quot;</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="preprocessor">#if   !defined (NDEBUG) &amp;&amp;  defined (_DEBUG)</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="preprocessor">    #define _TX_BUILDMODE     &quot;DEBUG&quot;</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="preprocessor">#elif !defined (NDEBUG) &amp;&amp; !defined (_DEBUG)</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"><a class="line" href="a00062.htm#ga3e287c38947fea870d01588fbd2a5fc9"> 3657</a></span>&#160;<span class="preprocessor">    #define _TX_BUILDMODE     &quot;Debug&quot;</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;<span class="preprocessor">#elif  defined (NDEBUG)</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;<span class="preprocessor">    #define _TX_BUILDMODE     &quot;Release&quot;</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;<span class="preprocessor">#define  TX_PREPROCESS( sym ) _TX_QUOTE (sym)</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;<span class="preprocessor">#define _TX_QUOTE( sym )      #sym</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="preprocessor">#if !defined (_TX_MODULE)</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"><a class="line" href="a00062.htm#ga43d277b4418068ebef1fd2bdbaf550f6"> 3680</a></span>&#160;<span class="preprocessor">    #define   _TX_MODULE      &quot;TXLib&quot;</span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="comment">//{          Back-hole (I hope, not an ass-hole:) of the library)</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;WNDPROC <a class="code" href="a00063.htm#ga30fb1a6913174dfcea5079391f655be2">txSetWindowsHook</a> (WNDPROC wndProc = NULL);</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00063.htm#ga532fa8a55c4f3d4f94ff0fdceae732b2">txLock</a> (<span class="keywordtype">bool</span> wait = <span class="keyword">true</span>);</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a>();</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span> T <a class="code" href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a> (T value);</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;</div>
<div class="line"><a name="l03832"></a><span class="lineno"><a class="line" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287"> 3832</a></span>&#160;<span class="preprocessor">#define txGDI( command, dc )  ( ((dc) == txDC())? txUnlock ( (txLock(), (command)) ) : (command) )</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="comment">//{          Tune-up constants and variables</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="preprocessor">#if  defined  (_TX_NOINIT)</span></div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="preprocessor">    #undef     _TX_NOINIT</span></div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="preprocessor">    #define    _TX_NOINIT                 1</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;</div>
<div class="line"><a name="l03884"></a><span class="lineno"><a class="line" href="a00064.htm#gaab281ee20ea6be5eae34d0e15bf03dcf"> 3884</a></span>&#160;<span class="preprocessor">    #define    _TX_NOINIT                 0</span></div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;</div>
<div class="line"><a name="l03907"></a><span class="lineno"><a class="line" href="a00064.htm#ga8a148ac2f04e1f9c7414af69362e0668"> 3907</a></span>&#160;<span class="keywordtype">int</span>            <a class="code" href="a00064.htm#ga8a148ac2f04e1f9c7414af69362e0668">_txConsoleMode</a>             = SW_HIDE;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;</div>
<div class="line"><a name="l03924"></a><span class="lineno"><a class="line" href="a00064.htm#ga4ddb32d7a8a676537014da7aea7bf273"> 3924</a></span>&#160;<span class="keywordtype">int</span>            <a class="code" href="a00064.htm#ga4ddb32d7a8a676537014da7aea7bf273">_txWindowStyle</a>             = WS_POPUP | WS_BORDER | WS_CAPTION | WS_SYSMENU;</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;</div>
<div class="line"><a name="l03932"></a><span class="lineno"><a class="line" href="a00064.htm#ga61836072e0c3887ed70841ff2d12c0d9"> 3932</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>*    <a class="code" href="a00064.htm#ga61836072e0c3887ed70841ff2d12c0d9">_txConsoleFont</a>             = <span class="stringliteral">&quot;Lucida Console&quot;</span>;</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;</div>
<div class="line"><a name="l03939"></a><span class="lineno"><a class="line" href="a00064.htm#gacc95bfbcf7a0f9124e8cd5e80d0b3cd3"> 3939</a></span>&#160;<span class="keywordtype">unsigned</span>       <a class="code" href="a00064.htm#gacc95bfbcf7a0f9124e8cd5e80d0b3cd3">_txCursorBlinkInterval</a>     = 500;</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;</div>
<div class="line"><a name="l03947"></a><span class="lineno"><a class="line" href="a00064.htm#gaf2070fcdbd473d328f17f130623db80a"> 3947</a></span>&#160;<span class="keywordtype">unsigned</span>       <a class="code" href="a00064.htm#gaf2070fcdbd473d328f17f130623db80a">_txWindowUpdateInterval</a>    = 25;</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="preprocessor">#if !defined (TX_TRACE)</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"><a class="line" href="a00064.htm#ga7859e95fc4faec435abe372989f4f8ac"> 3955</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>  <a class="code" href="a00064.htm#ga7859e95fc4faec435abe372989f4f8ac">_TX_TIMEOUT</a>                = 1000</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>  _TX_TIMEOUT                = 5000</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;<span class="preprocessor">#if  defined  (_TX_USE_DEVPARTNER)</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    * 10</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    ;</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div>
<div class="line"><a name="l03972"></a><span class="lineno"><a class="line" href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25"> 3972</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25">_TX_BUFSIZE</a>                = 1024;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;</div>
<div class="line"><a name="l03979"></a><span class="lineno"><a class="line" href="a00064.htm#gaa7273b2f613970c283053c5d9136addd"> 3979</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="a00064.htm#gaa7273b2f613970c283053c5d9136addd">_TX_BIGBUFSIZE</a>             = 2048;</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;            <span class="comment">// TX_VEGETABLE_PRINTERS</span></div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="preprocessor">#if !defined  (_TX_WAITABLE_PARENTS)</span></div>
<div class="line"><a name="l03999"></a><span class="lineno"><a class="line" href="a00064.htm#ga2c0a4fe0612f109c5c88d6d55a061db5"> 3999</a></span>&#160;<span class="preprocessor">    #define    _TX_WAITABLE_PARENTS       &quot;cmd.exe:devenv.exe, &quot;                    </span><span class="comment">/* MSVS 2003+    */</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="preprocessor">                                          &quot;vcspawn.exe:msdev.exe, &quot;                 </span><span class="comment">/* MSVS 6        */</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="preprocessor">                                          &quot;cb_console_runner.exe:codeblocks.exe, &quot;  </span><span class="comment">/* CodeBlocks 8+ */</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="preprocessor">                                          &quot;cmd.exe:console_runner.exe, &quot;            </span><span class="comment">/* CodeBlocks 1  */</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;<span class="preprocessor">                                          &quot;starter.exe:eclipse.exe, &quot;               </span><span class="comment">/* Eclipse 4     */</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="preprocessor">                                          &quot;starter.exe:javaw.exe, &quot;                 </span><span class="comment">/* Eclipse 3     */</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<span class="preprocessor">                                          &quot;consolepauser.exe:devcpp.exe&quot;            </span><span class="comment">/* Dev-Cpp       */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="preprocessor">#if !defined (_TX_ALLOW_KILL_PARENT)            // DISCLAIMER: Я не призываю к убийству родителей!</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"><a class="line" href="a00064.htm#ga9a495d013c6f08cd50220aca99ca56c2"> 4030</a></span>&#160;<span class="preprocessor">#define       _TX_ALLOW_KILL_PARENT       true  //             Это технический термин.</span></div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;<span class="preprocessor">#endif                                          //             г-дам юристам привет.</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="comment">//{          Internal diagnostics</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;<span class="preprocessor">#ifdef FOR_DOXYGEN_ONLY</span></div>
<div class="line"><a name="l04069"></a><span class="lineno"><a class="line" href="a00064.htm#ga1c7c387b21adad57d0dda2f8bd84ad1c"> 4069</a></span>&#160;<span class="preprocessor">#define      _TX_ALLOW_TRACE</span></div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;<span class="preprocessor">#if defined (_TX_ALLOW_TRACE)</span></div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="preprocessor">    #undef  $</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="preprocessor">    #define $                 { _txFile = __FILE__; _txLine = __LINE__; _txFunc = __TX_FUNCTION__; TX_TRACE; }</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;<span class="preprocessor">    #undef  $1</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;<span class="preprocessor">    #define $1                _txFuncEntry __txFuncEntry; $</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="preprocessor">#elif defined (_DEBUG)</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="preprocessor">    #undef  $</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="preprocessor">    #define $                 { _txFile = __FILE__; _txLine = __LINE__; _txFunc = __TX_FUNCTION__; }</span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="preprocessor">    #undef  $1</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="preprocessor">    #define $1                _txFuncEntry __txFuncEntry; $</span></div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;<span class="preprocessor">    #undef  $</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;<span class="preprocessor">    #define $                 ;</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="preprocessor">    #undef  $1</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="preprocessor">    #define $1                ;</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span>                     _txInitialized;</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">unsigned</span>       <span class="keyword">volatile</span> _txMainThreadId;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">unsigned</span>       <span class="keyword">volatile</span> _txCanvas_ThreadId;</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span>                    _txConsole;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span>                    _txMain;</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span>                    _txIsDll;</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span>           <span class="keyword">volatile</span> _txRunning;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span>           <span class="keyword">volatile</span> _txExit;</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span>           <span class="keyword">volatile</span> _txAllowTrace;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*    <span class="keyword">volatile</span> _txFile;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span>            <span class="keyword">volatile</span> _txLine;</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*    <span class="keyword">volatile</span> _txFunc;</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;<span class="keyword">extern</span> _tx_thread <span class="keywordtype">int</span> <span class="keyword">volatile</span> _txInTX;</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="keyword">struct </span>_txFuncEntry</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    {</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;    _txFuncEntry() { _txInTX++; }</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;   ~_txFuncEntry() { _txInTX--; }</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    };</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="preprocessor">#ifdef FOR_DOXYGEN_ONLY</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"><a class="line" href="a00064.htm#ga2aa2550a5302deb4d46b3759b26f4b41"> 4160</a></span>&#160;<span class="preprocessor">#define       TX_TRACE</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="preprocessor">#if !defined (TX_TRACE)</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="preprocessor">    #define   TX_TRACE        if (_txAllowTrace) _txTrace (__FILE__, __LINE__, __TX_FUNCTION__);</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="keywordtype">void</span> _txTrace (<span class="keyword">const</span> <span class="keywordtype">char</span> file[], <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> func[], <span class="keyword">const</span> <span class="keywordtype">char</span> msg[]    = NULL,    ...);</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="keywordtype">void</span> _txTrace (<span class="keyword">const</span> <span class="keywordtype">char</span> file[], <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> func[], <span class="keyword">const</span> <span class="keywordtype">char</span> msg[] <span class="comment">/* = NULL */</span>, ...)</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;    {</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">id</span> = GetCurrentThreadId();</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> marks[2][2][3] = {{<span class="stringliteral">&quot;uU&quot;</span>, <span class="stringliteral">&quot;cC&quot;</span>}, {<span class="stringliteral">&quot;mM&quot;</span>, <span class="stringliteral">&quot;??&quot;</span>}};</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    <span class="keywordtype">char</span> mark = marks [<span class="keywordtype">id</span> == _txMainThreadId] [<span class="keywordtype">id</span> == _txCanvas_ThreadId] [(_txInTX &gt; 0)];</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    <span class="keywordtype">char</span> msgStr[<a class="code" href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25">_TX_BUFSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    <span class="keywordflow">if</span> (msg)</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        {</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        va_list arg; va_start (arg, msg);</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;        _vsnprintf_s (msgStr, <span class="keyword">sizeof</span> (msgStr) - 1 _TX_TRUNCATE, msg, arg);</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        va_end (arg);</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;        }</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    <a class="code" href="a00062.htm#ga2b7cded1074eb3d4b25af75b4ffed73a">txOutputDebugPrintf</a> (<span class="stringliteral">&quot;%s - %p %c%c%c%c%c%c [%c] - %s (%d)  &quot;</span> <span class="stringliteral">&quot;|%*s%s&quot;</span> <span class="stringliteral">&quot;%s%s\n&quot;</span>,</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;                         <a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a>, (<span class="keywordtype">void</span>*) &amp;_txInitialized,</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;                         <span class="stringliteral">&quot;cC&quot;</span>[_txConsole], <span class="stringliteral">&quot;mM&quot;</span>[_txMain], <span class="stringliteral">&quot;dD&quot;</span>[_txIsDll], <span class="stringliteral">&quot;rR&quot;</span>[_txRunning], <span class="stringliteral">&quot;eE&quot;</span>[_txExit], <span class="stringliteral">&quot;tT&quot;</span>[_txAllowTrace],</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;                         mark, (file? file : <span class="stringliteral">&quot;(NULL file)&quot;</span>), line, (_txInTX - 1) * 2, <span class="stringliteral">&quot;&quot;</span>, (func? func : <span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;                         (*msgStr? <span class="stringliteral">&quot;: &quot;</span> : <span class="stringliteral">&quot;&quot;</span>), msgStr);</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    }</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;<span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;<span class="comment">//{          Sweet critical section blocking: txAutoLock class</span></div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="keyword">extern</span> CRITICAL_SECTION _txCanvas_LockBackBuf;</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;<span class="keyword">class </span><a class="code" href="a00015.htm">txAutoLock</a></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    {</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;</div>
<div class="line"><a name="l04254"></a><span class="lineno"><a class="line" href="a00015.htm#ad8c38da2a4d92f89e4adb506e26e35c9"> 4254</a></span>&#160;    _tx_explicit <a class="code" href="a00015.htm#ad8c38da2a4d92f89e4adb506e26e35c9">txAutoLock</a> (CRITICAL_SECTION* cs, <span class="keywordtype">bool</span> mandatory = <span class="keyword">true</span>) :</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;        cs_ (cs)</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        {</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;$1      <span class="keywordflow">if</span> (!cs_) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        <span class="keywordflow">if</span> (mandatory) { $    EnterCriticalSection (cs_);                   }</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        <span class="keywordflow">else</span>           { $ TryEnterCriticalSection (cs_)? 0 : (cs_ = NULL); }</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        }</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;</div>
<div class="line"><a name="l04277"></a><span class="lineno"><a class="line" href="a00015.htm#a7b87eb977476f0d637336e9b8c580943"> 4277</a></span>&#160;    _tx_explicit <a class="code" href="a00015.htm#a7b87eb977476f0d637336e9b8c580943">txAutoLock</a> (<span class="keywordtype">bool</span> mandatory = <span class="keyword">true</span>) :</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        cs_ (NULL)</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;        {</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;$1      <span class="keyword">new</span> (<span class="keyword">this</span>) txAutoLock (&amp;_txCanvas_LockBackBuf, mandatory);</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;        }</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;</div>
<div class="line"><a name="l04287"></a><span class="lineno"><a class="line" href="a00015.htm#a838aae52b26597bf7aa0cd931611dca4"> 4287</a></span>&#160;   <a class="code" href="a00015.htm#a838aae52b26597bf7aa0cd931611dca4">~txAutoLock</a>()</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;        {</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;$1      <span class="keywordflow">if</span> (!cs_) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;$       LeaveCriticalSection (cs_); cs_ = NULL;</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;        }</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;</div>
<div class="line"><a name="l04298"></a><span class="lineno"><a class="line" href="a00015.htm#ae2e5723033220c75678bbaea39d22659"> 4298</a></span>&#160;    <span class="keyword">operator</span> bool ()<span class="keyword"> const</span></div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;<span class="keyword">        </span>{</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;$1      <span class="keywordflow">return</span> (cs_ != NULL);</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;        }</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;<span class="comment">//  private:</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    CRITICAL_SECTION* cs_;</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    <a class="code" href="a00015.htm">txAutoLock</a>             (<span class="keyword">const</span> <a class="code" href="a00015.htm">txAutoLock</a>&amp;);</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;    <a class="code" href="a00015.htm">txAutoLock</a>&amp; operator = (<span class="keyword">const</span> <a class="code" href="a00015.htm">txAutoLock</a>&amp;);</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;    };</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="comment">//{          Dialogs: txDialog class</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;<span class="keyword">struct </span><a class="code" href="a00016.htm">txDialog</a></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;    {</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l04374"></a><span class="lineno"><a class="line" href="a00061.htm#ga5b47575087d696b5fddf972ce4d83657"> 4374</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="a00061.htm#ga5b47575087d696b5fddf972ce4d83657">CONTROL</a></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;        {</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;        DIALOG    = 0x00000000,                  </div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;        BUTTON    = 0xFFFF0080,                  </div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;        EDIT      = 0xFFFF0081,                  </div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;        STATIC    = 0xFFFF0082,                  </div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;        LISTBOX   = 0xFFFF0083,                  </div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;        SCROLLBAR = 0xFFFF0084,                  </div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;        COMBOBOX  = 0xFFFF0085,                  </div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;        END       = 0x00000000                   </div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        };</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;    <span class="keyword">struct </span>Layout</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;        {</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;        CONTROL     wndclass;                    </div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* caption;                     </div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;        WORD        id;                          </div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;        <span class="keywordtype">short</span>        x;                          </div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;        <span class="keywordtype">short</span>        y;                          </div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;        <span class="keywordtype">short</span>       sx;                          </div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;        <span class="keywordtype">short</span>       sy;                          </div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;        DWORD       style;                       </div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* font;                        </div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;        WORD        fontsize;                    </div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;        };</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    <a class="code" href="a00016.htm">txDialog</a>();</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    _tx_explicit <a class="code" href="a00016.htm">txDialog</a> (<span class="keyword">const</span> Layout* layout);</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;</div>
<div class="line"><a name="l04452"></a><span class="lineno"><a class="line" href="a00016.htm#a0a41d301a3d12cd2542f609bb77d81a1"> 4452</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="a00016.htm#a0a41d301a3d12cd2542f609bb77d81a1">~txDialog</a>() {};</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;    <span class="keyword">const</span> Layout* setLayout (<span class="keyword">const</span> Layout *layout);</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">int</span> dialogProc (HWND _wnd, UINT _msg, WPARAM _wParam, LPARAM _lParam);</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;    INT_PTR dialogBox (<span class="keyword">const</span> Layout* layout = NULL, <span class="keywordtype">size_t</span> bufsize = 0);</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    INT_PTR dialogBox (WORD resource);</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;    <a class="code" href="a00016.htm">txDialog</a> (<span class="keyword">const</span> <a class="code" href="a00016.htm">txDialog</a>&amp;);</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;    <a class="code" href="a00016.htm">txDialog</a>&amp; operator = (<span class="keyword">const</span> <a class="code" href="a00016.htm">txDialog</a>&amp;);</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;    <span class="keyword">static</span> ptrdiff_t CALLBACK dialogProc__ (HWND wnd, UINT msg, WPARAM wParam, LPARAM lParam);</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;    <span class="keyword">const</span> Layout* layout_;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;    };</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;<span class="comment">//{          Dialogs: Message Map macros</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;</div>
<div class="line"><a name="l04574"></a><span class="lineno"><a class="line" href="a00062.htm#gafca36de229c170968d003c75dbf3e728"> 4574</a></span>&#160;<span class="preprocessor">#define TX_BEGIN_MESSAGE_MAP()                                                                 \</span></div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;<span class="preprocessor">    virtual int dialogProc (HWND _wnd, UINT _msg, WPARAM _wParam, LPARAM _lParam) _tx_override \</span></div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;<span class="preprocessor">        {                                                                                      \</span></div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;<span class="preprocessor">        (void)_wnd; (void)_msg; (void)_wParam; (void)_lParam;                                  \</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;<span class="preprocessor">                                                                                               \</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;<span class="preprocessor">        switch (_msg)                                                                          \</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;<span class="preprocessor">            {                                                                                  \</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;<span class="preprocessor">            case WM_NULL:</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;</div>
<div class="line"><a name="l04598"></a><span class="lineno"><a class="line" href="a00062.htm#ga36851fb6c9bcfc7eaea57befafe98e6d"> 4598</a></span>&#160;<span class="preprocessor">#define TX_HANDLE( id )                                                            \</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<span class="preprocessor">            break;                                                                 \</span></div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;<span class="preprocessor">            case (id):</span></div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;</div>
<div class="line"><a name="l04615"></a><span class="lineno"><a class="line" href="a00062.htm#ga3637c3398b6ebfa337171beec0770fe4"> 4615</a></span>&#160;<span class="preprocessor">#define TX_COMMAND_MAP                                                             \</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;<span class="preprocessor">            default: break;                                                        \</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;<span class="preprocessor">            }                                                                      \</span></div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;<span class="preprocessor">                                                                                   \</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;<span class="preprocessor">        if (_msg == WM_COMMAND) switch (LOWORD (_wParam))                          \</span></div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;<span class="preprocessor">            {                                                                      \</span></div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;<span class="preprocessor">            case 0:</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;</div>
<div class="line"><a name="l04636"></a><span class="lineno"><a class="line" href="a00062.htm#ga3f4a70a0e5076cb4f4addcab0ca760cd"> 4636</a></span>&#160;<span class="preprocessor">#define TX_END_MESSAGE_MAP                                                         \</span></div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;<span class="preprocessor">            default: break;                                                        \</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;<span class="preprocessor">            }                                                                      \</span></div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;<span class="preprocessor">                                                                                   \</span></div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;<span class="preprocessor">        return FALSE;                                                              \</span></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;<span class="preprocessor">        }</span></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;<span class="comment">//{          Dialogs: txDialog example: txInputBox()</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;<span class="comment"></span><span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="a00061.htm#ga364e78410e64fb751d3a0253d08f98e2">txInputBox</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* text = NULL, <span class="keyword">const</span> <span class="keywordtype">char</span>* caption = NULL, <span class="keyword">const</span> <span class="keywordtype">char</span>* input = NULL);</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="a00061.htm#ga364e78410e64fb751d3a0253d08f98e2">txInputBox</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* text, <span class="keyword">const</span> <span class="keywordtype">char</span>* caption, <span class="keyword">const</span> <span class="keywordtype">char</span>* input)</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;    {</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;    <span class="comment">// Если не указаны параметры, приходится использовать хоть какие-то надписи.</span></div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;    <span class="comment">// txGetModuleFileName() - имя EXE-файла, на случай, если кое-кто поленился задать название.</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;    <span class="keywordflow">if</span> (!text)    text    = <span class="stringliteral">&quot;Введите строку:&quot;</span>;</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;    <span class="keywordflow">if</span> (!caption) caption = <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a> (<span class="keyword">false</span>);</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;    <span class="keywordflow">if</span> (!input)   input   = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;    <span class="comment">// Идентификаторы элементов диалога. Они требуются в GetDlgItemText().</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;    <span class="comment">// Если диалог строится не вручную, а редактором ресурсов, то они задаются в нем автоматически.</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    <span class="comment">// У нас же тут - хардкор стайл, к сожалению. Причина в том, что у разных сред программирования</span></div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;    <span class="comment">// разные редакторы ресурсов и системы сборки. Поэтому для независимости от них все будет</span></div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    <span class="comment">// строиться на этапе выполнения, динамически. Вы еще гляньте, как это реализовано в</span></div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;    <span class="comment">// txDialog::dialogBox() и функциях _tx_DLGTEMPLATE_()... О_о</span></div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;<span class="preprocessor">    #define ID_TEXT_  101</span></div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;<span class="preprocessor">    #define ID_INPUT_ 102</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;    <span class="comment">// Задание макета (вида) диалога в виде массива структур.</span></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;    <span class="comment">// С помощью особого порядка полей в структуре txDialog::Layout и констант из класса</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;    <span class="comment">// txDialog этот массив становится похож на описание ресурса диалога в .rc - файле.</span></div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;    <span class="comment">// См. описание синтаксиса rc-файла в документации по Win32 (MSDN, http://msdn.com).</span></div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;    <a class="code" href="a00013.htm">txDialog::Layout</a> layout[] =</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;    <span class="comment">//----------------------+----------+-----------+-----------------+---------------------------------------------</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;    <span class="comment">//     Тип элемента     | Имя      | Иденти-   |   Координаты    | Флаги элементов</span></div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;    <span class="comment">//     диалога          | элемента | фикатор   |-----------------| (см. описание элементов</span></div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    <span class="comment">//                      |          | элемента  | X | Y |Шир.|Выс.| окон диалога в MSDN)</span></div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;    <span class="comment">//----------------------+----------+-----------+---+---+----+----+---------------------------------------------</span></div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;    <span class="comment">//                      |          |           |   |   |    |    |</span></div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;        {{ <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657ada5bcedb21f2f49324595669e7b54cc7">txDialog::DIALOG</a>,  caption,   0,           0,  0, 240,  85                                                    },</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;         { <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a289c2dfb5643a7b29a82b1911d7ad9d0">txDialog::STATIC</a>,  text,      ID_TEXT_,   10, 10, 150,  40, SS_LEFT                                           },</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;         { <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a324e2bc01d53ba0c37be13075d8f8677">txDialog::EDIT</a>,    input,     ID_INPUT_,  10, 60, 220,  15, ES_LEFT | WS_BORDER | ES_AUTOHSCROLL | WS_TABSTOP },</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;         { <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a84a79295b5dc09aeffdc04a1844691fb">txDialog::BUTTON</a>,  <span class="stringliteral">&quot;&amp;OK&quot;</span>,     IDOK,      180, 10,  50,  15, BS_DEFPUSHBUTTON                     | WS_TABSTOP },</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;         { <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a84a79295b5dc09aeffdc04a1844691fb">txDialog::BUTTON</a>,  <span class="stringliteral">&quot;&amp;Cancel&quot;</span>, IDCANCEL,  180, 30,  50,  15, BS_PUSHBUTTON                        | WS_TABSTOP },</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;         { <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a30e281002a3bce0b5778269b9d831b41">txDialog::END</a>                                                                                                 }};</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;    <span class="comment">// Класс диалога для InputBox. Внутренний, т.к. зачем ему быть внешним.</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;    <span class="comment">// Нужен в основном для задания строки ввода (str) и оконной функции диалогового окна,</span></div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    <span class="comment">// требуемой Win32 (она построена макросами TX_BEGIN_MESSAGE_MAP и другими). Можно не делать</span></div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    <span class="comment">// внутреннего класса, но тогда оконную функцию придется писать в глобальной области видимости,</span></div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;    <span class="comment">// и str объявлять глобально тоже (или передавать ее адрес через DialogBoxParam и записывать</span></div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    <span class="comment">// его в класс во время обработки WM_INITDIALOG).</span></div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    <span class="keyword">struct </span>inputDlg : <a class="code" href="a00016.htm">txDialog</a></div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;        {</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;        <span class="keywordtype">char</span> str [1024];</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        <span class="comment">//---------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;        inputDlg() :</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;            str()                               <span class="comment">// Обнуление всей строки. Не работает на старых</span></div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;            {                                   <span class="comment">//     компиляторах, поэтому еще раз:</span></div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;            memset (str, 0, <span class="keyword">sizeof</span> (str));      <span class="comment">// Обнуление всей строки</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;            }</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;        <span class="comment">//---------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;        <a class="code" href="a00062.htm#gafca36de229c170968d003c75dbf3e728">TX_BEGIN_MESSAGE_MAP</a>()    <span class="comment">// Карта сообщений. На самом деле это начало оконной функции.</span></div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;            <a class="code" href="a00062.htm#ga3637c3398b6ebfa337171beec0770fe4">TX_COMMAND_MAP</a>        <span class="comment">// Здесь обрабатываются WM_COMMAND. На самом деле это switch.</span></div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                <span class="comment">//-------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;                <span class="comment">// При нажатии кнопки OK копируем строку из поля ввода в нашу переменную str,</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                <span class="comment">// т.к. после закрытия диалога строка ввода умрет и текст уже из нее получить.</span></div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                <span class="comment">// Этот макрос на самом деле превращается в case из оператора switch.</span></div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;                <span class="comment">// _wnd - это параметр оконной функции, см. определение макроса TX_BEGIN_MESSAGE_MAP().</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;                <span class="comment">//-------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                <a class="code" href="a00062.htm#ga36851fb6c9bcfc7eaea57befafe98e6d">TX_HANDLE</a> (IDOK) GetDlgItemText (_wnd, ID_INPUT_, str, sizeof (str) - 1);</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;        <a class="code" href="a00062.htm#ga3f4a70a0e5076cb4f4addcab0ca760cd">TX_END_MESSAGE_MAP</a></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;        <span class="comment">//---------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;        <span class="comment">// Конец внутреннего класса диалога</span></div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;        <span class="comment">//---------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;        <span class="preprocessor">#if defined (_GCC_VER) &amp;&amp; (_GCC_VER &gt;= 530) || \</span></div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;<span class="preprocessor">            defined (_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1900)</span></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;        <span class="keyword">private</span>:</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;        inputDlg (<span class="keyword">const</span> inputDlg&amp;)              = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;        inputDlg (<span class="keyword">const</span> inputDlg&amp;&amp;)             = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;        inputDlg&amp; operator = (<span class="keyword">const</span> inputDlg&amp;)  = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;        inputDlg&amp; operator = (<span class="keyword">const</span> inputDlg&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;        };</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;    <span class="comment">// Убираем дефайны, чтобы потом не мешали.</span></div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;    <span class="comment">// От этого они получаются &quot;локального действия&quot;, как будто у них была бы область видимости -</span></div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;    <span class="comment">// функция. На самом деле это сделано вручную через #undef. Чтобы подчеркнуть их локальную</span></div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;    <span class="comment">// природу, у них имена заканчиваются на _. Такие дейфайны потом не перекосячат весь код после</span></div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;    <span class="comment">// того как, фактически, стали уже не нужны.</span></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;<span class="preprocessor">    #undef ID_TEXT_</span></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;<span class="preprocessor">    #undef ID_INPUT_</span></div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;    <span class="comment">// Это статический объект, потому что строка в нем должна жить после завершения функции.</span></div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;    <span class="keyword">static</span> inputDlg dlg;</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;    <span class="comment">// Передаем layout и запускаем окно диалога</span></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;    dlg.dialogBox (layout);</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;    <span class="comment">// Возвращаем адрес строки из статического объекта. Так можно делать, потому что статический</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;    <span class="comment">// объект не умрет при выходе из функции и строка в нем, соответственно, тоже. Адрес</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;    <span class="comment">// нестатических переменных передавать синтаксически можно, но ведет к серьезным ошибкам.</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;    <span class="comment">//-------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;    <span class="keywordflow">return</span> dlg.str;</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;    }</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;<span class="comment">//{          TXLIB IMPLEMENTATION</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;<span class="comment">//           Реализация функций библиотеки</span></div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;<span class="comment">//{          [Internal] Function prototypes, macros and constants</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;<span class="comment">//           Прототипы внутренних функций, макросы и константы</span></div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span>     _TX_CP                = 1251;   <span class="comment">// Информация о локали</span></div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>    _TX_LC_CTYPE[]        = <span class="stringliteral">&quot;Russian&quot;</span>;</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;<span class="keyword">const</span> <span class="keywordtype">wchar_t</span> _TX_LC_CTYPE_W[]      = L<span class="stringliteral">&quot;Russian_Russia.ACP&quot;</span>;</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span>     _TX_IDM_ABOUT         = 40000;  <span class="comment">// Идентификаторы системного меню окна</span></div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span>     _TX_IDM_CONSOLE       = 40001;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;<span class="keywordtype">int</span>              _txInitialize();</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;<span class="keywordtype">void</span>             _txCleanup();</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;HWND             _txCanvas_CreateWindow (SIZE* size);</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span>      _txCanvas_OK();</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnCREATE     (HWND wnd);</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnDESTROY    (HWND wnd);</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnCLOSE      (HWND);</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnPAINT      (HWND wnd);</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnKEYDOWN    (HWND wnd, WPARAM vk, LPARAM info);</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnCHAR       (HWND wnd, WPARAM ch, LPARAM info);</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnTIMER      (HWND wnd, WPARAM <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnMOUSEMOVE  (HWND wnd, WPARAM buttons, LPARAM coords);</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnCmdCONSOLE (HWND wnd, WPARAM cmd);</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;<span class="keywordtype">bool</span>             _txCanvas_OnCmdABOUT   (HWND wnd, WPARAM cmd);</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;<span class="keywordtype">unsigned</span> WINAPI  _txCanvas_ThreadProc (<span class="keywordtype">void</span>* data);</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;LRESULT CALLBACK _txCanvas_WndProc (HWND wnd, UINT msg, WPARAM wpar, LPARAM lpar);</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;<span class="keywordtype">int</span>              _txCanvas_SetRefreshLock (<span class="keywordtype">int</span> count);</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;HDC              _txBuffer_Create (HWND wnd, <span class="keyword">const</span> POINT* size = NULL, HBITMAP bmap = NULL);</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;<span class="keywordtype">bool</span>             _txBuffer_Delete (HDC* dc);</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;<span class="keywordtype">bool</span>             _txBuffer_Select (HGDIOBJ obj, HDC dc = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">true</span>));</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;HWND             _txConsole_Attach();</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;<span class="keywordtype">bool</span>             _txConsole_OK();</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="keywordtype">bool</span>             _txConsole_Detach (<span class="keywordtype">bool</span> activate);</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="keywordtype">bool</span>             _txConsole_Draw (HDC dc);</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;<span class="keywordtype">bool</span>             _txConsole_SetUnicodeFont();</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;<span class="keywordtype">int</span>              _txSetFinishedText (HWND wnd);</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;<span class="keywordtype">void</span>             _txPauseBeforeTermination (HWND canvas);</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;<span class="keywordtype">bool</span>             _txIsParentWaitable (DWORD* parentPID = NULL);</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;PROCESSENTRY32*  _txFindProcess (<span class="keywordtype">unsigned</span> pid = GetCurrentProcessId());</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;<span class="keywordtype">bool</span>             _txKillProcess (DWORD pid);</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;<span class="keywordtype">bool</span>             _txInDll();</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;<span class="keywordtype">int</span>              _txGetInput();</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;PROC             _txSetProcAddress (<span class="keyword">const</span> <span class="keywordtype">char</span>* funcName, PROC newFunc, <span class="keyword">const</span> <span class="keywordtype">char</span>* dllName = NULL, HMODULE module = NULL,</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;                                    <span class="keywordtype">bool</span> debug = <span class="keyword">false</span>);</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;<span class="keywordtype">bool</span>             _txCreateShortcut (<span class="keyword">const</span> <span class="keywordtype">char</span> shortcutName[],</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> fileToLink[], <span class="keyword">const</span> <span class="keywordtype">char</span> args[] = NULL, <span class="keyword">const</span> <span class="keywordtype">char</span> workDir[] = NULL,</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> description[] = NULL, <span class="keywordtype">int</span> cmdShow = SW_SHOWNORMAL,</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> iconFile[] = NULL, <span class="keywordtype">int</span> iconIndex = 0, <span class="keywordtype">int</span> fontSize = 0,</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;                                    COORD bufSize = <a class="code" href="a00062.htm#ga779aead84bda35892b48c54418144d4d">ZERO</a> (COORD), COORD wndSize = <a class="code" href="a00062.htm#ga779aead84bda35892b48c54418144d4d">ZERO</a> (COORD), COORD wndOrg = <a class="code" href="a00062.htm#ga779aead84bda35892b48c54418144d4d">ZERO</a> (COORD));</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;<span class="keywordtype">void</span>*            _tx_DLGTEMPLATE_Create (<span class="keywordtype">void</span>* globalMem, <span class="keywordtype">size_t</span> bufsize, DWORD style, DWORD exStyle,</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;                                         WORD controls, <span class="keywordtype">short</span> x, <span class="keywordtype">short</span> y, <span class="keywordtype">short</span> cx, <span class="keywordtype">short</span> cy,</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">char</span> caption[], <span class="keyword">const</span> <span class="keywordtype">char</span> font[], WORD fontsize,</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;                                         HANDLE menu);</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;<span class="keywordtype">void</span>*            _tx_DLGTEMPLATE_Add    (<span class="keywordtype">void</span>* dlgTemplatePtr, <span class="keywordtype">size_t</span> bufsize, DWORD style, DWORD exStyle,</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                                         <span class="keywordtype">short</span> x, <span class="keywordtype">short</span> y, <span class="keywordtype">short</span> cx, <span class="keywordtype">short</span> cy,</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                                         WORD <span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> wclass[], <span class="keyword">const</span> <span class="keywordtype">char</span> caption[]);</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>*      _txError        (<span class="keyword">const</span> <span class="keywordtype">char</span> file[] = NULL, <span class="keywordtype">int</span> line = 0, <span class="keyword">const</span> <span class="keywordtype">char</span> func[] = NULL,</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">char</span> msg[] = NULL, ...) _TX_CHECK_FORMAT (4);</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;HICON            _txCreateTXIcon (<span class="keywordtype">int</span> size);</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;<span class="keywordtype">void</span>             _txOnSignal (<span class="keywordtype">int</span> signal = 0, <span class="keywordtype">int</span> fpe = 0);</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;BOOL WINAPI      _txOnConsoleCtrlEvent (DWORD type);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;<span class="keywordtype">void</span>             _txOnTerminate();</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;<span class="keywordtype">void</span>             _txOnUnexpected();</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;<span class="keywordtype">void</span>             _txOnCExit();</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;<span class="keywordtype">void</span>             _txOnExit (<span class="keywordtype">int</span> retcode);</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;<span class="keywordtype">void</span>             _txOnExitProcess (<span class="keywordtype">unsigned</span> retcode);</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;<span class="keywordtype">bool</span>             _txOnTerminateProcess (HANDLE process, <span class="keywordtype">unsigned</span> retcode);</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;FARPROC          _txDllImport (const <span class="keywordtype">char</span> dllFileName[], const <span class="keywordtype">char</span> funcName[], <span class="keywordtype">bool</span> required = true);</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;<span class="comment">// These are macros for __FILE__ and __LINE__ to work properly.</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="preprocessor">#if !defined (NDEBUG)</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;<span class="preprocessor">    #define  _TX_IF_ARGUMENT_FAILED( cond )    if (!assert (cond) &amp;&amp; (SetLastErrorEx (ERROR_BAD_ARGUMENTS, 0),   1))</span></div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;<span class="preprocessor">    #define  _TX_IF_TXWINDOW_FAILED            if (       !txOK() &amp;&amp; (SetLastErrorEx (ERROR_INVALID_DATA,  0),   1) &amp;&amp; \</span></div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;<span class="preprocessor">                                                  (TX_ERROR (&quot;\a&quot; &quot;Окно рисования не создано или не в порядке&quot;), 1))</span></div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;<span class="preprocessor">    #define  _TX_IF_ARGUMENT_FAILED( cond )    if (!       (cond) &amp;&amp; (SetLastErrorEx (ERROR_BAD_ARGUMENTS, 0),   1))</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;<span class="preprocessor">    #define  _TX_IF_TXWINDOW_FAILED            if (       !txOK() &amp;&amp; (SetLastErrorEx (ERROR_INVALID_DATA,  0),   1))</span></div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;<span class="comment">// Take action in debug configuration only.</span></div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;<span class="comment">// Definition ({ expr; }) would be better, but some old dinosaurs (yes it is MSVC 6) reject it. So sad. :&#39;(</span></div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;<span class="preprocessor">#if !defined (NDEBUG)</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;<span class="preprocessor">    #define  _TX_ON_DEBUG( code )              { code; }</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;<span class="preprocessor">    #define  _TX_ON_DEBUG( code )              ;</span></div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;<span class="comment">// This is a macro because cond is an expression and not always a function. Lack of lambdas in pre-C++0x.</span></div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;<span class="preprocessor">#define      _txWaitFor( cond, time )          { for (DWORD _t = GetTickCount() + (time); \</span></div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;<span class="preprocessor">                                                      !(cond) &amp;&amp; GetTickCount() &lt; _t;     \</span></div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;<span class="preprocessor">                                                      Sleep (_txWindowUpdateInterval)) ;  \</span></div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;<span class="preprocessor">                                                 if  (!(cond))                            \</span></div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;<span class="preprocessor">                                                      _txTrace (__FILE__, __LINE__, &quot;WARNING: Timeout: &quot; #cond &quot;.&quot;); }</span></div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;<span class="comment">//{          [Internal] DLL functions import</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;FARPROC _txDllImport (<span class="keyword">const</span> <span class="keywordtype">char</span> dllFileName[], <span class="keyword">const</span> <span class="keywordtype">char</span> funcName[], <span class="keywordtype">bool</span> required <span class="comment">/*= true*/</span>)</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;    {</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;    _TX_IF_ARGUMENT_FAILED (!(dllFileName &amp;&amp; !*dllFileName)) return NULL;</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;    _TX_IF_ARGUMENT_FAILED (  funcName    &amp;&amp;  *funcName)     return NULL;</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;    HMODULE                  dll = GetModuleHandle (dllFileName);</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;    if (!dll &amp;&amp; dllFileName) dll = LoadLibrary     (dllFileName);</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;    if (!dll &amp;&amp; required)  <a class="code" href="a00062.htm#ga5cd767f8040c04a51cb0173bf9255247">TX_ERROR</a> (&quot;\a&quot; &quot;Cannot load library \&quot;%s\&quot;&quot; <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> dllFileName);</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;    if (!dll) return NULL;</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;    FARPROC addr = GetProcAddress (dll, funcName);</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;    if (!addr &amp;&amp; required) <a class="code" href="a00062.htm#ga5cd767f8040c04a51cb0173bf9255247">TX_ERROR</a> (&quot;\a&quot; &quot;Cannot import \&quot;%s\&quot; from library \&quot;%s\&quot;&quot; <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> funcName <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> dllFileName);</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;    return addr;</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    }</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;<span class="comment">//           Import helpers</span></div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;<span class="comment">//           Малая механизация</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;<span class="preprocessor">#define _TX_DLLIMPORT(     lib, retval, name, params ) \</span></div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;<span class="preprocessor">     retval (WINAPI* name) params = (retval (WINAPI*) params) _txDllImport (lib &quot;.dll&quot;, #name, true)</span></div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;<span class="preprocessor">#define _TX_DLLIMPORT_OPT( lib, retval, name, params ) \</span></div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;<span class="preprocessor">     retval (WINAPI* name) params = (retval (WINAPI*) params) _txDllImport (lib &quot;.dll&quot;, #name, false)</span></div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;<span class="comment">// Some IDEs don&#39;t link with these libs by default in console projects, so do sunrise by hand. :(</span></div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;<span class="comment">//{ &lt;tears&gt;</span></div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;<span class="keyword">namespace </span>Win32 {</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;<span class="preprocessor">#ifdef _MSC_VER_6</span></div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;<span class="keyword">struct </span>CONSOLE_FONT_INFO;</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;<span class="keyword">struct </span>NT_CONSOLE_PROPS;</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;<span class="keyword">struct </span>CONSOLE_FONT_INFOEX;</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HDC,      CreateCompatibleDC,       (HDC dc));</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HBITMAP,  CreateCompatibleBitmap,   (HDC dc, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height));</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HGDIOBJ,  GetStockObject,           (<span class="keywordtype">int</span> <span class="keywordtype">object</span>));</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HGDIOBJ,  SelectObject,             (HDC dc, HGDIOBJ <span class="keywordtype">object</span>));</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HGDIOBJ,  GetCurrentObject,         (HDC dc, <span class="keywordtype">unsigned</span> objectType));</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">int</span>,      GetObjectA,               (HGDIOBJ obj, <span class="keywordtype">int</span> bufsize, <span class="keywordtype">void</span>* buffer));</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    DWORD,    GetObjectType,            (HGDIOBJ <span class="keywordtype">object</span>));</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     DeleteDC,                 (HDC dc));</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     DeleteObject,             (HGDIOBJ <span class="keywordtype">object</span>));</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    COLORREF, SetTextColor,             (HDC dc, COLORREF color));</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    COLORREF, SetBkColor,               (HDC dc, COLORREF color));</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">int</span>,      SetBkMode,                (HDC dc, <span class="keywordtype">int</span> bkMode));</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HFONT,    CreateFontA,              (<span class="keywordtype">int</span> height, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> escapement, <span class="keywordtype">int</span> orientation,</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;                                                                    <span class="keywordtype">int</span> weight, DWORD italic, DWORD underline, DWORD strikeout,</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;                                                                    DWORD charSet, DWORD outputPrec, DWORD clipPrec,</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;                                                                    DWORD quality, DWORD pitchAndFamily, <span class="keyword">const</span> <span class="keywordtype">char</span> face[]));</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">int</span>,      EnumFontFamiliesExA,      (HDC dc, LPLOGFONT logFont, FONTENUMPROC enumProc,</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;                                                                    LPARAM lParam, DWORD reserved));</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    COLORREF, SetPixel,                 (HDC dc, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, COLORREF color));</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    COLORREF, GetPixel,                 (HDC dc, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y));</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HPEN,     CreatePen,                (<span class="keywordtype">int</span> penStyle, <span class="keywordtype">int</span> width, COLORREF color));</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    HBRUSH,   CreateSolidBrush,         (COLORREF color));</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     MoveToEx,                 (HDC dc, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, POINT* point));</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     LineTo,                   (HDC dc, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y));</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     Polygon,                  (HDC dc, <span class="keyword">const</span> POINT points[], <span class="keywordtype">int</span> count));</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     Rectangle,                (HDC dc, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> x1, <span class="keywordtype">int</span> y1));</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     RoundRect,                (HDC dc, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> x1, <span class="keywordtype">int</span> y1, <span class="keywordtype">int</span> sizeX, <span class="keywordtype">int</span> sizeY));</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     Ellipse,                  (HDC dc, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> x1, <span class="keywordtype">int</span> y1));</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     Arc,                      (HDC dc, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> x1, <span class="keywordtype">int</span> y1,</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;                                                                    <span class="keywordtype">int</span> xStart, <span class="keywordtype">int</span> yStart, <span class="keywordtype">int</span> xEnd, <span class="keywordtype">int</span> yEnd));</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     Pie,                      (HDC dc, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> x1, <span class="keywordtype">int</span> y1,</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;                                                                    <span class="keywordtype">int</span> xStart, <span class="keywordtype">int</span> yStart, <span class="keywordtype">int</span> xEnd, <span class="keywordtype">int</span> yEnd));</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     Chord,                    (HDC dc, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> x1, <span class="keywordtype">int</span> y1,</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;                                                                    <span class="keywordtype">int</span> xStart, <span class="keywordtype">int</span> yStart, <span class="keywordtype">int</span> xEnd, <span class="keywordtype">int</span> yEnd));</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     TextOutA,                 (HDC dc, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keyword">const</span> <span class="keywordtype">char</span> <span class="keywordtype">string</span>[], <span class="keywordtype">int</span> length));</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    UINT,     SetTextAlign,             (HDC dc, <span class="keywordtype">unsigned</span> mode));</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     GetTextExtentPoint32A,    (HDC dc, <span class="keyword">const</span> <span class="keywordtype">char</span> <span class="keywordtype">string</span>[], <span class="keywordtype">int</span> length, SIZE* size));</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     ExtFloodFill,             (HDC dc, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, COLORREF color, <span class="keywordtype">unsigned</span> type));</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     BitBlt,                   (HDC dest, <span class="keywordtype">int</span> xDest, <span class="keywordtype">int</span> yDest, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;                                                                    HDC src,  <span class="keywordtype">int</span> xSrc,  <span class="keywordtype">int</span> ySrc,  DWORD rOp));</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">int</span>,      SetDIBitsToDevice,        (HDC dc, <span class="keywordtype">int</span> xDest, <span class="keywordtype">int</span> yDest, DWORD width, DWORD height,</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;                                                                    <span class="keywordtype">int</span> xSrc, <span class="keywordtype">int</span> ySrc, <span class="keywordtype">unsigned</span> startLine, <span class="keywordtype">unsigned</span> numLines,</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;                                                                    <span class="keyword">const</span> <span class="keywordtype">void</span>* data, <span class="keyword">const</span> BITMAPINFO* info, <span class="keywordtype">unsigned</span> colorUse));</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">int</span>,      GetDIBits,                (HDC hdc, HBITMAP hbmp, <span class="keywordtype">unsigned</span> uStartScan, <span class="keywordtype">unsigned</span> cScanLines,</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;                                                                    <span class="keywordtype">void</span>* lpvBits, BITMAPINFO* lpbi, <span class="keywordtype">unsigned</span> usage));</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">bool</span>,     PatBlt,                   (HDC dc, <span class="keywordtype">int</span> x0, <span class="keywordtype">int</span> y0, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, DWORD rOp));</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">int</span>,      SetROP2,                  (HDC dc, <span class="keywordtype">int</span> mode));</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;GDI32&quot;</span>,    <span class="keywordtype">int</span>,      SetStretchBltMode,        (HDC dc, <span class="keywordtype">int</span> mode));</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;User32&quot;</span>,   <span class="keywordtype">int</span>,      DrawTextA,                (HDC dc, <span class="keyword">const</span> <span class="keywordtype">char</span> text[], <span class="keywordtype">int</span> length, RECT* rect, <span class="keywordtype">unsigned</span> format));</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;User32&quot;</span>,   HANDLE,   LoadImageA,               (HINSTANCE inst, <span class="keyword">const</span> <span class="keywordtype">char</span> name[], <span class="keywordtype">unsigned</span> type,</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;                                                                   <span class="keywordtype">int</span> sizex, <span class="keywordtype">int</span> sizey, <span class="keywordtype">unsigned</span> mode));</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;User32&quot;</span>,   <span class="keywordtype">bool</span>,     IsHungAppWindow,          (HWND wnd));</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;User32&quot;</span>,   HWND,     GhostWindowFromHungWindow,(HWND wnd));</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;WinMM&quot;</span>,    <span class="keywordtype">bool</span>,     PlaySound,                (<span class="keyword">const</span> <span class="keywordtype">char</span> sound[], HMODULE mod, DWORD mode));</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;MSImg32&quot;</span>,  <span class="keywordtype">bool</span>,     TransparentBlt,           (HDC dest, <span class="keywordtype">int</span> destX, <span class="keywordtype">int</span> destY, <span class="keywordtype">int</span> destWidth, <span class="keywordtype">int</span> destHeight,</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                                                                    HDC src,  <span class="keywordtype">int</span> srcX,  <span class="keywordtype">int</span> srcY,  <span class="keywordtype">int</span> srcWidth,  <span class="keywordtype">int</span> srcHeight,</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;                                                                    <span class="keywordtype">unsigned</span> transparentColor));</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;MSImg32&quot;</span>,  <span class="keywordtype">bool</span>,     AlphaBlend,               (HDC dest, <span class="keywordtype">int</span> destX, <span class="keywordtype">int</span> destY, <span class="keywordtype">int</span> destWidth, <span class="keywordtype">int</span> destHeight,</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                                                                    HDC src,  <span class="keywordtype">int</span> srcX,  <span class="keywordtype">int</span> srcY,  <span class="keywordtype">int</span> srcWidth,  <span class="keywordtype">int</span> srcHeight,</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;                                                                    BLENDFUNCTION blending));</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;Kernel32&quot;</span>, <span class="keywordtype">void</span>,     ExitProcess,              (<span class="keywordtype">unsigned</span> retcode));</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;Kernel32&quot;</span>, <span class="keywordtype">bool</span>,     TerminateProcess,         (HANDLE process, <span class="keywordtype">unsigned</span> retcode));</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;Kernel32&quot;</span>, HWND,     GetConsoleWindow,         (<span class="keywordtype">void</span>));</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;Kernel32&quot;</span>, <span class="keywordtype">bool</span>,     SetConsoleFont,           (HANDLE con, DWORD fontIndex));</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;Kernel32&quot;</span>, DWORD,    GetNumberOfConsoleFonts,  (<span class="keywordtype">void</span>));</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;Kernel32&quot;</span>, <span class="keywordtype">bool</span>,     GetCurrentConsoleFont,    (HANDLE con, <span class="keywordtype">bool</span> maxWnd, CONSOLE_FONT_INFO*   curFont));</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;Kernel32&quot;</span>, <span class="keywordtype">bool</span>,     GetCurrentConsoleFontEx,  (HANDLE con, <span class="keywordtype">bool</span> maxWnd, CONSOLE_FONT_INFOEX* curFont));</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;Kernel32&quot;</span>, <span class="keywordtype">bool</span>,     SetCurrentConsoleFontEx,  (HANDLE con, <span class="keywordtype">bool</span> maxWnd, CONSOLE_FONT_INFOEX* curFont));</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;OLE32&quot;</span>,    HRESULT,  CoInitialize,             (<span class="keywordtype">void</span>*));</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;OLE32&quot;</span>,    HRESULT,  CoCreateInstance,         (REFCLSID clsid, LPUNKNOWN, DWORD, REFIID iid, PVOID* value));</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;OLE32&quot;</span>,    <span class="keywordtype">void</span>,     CoUninitialize,           (<span class="keywordtype">void</span>));</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;Shell32&quot;</span>,  HINSTANCE,ShellExecuteA,            (HWND wnd, <span class="keyword">const</span> <span class="keywordtype">char</span> operation[], <span class="keyword">const</span> <span class="keywordtype">char</span> file[],</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;                                                                    <span class="keyword">const</span> <span class="keywordtype">char</span> parameters[], <span class="keyword">const</span> <span class="keywordtype">char</span> directory[], <span class="keywordtype">int</span> showCmd));</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;NTDLL&quot;</span>,    <span class="keywordtype">char</span>*,    wine_get_version,         (<span class="keywordtype">void</span>));</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;_TX_DLLIMPORT     (<span class="stringliteral">&quot;MSVCRT&quot;</span>,   <span class="keywordtype">void</span>,     exit,                     (<span class="keywordtype">int</span> retcode));</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;_TX_DLLIMPORT_OPT (<span class="stringliteral">&quot;MSVCRT&quot;</span>,   <span class="keywordtype">void</span>,     _cexit,                   (<span class="keywordtype">void</span>));</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;<span class="comment">// Another issue, some of structs, consts and interfaces aren&#39;t defined in MinGW some ealry headers.</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;<span class="comment">// Copied from Windows SDK 7.0a.</span></div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;<span class="preprocessor">#ifndef AC_SRC_ALPHA</span></div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;<span class="preprocessor">#define AC_SRC_ALPHA          0x01</span></div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;<span class="preprocessor">#ifndef SMTO_ERRORONEXIT</span></div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;<span class="preprocessor">#define SMTO_ERRORONEXIT      0x0020</span></div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;<span class="preprocessor">#ifndef NT_CONSOLE_PROPS_SIG</span></div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;<span class="preprocessor">#define NT_CONSOLE_PROPS_SIG  0xA0000002</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;<span class="preprocessor">#ifndef NIIF_INFO</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;<span class="preprocessor">#define NIIF_INFO             0x00000001</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;<span class="preprocessor">#define NIIF_WARNING          0x00000002</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;<span class="preprocessor">#define NIIF_ERROR            0x00000003</span></div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;<span class="preprocessor">#ifndef NIF_INFO</span></div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;<span class="preprocessor">#define NIF_STATE             0x00000008</span></div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;<span class="preprocessor">#define NIF_INFO              0x00000010</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;<span class="preprocessor">#pragma pack (push, 1)</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;<span class="preprocessor">#ifdef _MSC_VER_6</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;<span class="keyword">struct </span>CONSOLE_FONT_INFO</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;    {</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    DWORD  nFont;</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;    COORD  dwFontSize;</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    };</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;<span class="keyword">struct </span>NOTIFYICONDATA</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;    {</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;    DWORD cbSize;</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;    HWND  hWnd;</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;    UINT  uID;</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;    UINT  uFlags;</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;    UINT  uCallbackMessage;</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;    HICON hIcon;</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;    CHAR  szTip[128];</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    DWORD dwState;</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;    DWORD dwStateMask;</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;    CHAR  szInfo[256];</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;        UINT uTimeout;</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;        UINT uVersion;</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;        } u;</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;    CHAR  szInfoTitle[64];</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;    DWORD dwInfoFlags;</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;    };</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="keyword">struct </span>CONSOLE_FONT_INFOEX</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;    {</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;    ULONG cbSize;</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;    DWORD nFont;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;    COORD dwFontSize;</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;    UINT  FontFamily;</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;    UINT  FontWeight;</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;    WCHAR FaceName[LF_FACESIZE];</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;    };</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;<span class="keyword">struct </span>DATABLOCK_HEADER</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;    {</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;    DWORD cbSize;</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;    DWORD dwSignature;</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;    };</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;<span class="keyword">struct </span>NT_CONSOLE_PROPS</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;    {</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;    DATABLOCK_HEADER dbh;</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;    WORD  wFillAttribute;</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;    WORD  wPopupFillAttribute;</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;    COORD dwScreenBufferSize;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;    COORD dwWindowSize;</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;    COORD dwWindowOrigin;</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;    DWORD nFont;</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;    DWORD nInputBufferSize;</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;    COORD dwFontSize;</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;    UINT  uFontFamily;</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    UINT  uFontWeight;</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;    WCHAR FaceName[LF_FACESIZE];</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;    UINT  uCursorSize;</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;    BOOL  bFullScreen;</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;    BOOL  bQuickEdit;</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;    BOOL  bInsertMode;</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;    BOOL  bAutoPosition;</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;    UINT  uHistoryBufferSize;</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;    UINT  uNumberOfHistoryBuffers;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;    BOOL  bHistoryNoDup;</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;    COLORREF ColorTable[16];</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;    };</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;<span class="preprocessor">#pragma pack (pop)</span></div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;<span class="preprocessor">#undef  INTERFACE</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;<span class="preprocessor">#define INTERFACE IShellLinkDataList</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;DECLARE_INTERFACE_ (IShellLinkDataList, IUnknown)</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;    {</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;    <span class="comment">// *** IUnknown methods ***</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;    STDMETHOD (QueryInterface)  (THIS_ REFIID iid, <span class="keywordtype">void</span>** value)    _tx_override PURE;</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;    STDMETHOD_(ULONG, AddRef)   (THIS)                              _tx_override PURE;</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;    STDMETHOD_(ULONG, Release)  (THIS)                              _tx_override PURE;</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;    <span class="comment">// *** IShellLinkDataList methods ***</span></div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;    STDMETHOD (AddDataBlock)    (THIS_ <span class="keywordtype">void</span>* dataBlock)             PURE;</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;    STDMETHOD (CopyDataBlock)   (THIS_ DWORD sig, <span class="keywordtype">void</span>** dataBlock) PURE;</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;    STDMETHOD (RemoveDataBlock) (THIS_ DWORD sig)                   PURE;</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;    STDMETHOD (GetFlags)        (THIS_ DWORD* flags)                PURE;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;    STDMETHOD (SetFlags)        (THIS_ DWORD  flags)                PURE;</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;    <span class="keyword">virtual</span> ~IShellLinkDataList();</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;    };</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;<span class="keyword">const</span> GUID IID_IShellLink         = {0x000214ee, 0x0000, 0x0000, {0xc0,0x00,0x00,0x00,0x00,0x00,0x00,0x46}};</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;<span class="keyword">const</span> GUID IID_IShellLinkDataList = {0x45e2b4ae, 0xb1c3, 0x11d0, {0xb9,0x2f,0x00,0xa0,0xc9,0x03,0x12,0xe1}};</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;<span class="keyword">const</span> GUID IID_IPersistFile       = {0x0000010b, 0x0000, 0x0000, {0xc0,0x00,0x00,0x00,0x00,0x00,0x00,0x46}};</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;<span class="preprocessor">#undef  INTERFACE</span></div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;}  <span class="comment">// namespace Win32</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;<span class="preprocessor">#ifdef _MSC_VER_6</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;<span class="keyword">using namespace </span>Win32;</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;<span class="comment">//} &lt;/tears&gt;</span></div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;<span class="comment">//{          [Internal] Global data</span></div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;<span class="comment">//           Данные не упакованы в структуру или класс, для того, чтобы это сделали Вы сами :)</span></div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;<span class="comment">//           Если вы пишете свою библиотеку и используете TXLib.h как примеру, не следуйте ему и не делайте так же.</span></div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;<span class="comment">//           Здесь это сделано только в образовательных целях.</span></div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;<span class="comment">//           Будьте практичнее, сделайте структуру и глобальную функцию для доступа к ней.</span></div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="keywordtype">int</span>                     _txInitialized         = <a class="code" href="a00064.htm#gaab281ee20ea6be5eae34d0e15bf03dcf">_TX_NOINIT</a> || _txInitialize();</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;<span class="keywordtype">unsigned</span>       <span class="keyword">volatile</span> _txMainThreadId        = 0;      <span class="comment">// ID потока, где выполняется main()</span></div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;<span class="keywordtype">unsigned</span>       <span class="keyword">volatile</span> _txCanvas_ThreadId     = 0;      <span class="comment">// ID потока, владеющего окном холста TXLib</span></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;HANDLE         <span class="keyword">volatile</span> _txCanvas_Thread       = NULL;   <span class="comment">// Дексриптор этого потока</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;HWND           <span class="keyword">volatile</span> _txCanvas_Window       = NULL;   <span class="comment">// Дескриптор окна холста TXLib</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;UINT                    _txCanvas_RefreshTimer = 0;      <span class="comment">// Timer to redraw TXLib window</span></div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;<span class="keywordtype">int</span>            <span class="keyword">volatile</span> _txCanvas_RefreshLock  = 0;      <span class="comment">// Blocks auto on-timer canvas update, see txBegin/txEnd</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;HDC                     _txCanvas_BackBuf[2]   = {NULL,  <span class="comment">// [0] Main working TXLib memory DC, where user picture lies</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;                                                  NULL}; <span class="comment">// [1] Image ready for auto-refresh, see txCanvas_OnPAINT()</span></div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;CRITICAL_SECTION        _txCanvas_LockBackBuf  = {0,-1}; <span class="comment">// Prevent simultaneous access to back buffer, see txLock()</span></div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;::std::vector&lt;HDC&gt;*     _txCanvas_UserDCs      = NULL;   <span class="comment">// List of DCs allocated, for auto-free</span></div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;<span class="keywordtype">bool</span>           <span class="keyword">volatile</span> _txConsole_IsBlinking  = <span class="keyword">true</span>;   <span class="comment">// To blink or not to blink, that is the question.</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;<span class="keywordtype">bool</span>                    _txConsole             = <span class="keyword">false</span>;  <span class="comment">// Only first TXLib module in app owns it</span></div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;<span class="keywordtype">bool</span>                    _txMain                = <span class="keyword">false</span>;  <span class="comment">// First TXLib wnd opened (closing it terminates program)</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;<span class="keywordtype">bool</span>                    _txIsDll               = <span class="keyword">false</span>;  <span class="comment">// TXLib module is in DLL</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;<span class="keywordtype">bool</span>           <span class="keyword">volatile</span> _txRunning             = <span class="keyword">false</span>;  <span class="comment">// main() is still running</span></div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;<span class="keywordtype">bool</span>           <span class="keyword">volatile</span> _txExit                = <span class="keyword">false</span>;  <span class="comment">// exit() is active</span></div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;<span class="keywordtype">bool</span>           <span class="keyword">volatile</span> _txAllowTrace          = <span class="keyword">true</span>;   <span class="comment">// Internal TX trace is active</span></div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;POINT                   _txMousePos            = {0};    <span class="comment">// Ask Captn Obviouos about it. See txCanvas_OnMOUSE()</span></div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;<span class="keywordtype">unsigned</span>                _txMouseButtons        =  0;</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;WNDPROC        <span class="keyword">volatile</span> _txAltWndProc          = NULL;   <span class="comment">// Альтернативная оконная функция. См. txSetWindowsHook().</span></div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>*    <span class="keyword">volatile</span> _txFile                = NULL;   <span class="comment">// Current execution point tracking, see $ macro</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;<span class="keywordtype">int</span>            <span class="keyword">volatile</span> _txLine                = 0;</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>*    <span class="keyword">volatile</span> _txFunc                = NULL;</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;_tx_thread <span class="keywordtype">int</span> <span class="keyword">volatile</span> _txInTX                = 0;      <span class="comment">// We are inside one of TXLib&#39;s functions</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;PROC           <span class="keyword">volatile</span> _txForceImportThese[]  = { (PROC) ::TerminateProcess, (PROC) ::ExitProcess, (PROC) ::exit };</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span>          _txSystemMessage[]     = { 0x776F656D, 0x5E2E2E5E };  <span class="comment">// A very system messages</span></div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;<span class="comment">//{          TXLib engine init/check/cleanup</span></div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;<span class="comment">//{          Early initialization</span></div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;<span class="keywordtype">int</span> _txInitialize()</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;    {</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;<span class="preprocessor">    #if defined (_TX_ALLOC_BREAK) &amp;&amp; defined (_MSC_VER)</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;    _CrtSetBreakAlloc (_TX_ALLOC_BREAK);</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;    _TX_ON_DEBUG (OutputDebugString (<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;                  OutputDebugString (<a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a> <span class="stringliteral">&quot; - The Dumb Artist Library, &quot;</span> _TX_AUTHOR <span class="stringliteral">&quot;: \&quot;&quot;</span> __FILE__ <span class="stringliteral">&quot;\&quot; &quot;</span></div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;                                     <span class="stringliteral">&quot;compiled &quot;</span> __DATE__ <span class="stringliteral">&quot; &quot;</span> __TIME__ <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="a00062.htm#ga3e287c38947fea870d01588fbd2a5fc9">_TX_BUILDMODE</a> <span class="stringliteral">&quot; mode, module: &quot;</span> <a class="code" href="a00062.htm#ga43d277b4418068ebef1fd2bdbaf550f6">_TX_MODULE</a> <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;                  OutputDebugString (<span class="stringliteral">&quot;\n&quot;</span>));</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;    _txMainThreadId = GetCurrentThreadId();</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;$1  _txIsDll = _txInDll();</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;$   <span class="keywordflow">if</span> (!_txIsDll)</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;        {</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;$       _txConsole = ! FindAtom (<span class="stringliteral">&quot;_txConsole&quot;</span>);  <span class="comment">// Not a thread-safe</span></div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;$       (void)          AddAtom (<span class="stringliteral">&quot;_txConsole&quot;</span>);</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;        }</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;$   <span class="keywordflow">if</span> (_txConsole)</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;        {</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;$       _txOnSignal();</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;$       SetErrorMode (SEM_FAILCRITICALERRORS | SEM_NOGPFAULTERRORBOX);</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;<span class="preprocessor">        #if defined (_MSC_VER)</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;$       _CrtSetDbgFlag    (_CRTDBG_ALLOC_MEM_DF | _CRTDBG_CHECK_ALWAYS_DF | _CRTDBG_LEAK_CHECK_DF);</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;$       _CrtSetReportMode (_CRT_WARN,   _CRTDBG_MODE_FILE | _CRTDBG_MODE_DEBUG);</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;$       _CrtSetReportMode (_CRT_ERROR,  _CRTDBG_MODE_FILE | _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_WNDW);</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;$       _CrtSetReportMode (_CRT_ASSERT, _CRTDBG_MODE_FILE | _CRTDBG_MODE_DEBUG | _CRTDBG_MODE_WNDW);</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;$       _CrtSetReportFile (_CRT_WARN,   _CRTDBG_FILE_STDERR);</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;$       _CrtSetReportFile (_CRT_ERROR,  _CRTDBG_FILE_STDERR);</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;$       _CrtSetReportFile (_CRT_ASSERT, _CRTDBG_FILE_STDERR);</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;<span class="preprocessor">        #ifndef _MSC_VER_6</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;$       ::std::set_unexpected (_txOnUnexpected);</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;$       ::std::set_terminate  (_txOnTerminate);</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;$       HWND console = _txConsole_Attach();</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;$       SetWindowTextA (console, <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a> (<span class="keyword">false</span>));</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;        }</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;$   InitializeCriticalSection (&amp;_txCanvas_LockBackBuf);</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;$   _txCanvas_UserDCs = new ::std::vector &lt;HDC&gt;;</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;$   _txSetProcAddress (<span class="stringliteral">&quot;TerminateProcess&quot;</span>, (PROC) _txOnTerminateProcess, <span class="stringliteral">&quot;KERNEL32.DLL&quot;</span>);</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;$   _txSetProcAddress (<span class="stringliteral">&quot;ExitProcess&quot;</span>,      (PROC) _txOnExitProcess,      <span class="stringliteral">&quot;KERNEL32.DLL&quot;</span>);</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;$   _txSetProcAddress (<span class="stringliteral">&quot;exit&quot;</span>,             (PROC) _txOnExit);</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;$   _txSetProcAddress (<span class="stringliteral">&quot;_cexit&quot;</span>,           (PROC) _txOnCExit);</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;$   SetConsoleCtrlHandler (_txOnConsoleCtrlEvent, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;$   atexit (_txCleanup);</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;$   (void) Win32::SetDIBitsToDevice;                     <span class="comment">// Just to suppress &quot;defined but not used&quot; warning</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;$   (void) Win32::RoundRect;</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;$   <span class="keywordflow">if</span> (_txConsole)</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;        {</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;$       <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x07);</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;$       SetLastError (0);</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;$       <a class="code" href="a00062.htm#ga5de732de72c46b992ac2feeac2de7e42">tx_fpreset</a>();</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;        }</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;$   srand ((<span class="keywordtype">unsigned</span>) time (NULL));</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;$   <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;    }</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;HWND <a class="code" href="a00059.htm#gafce21ce98474d5559f316b3d47cdbfab">txCreateWindow</a> (<span class="keywordtype">double</span> sizeX, <span class="keywordtype">double</span> sizeY, <span class="keywordtype">bool</span> centered <span class="comment">/*= true*/</span>)</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;    {</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;$1  <span class="keywordflow">if</span> (!_txInitialized) _txInitialized = _txInitialize();</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;$   <span class="keywordflow">if</span> (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>())</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;        {</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;$       SetLastErrorEx (ERROR_INVALID_DATA, 0);</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;$       _TX_ON_DEBUG (<a class="code" href="a00062.htm#ga5cd767f8040c04a51cb0173bf9255247">TX_ERROR</a> (<span class="stringliteral">&quot;\a&quot;</span> <span class="stringliteral">&quot;Окно рисования уже создано&quot;</span>));</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;$       <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>();</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;        }</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;$   <span class="keywordflow">if</span> (!_txIsDll)</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;        {</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;$       _txMain = ! FindAtom (<span class="stringliteral">&quot;_txMain&quot;</span>);  <span class="comment">// Not a thread-safe</span></div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;$       (void)       AddAtom (<span class="stringliteral">&quot;_txMain&quot;</span>);</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;        }</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;$   <span class="keywordflow">if</span> (_txWindowUpdateInterval &lt; 10) { $ _txWindowUpdateInterval = 10; }</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;$   _txRunning = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;    <span class="comment">// Store the size</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;$   <span class="keyword">static</span> SIZE size = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (sizeX), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (sizeY) };</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;$   <span class="keywordflow">if</span> (centered) { size.cx *= -1; size.cy *= -1; }</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;    <span class="comment">// In Thread, where REAL creation lies...</span></div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;<span class="preprocessor">    #if !( defined (_MSC_VER) &amp;&amp; (_MSC_VER &lt; 1400) &amp;&amp; !defined (_MT) )</span></div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;$   <span class="keywordtype">unsigned</span> <span class="keywordtype">id</span> = 0;</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;$   _txCanvas_Thread = (HANDLE) _beginthreadex (NULL, 0,                        _txCanvas_ThreadProc, &amp;size, 0, &amp;<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;$   DWORD    <span class="keywordtype">id</span> = 0;</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;$   _txCanvas_Thread =          CreateThread   (NULL, 0, (PTHREAD_START_ROUTINE)_txCanvas_ThreadProc, &amp;size, 0, &amp;<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;$   <span class="keywordflow">if</span> (!_txCanvas_Thread) <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;\a&quot;</span> <span class="stringliteral">&quot;Cannot start canvas thread.&quot;</span>), (HWND)NULL;</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;$   _txWaitFor (_txRunning, 30*_TX_TIMEOUT);</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;$   <span class="keywordflow">if</span> (!_txRunning)       <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;\a&quot;</span> <span class="stringliteral">&quot;Cannot create canvas window.&quot;</span>),(HWND)NULL;</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;$   <span class="keywordflow">if</span> (!<a class="code" href="a00059.htm#ga6971b22d5486b242e20a8dea1f21422a">txOK</a>())           <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;\a&quot;</span> <span class="stringliteral">&quot;Canvas window is not OK.&quot;</span>),    (HWND)NULL;</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;$   Sleep (100);</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;$   errno = 0; _doserrno = 0;</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;$   SetLastError (0);</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>();</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;    }</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga96652018e2f835ab629ddf52c1686d67">txSetDefaults</a> (HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;    {</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;$1  <a class="code" href="a00059.htm#gaff3d9c60900531f438a19216485bdd41">txUpdateWindow</a> (<span class="keyword">false</span>);</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;$   <a class="code" href="a00015.htm">txAutoLock</a> _lock;</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;$   RECT r = {0};</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;$   GetClientRect (Win32::GetConsoleWindow(), &amp;r) <a class="code" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a>;</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;$   SIZE szCon = { r.right - r.left, r.bottom - r.top };</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;$   HANDLE out = GetStdHandle (STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;$   CONSOLE_SCREEN_BUFFER_INFO con = {{80, 25}, {0}, 0, {0, 0, 80-1, 25-1}, {80, 25}};</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;$   GetConsoleScreenBufferInfo (out, &amp;con);</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;$   SIZE szTxt = { (short) (con.srWindow.Right  - con.srWindow.Left + 1),</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;                   (short) (con.srWindow.Bottom - con.srWindow.Top  + 1) };</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;<span class="comment">//{ Set defaults for graphics layer</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;$   _txBuffer_Select (Win32::GetStockObject (WHITE_PEN),   dc) <a class="code" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a>;</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;$   _txBuffer_Select (Win32::GetStockObject (WHITE_BRUSH), dc) asserted;</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;$   _txBuffer_Select (Win32::CreateFont (szCon.cy/szTxt.cy, szCon.cx/szTxt.cx,</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;                                         0, 0, FW_REGULAR, FALSE, FALSE, FALSE,</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;                                         RUSSIAN_CHARSET, OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS,</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;                                         DEFAULT_QUALITY, DEFAULT_PITCH, _txConsoleFont),</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;                      dc) asserted;</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;$  (Win32::SetTextColor      (dc, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a4992f4f094a8e2ae9fdb68cfff1f6025">TX_WHITE</a>) != CLR_INVALID) asserted;</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;$   Win32::SetBkMode         (dc, TRANSPARENT)              asserted;</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;$   Win32::SetROP2           (dc, R2_COPYPEN)               asserted;</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;$   Win32::SetStretchBltMode (dc, HALFTONE)                 asserted;</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;$   if (dc != <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (false)) return true;</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;<span class="comment">//{ Set defaults for console  layer</span></div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;$   POINT szCanvas = <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (dc);</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;$   HGDIOBJ font = <a class="code" href="a00059.htm#ga1dc38c08e812d5f5a3c8f752a97c2bb2">txFontExist</a> (_txConsoleFont)?</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;                       Win32::CreateFont ((<span class="keywordtype">int</span>) (1.0 * szCanvas.y/szTxt.cy), (<span class="keywordtype">int</span>) (1.0 * szCanvas.x/szTxt.cx),</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;                                          0, 0, FW_REGULAR, FALSE, FALSE, FALSE,</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;                                          RUSSIAN_CHARSET, OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS,</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;                                          DEFAULT_QUALITY, FIXED_PITCH, _txConsoleFont)</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;                       :</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;                       Win32::GetStockObject (SYSTEM_FIXED_FONT);</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;$   _txBuffer_Select (font, _txCanvas_BackBuf[1]) asserted;</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;<span class="comment">//{ Scroll the console for text to go above top of window and don&#39;t mix with graphics</span></div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;$   if (con.dwCursorPosition.X) _putch (&#39;\n&#39;);</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;$   <span class="keywordtype">short</span> delta = (<span class="keywordtype">short</span>) (con.dwCursorPosition.Y - con.srWindow.Top);</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;$   con.srWindow.Top    = (<span class="keywordtype">short</span>) (con.srWindow.Top    + delta);</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;$   con.srWindow.Bottom = (<span class="keywordtype">short</span>) (con.srWindow.Bottom + delta);</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;$   SMALL_RECT src  = {0, 0, (short) (con.dwSize.X - 1), (short) (con.dwSize.Y - 1) };</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;$   CHAR_INFO  fill = {{<span class="charliteral">&#39; &#39;</span>}, 0x07};        <span class="comment">// Fill with spaces, light-gray on black</span></div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;$   COORD      dest = {0, (short) -delta};  <span class="comment">// New UL-corner of src, scroll up</span></div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;$   con.dwCursorPosition.X = 0;</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;$   con.dwCursorPosition.Y = (short) (con.dwCursorPosition.Y - delta);</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;$   (con.srWindow.Bottom &lt; con.dwSize.Y &amp;&amp;                        <span class="comment">// Move the &quot;window&quot;</span></div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;     SetConsoleWindowInfo      (out, <span class="keyword">true</span>, &amp;con.srWindow))</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;    ||</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;    (ScrollConsoleScreenBuffer (out, &amp;src, NULL, dest, &amp;fill),    <span class="comment">// Or scroll the buffer</span></div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;     SetConsoleCursorPosition  (out, con.dwCursorPosition));</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;$   <a class="code" href="a00059.htm#gaff3d9c60900531f438a19216485bdd41">txUpdateWindow</a> (<span class="keyword">true</span>);</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;    }</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga6971b22d5486b242e20a8dea1f21422a">txOK</a>()</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;    {</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;    <span class="keywordflow">return</span> _txCanvas_OK();</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;    }</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;<span class="comment">//{          Cleanup</span></div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;<span class="comment">// Implicit std(MSVCRT.dll)::_cexit() call before _txCleanup can lead to hangs in _cexit handlers chain.</span></div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;<span class="comment">// So redefining ::std::_cexit(). Do it dynamically via PE Import Table hook to avoid duplicate symbols</span></div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;<span class="comment">// if several modules linked together include TXLib.h. See _txSetProcAddress() call in _txInitialize().</span></div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;<span class="keywordtype">void</span> _txOnCExit()</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;    {</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;$1  _txCleanup();</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;    <span class="keywordflow">if</span> (Win32::_cexit) { $ Win32::_cexit(); }</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;$   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;    }</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;<span class="keywordtype">void</span> _txOnExit (<span class="keywordtype">int</span> retcode)</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;    {</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;$1  _txCleanup();</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;$   Win32::exit (retcode);</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;$   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;    }</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;<span class="keywordtype">void</span> _txOnExitProcess (<span class="keywordtype">unsigned</span> retcode)</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;    {</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;$1  _txCleanup();</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;$   Win32::ExitProcess (retcode);</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;$   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;    }</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;<span class="keywordtype">bool</span> _txOnTerminateProcess (HANDLE process, <span class="keywordtype">unsigned</span> retcode)</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;    {</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;$1  _txCleanup();</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;$   <span class="keywordtype">bool</span> ret = Win32::TerminateProcess (process, retcode);</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;$   <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;    }</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;BOOL WINAPI _txOnConsoleCtrlEvent (DWORD type)</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;    {</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;$1  <span class="keywordflow">switch</span> (type)</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;        {</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;        <span class="keywordflow">case</span> CTRL_LOGOFF_EVENT:</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;        <span class="keywordflow">case</span> CTRL_SHUTDOWN_EVENT: $ _txExit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;                                  $ _txCleanup();</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;        <span class="keywordflow">case</span> CTRL_C_EVENT:</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;        <span class="keywordflow">case</span> CTRL_CLOSE_EVENT:</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;        <span class="keywordflow">case</span> CTRL_BREAK_EVENT:</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;        <span class="keywordflow">default</span>:                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;        }</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;    }</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;<span class="keywordtype">void</span> _txCleanup()</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;    {</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;$1  <span class="keywordflow">if</span> (!_txInitialized) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;    <span class="keywordflow">else</span> _txInitialized = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;$   <a class="code" href="a00059.htm#ga56227ddccbe156355eaca50264bf3334">txSleep</a> (_txWindowUpdateInterval);</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;$   _txRunning = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;$   _txConsole_IsBlinking = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;$   HWND canvas     = <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>();</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;$   HWND console    = Win32::GetConsoleWindow();</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;$   <span class="keywordtype">unsigned</span> thread = GetCurrentThreadId();</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;$   HWND wnd        = (canvas)? canvas : console;</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;$   <span class="keywordtype">bool</span> externTerm = (thread != _txMainThreadId &amp;&amp;</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;                       thread != _txCanvas_ThreadId);</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;$   DWORD parent = 0;</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;$   <span class="keywordtype">bool</span> waitableParent = !externTerm &amp;&amp; _txIsParentWaitable (&amp;parent);</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;$   <span class="keywordflow">if</span> (_txConsole)</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;        {</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;$       <span class="keywordflow">if</span> (_txMain) <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x07);</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;$       <span class="keywordflow">if</span> (console) EnableWindow (console, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;        }</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;$   <span class="keywordflow">if</span> (_txMain &amp;&amp; !externTerm &amp;&amp; wnd != NULL)</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;        { $ _txSetFinishedText (wnd); }</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;$   <span class="keywordflow">if</span> ((canvas? _txMain : _txConsole &amp;&amp; !waitableParent) &amp;&amp; !_txExit &amp;&amp;</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;        thread == _txMainThreadId)</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;        {</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;$       <span class="keywordflow">if</span> (wnd)</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;            {</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;$           ShowWindow          (wnd, SW_SHOW);</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;$           EnableWindow        (wnd, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;$           SetForegroundWindow (wnd);</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;$           BringWindowToTop    (wnd);</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;$           RedrawWindow        (wnd, NULL, NULL, RDW_INVALIDATE | RDW_INTERNALPAINT | RDW_UPDATENOW);</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;            }</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;$       <span class="keywordflow">if</span> (console)</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;            { $ _txPauseBeforeTermination (canvas); }</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;        }</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;$   <span class="keywordflow">if</span> (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>())</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;        { $ SendNotifyMessage (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(), WM_DESTROY, 0, 0); }</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;$   _txWaitFor (!<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(), 5*_TX_TIMEOUT);</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;$   <span class="keywordflow">if</span> (!<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>())</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;        { $ DeleteCriticalSection (&amp;_txCanvas_LockBackBuf); _txCanvas_LockBackBuf = <a class="code" href="a00062.htm#ga779aead84bda35892b48c54418144d4d">ZERO</a> (CRITICAL_SECTION); }</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;$   <span class="keywordflow">if</span> (_txCanvas_Thread)</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;        { $ CloseHandle (_txCanvas_Thread) asserted; _txCanvas_Thread = NULL; }</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;$   delete _txCanvas_UserDCs; _txCanvas_UserDCs = NULL;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;$   if (_txMain &amp;&amp; canvas &amp;&amp; waitableParent &amp;&amp; _txNOP (<a class="code" href="a00064.htm#ga9a495d013c6f08cd50220aca99ca56c2">_TX_ALLOW_KILL_PARENT</a>))</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;        { $ waitableParent |= !_txKillProcess (parent); }</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;$   <span class="keywordflow">if</span> (_txMain &amp;&amp; _txConsole)</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;        { $ _txConsole_Detach (waitableParent &amp;&amp; !externTerm); }</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;    _TX_ON_DEBUG (OutputDebugString (<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;                  OutputDebugString (<a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a> <span class="stringliteral">&quot; - FINISHED: &quot;</span> <a class="code" href="a00062.htm#ga43d277b4418068ebef1fd2bdbaf550f6">_TX_MODULE</a> <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;                  OutputDebugString (<span class="stringliteral">&quot;\n&quot;</span>));</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;    }</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;<span class="keywordtype">int</span> _txSetFinishedText (HWND wnd)</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;    {</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    <span class="keyword">struct </span>tools</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;        {</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;        <span class="keyword">static</span> LRESULT getWindowText (HWND window, <span class="keywordtype">wchar_t</span> text[], <span class="keywordtype">size_t</span> size)</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;            {</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;$1          memset (text, 0, size * <span class="keyword">sizeof</span> (*text));</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;$           <span class="keywordflow">return</span> SendMessageTimeoutW (window, WM_GETTEXT, (WPARAM) size, (LPARAM) text, SMTO_BLOCK | SMTO_ABORTIFHUNG, _TX_TIMEOUT, NULL);</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;            }</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;        <span class="keyword">static</span> LRESULT setWindowText (HWND window, <span class="keywordtype">wchar_t</span> text[])</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;            {</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;$1          <span class="keywordflow">return</span> SendMessageTimeoutW (window, WM_SETTEXT, 0,             (LPARAM) text, SMTO_BLOCK | SMTO_ABORTIFHUNG, _TX_TIMEOUT, NULL);</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;            }</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;        };</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;$1  <span class="keyword">static</span> <span class="keywordtype">wchar_t</span> title [_TX_BUFSIZE+15] = L<span class="stringliteral">&quot;TXLib&quot;</span>;</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;$   tools::getWindowText (wnd, title, _TX_BUFSIZE-1);</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;$   <span class="keywordtype">unsigned</span> len = (unsigned) wcslen (title); <span class="keywordflow">if</span> (len &gt;= _TX_BUFSIZE) len = _TX_BUFSIZE-1;</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;$   MultiByteToWideChar (_TX_CP, 0, <span class="stringliteral">&quot; [ЗАВЕРШЕНО]&quot;</span>, -1, title + len, _TX_BUFSIZE - len);</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;$   tools::setWindowText (wnd, title);</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;$   tools::getWindowText (wnd, title, _TX_BUFSIZE-1);</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;$   <span class="keywordflow">if</span> (len &lt;= _TX_BUFSIZE-1-2 &amp;&amp; title [len+2] == <span class="comment">/* &#39;З&#39; */</span> (<span class="keywordtype">wchar_t</span>) 0x0417) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;$   MultiByteToWideChar (_TX_CP, 0, <span class="stringliteral">&quot; [FINISHED]&quot;</span>,  -1, title + len, _TX_BUFSIZE - len);</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;$   tools::setWindowText (wnd, title);</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;$   tools::getWindowText (wnd, title, _TX_BUFSIZE-1);</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;$   <span class="keywordflow">if</span> (len &lt;= _TX_BUFSIZE-1-2 &amp;&amp; title [len+2] == <span class="comment">/* &#39;F&#39; */</span> (<span class="keywordtype">wchar_t</span>) 0x0046) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;$   <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    }</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;<span class="keywordtype">void</span> _txPauseBeforeTermination (HWND canvas)</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;    {</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;$1  <span class="keywordflow">while</span> (_kbhit()) (void)_getch();</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;$   CONSOLE_SCREEN_BUFFER_INFO con = {{0}};</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;$   <span class="keywordtype">bool</span> kbRedir = !GetConsoleScreenBufferInfo (GetStdHandle (STD_OUTPUT_HANDLE), &amp;con);</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;$   <span class="keywordtype">bool</span> kbWait  = (_txGetInput() == EOF);</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;$   <span class="keywordtype">bool</span> wine    = !!Win32::wine_get_version;</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;$   <span class="keywordflow">if</span> (kbWait &amp;&amp; !canvas &amp;&amp; !kbRedir &amp;&amp; !wine)</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;        {</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;$       printf (<span class="stringliteral">&quot;\n&quot;</span> <span class="stringliteral">&quot;[Нажмите любую клавишу для завершения]&quot;</span>);</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;        }</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;$   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; ; i++)</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;        {</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;$       Sleep (_txWindowUpdateInterval);</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;        <span class="keywordflow">if</span> (!kbWait || (kbRedir &amp;&amp; !canvas)) { $ <span class="keywordflow">break</span>; }  <span class="comment">// No need to run and hide</span></div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;        <span class="keywordflow">if</span> (!wine &amp;&amp; _txGetInput() != EOF)   { $ <span class="keywordflow">break</span>; }  <span class="comment">// Somebody hit something.</span></div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;        <span class="keywordflow">if</span> (canvas &amp;&amp; !_txCanvas_ThreadId)   { $ <span class="keywordflow">break</span>; }  <span class="comment">// There was a window, and now there is not.</span></div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;        <span class="keywordflow">if</span> (!Win32::GetConsoleWindow())      { $ <span class="keywordflow">break</span>; }  <span class="comment">// Console was destroyed</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;        <span class="keywordflow">if</span> (Win32::GhostWindowFromHungWindow &amp;&amp; Win32::GhostWindowFromHungWindow (canvas))</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;            { $ <a class="code" href="a00062.htm#ga5cd767f8040c04a51cb0173bf9255247">TX_ERROR</a> (<span class="stringliteral">&quot;Приложение зависло и будет закрыто.&quot;</span>); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;        <span class="keywordflow">if</span> (canvas &amp;&amp; Win32::IsHungAppWindow &amp;&amp; Win32::IsHungAppWindow (canvas))</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;            { $ _txTrace (__FILE__, __LINE__, <span class="stringliteral">&quot;WARNING: Приложение зависло и будет закрыто.&quot;</span>);     <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;        <span class="keywordflow">if</span> (canvas &amp;&amp; !SendMessageTimeout (canvas, WM_NULL, 0,0, SMTO_BLOCK | SMTO_ABORTIFHUNG, _TX_TIMEOUT, NULL))</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;            { $ _txTrace (__FILE__, __LINE__, <span class="stringliteral">&quot;WARNING: Приложение не отвечает и будет закрыто.&quot;</span>); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;        <span class="keywordflow">if</span> (!wine &amp;&amp; !(i % 100500))</div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;            { $ printf (<span class="stringliteral">&quot;\r&quot;</span> <span class="stringliteral">&quot;[Так нажмите же какую-нибудь клавишу для моего завершения]&quot;</span>); }</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;        }</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;$   <span class="keywordflow">while</span> (!wine &amp;&amp; _kbhit()) (void)_getch();</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;$   printf (<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;    }</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;<span class="keywordtype">int</span> _txGetInput()</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;    {</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;$1  HANDLE con = GetStdHandle (STD_INPUT_HANDLE);</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;$   DWORD nchars = 0;</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;$   <span class="keywordflow">if</span> (GetConsoleMode (con, &amp;nchars) == 0 &amp;&amp;</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;        PeekNamedPipe  (con, NULL, 0, NULL, &amp;nchars, NULL))</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;        {</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;$       <span class="keywordflow">return</span> (nchars)? fgetc (stdin) : EOF;</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;        }</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;$   <span class="keywordflow">if</span> (_kbhit())</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;        {</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;$       <span class="keywordflow">return</span> _getch();</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;        }</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;<span class="preprocessor">#if defined (_MSC_VER) &amp;&amp; (_MSC_VER &lt; 1700)</span></div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;$   <span class="keywordflow">if</span> (fseek (stdin, 1, SEEK_CUR) != EOF)</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;        {</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;$       (void) fseek (stdin, -1, SEEK_CUR);</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;$       <span class="keywordflow">return</span> fgetc (stdin);                              <span class="comment">// This causes blocking in MSVC 2011 beta</span></div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;        }</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;$   <span class="keywordflow">return</span> EOF;</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;    }</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;<span class="keywordtype">bool</span> _txIsParentWaitable (DWORD* parentPID <span class="comment">/*= NULL*/</span>)</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;    {</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;$1  PROCESSENTRY32* info = _txFindProcess();</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;$   <span class="keywordflow">if</span> (!info) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;$   info = _txFindProcess (info-&gt;th32ParentProcessID);</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;$   <span class="keywordflow">if</span> (!info) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;$   <span class="keywordtype">char</span> parent [MAX_PATH] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;$   strncpy_s (parent, info-&gt;szExeFile, sizeof (parent) - 1);</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;$   <span class="keywordflow">if</span> (parentPID) *parentPID = info-&gt;th32ProcessID;</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;$   info = _txFindProcess (info-&gt;th32ParentProcessID);          <span class="comment">// info: grandparent</span></div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;$   <span class="keywordtype">char</span> list[<a class="code" href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25">_TX_BUFSIZE</a>] = <a class="code" href="a00064.htm#ga2c0a4fe0612f109c5c88d6d55a061db5">_TX_WAITABLE_PARENTS</a>;</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;$   <span class="keywordtype">char</span>* ctx = NULL;</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;$   <span class="keywordflow">for</span> (<span class="keywordtype">char</span>* p = strtok_s (list, <span class="stringliteral">&quot;, &quot;</span>, &amp;ctx); p; p = strtok_s (NULL, <span class="stringliteral">&quot;, &quot;</span>, &amp;ctx))</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;        {</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;$       <span class="keywordtype">char</span>* gp = strchr (p, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;$       <span class="keywordflow">if</span> (gp)</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;            {</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;$           *gp++ = 0;</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;$           <span class="keywordflow">if</span> (_stricmp (p, parent) != 0) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;</div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;$           <span class="keywordflow">if</span> (info) <span class="keywordflow">if</span> (_stricmp (gp, info-&gt;szExeFile) == 0)  <span class="comment">// Was &amp;&amp;, but OMG MSVC /analyze...</span></div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;                { $ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;            }</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;            {</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;$           <span class="keywordflow">if</span> (_stricmp (p, parent) == 0)</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;                { $ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;            }</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;        }</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;    }</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;PROCESSENTRY32* _txFindProcess (<span class="keywordtype">unsigned</span> pid <span class="comment">/*= GetCurrentProcessId()*/</span>)</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;    {</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;$1  <span class="keyword">static</span> PROCESSENTRY32 info = { <span class="keyword">sizeof</span> (info) };</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;$   <span class="keywordflow">if</span> (!pid) <span class="keywordflow">return</span> &amp;info;</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;$   HANDLE sshot = CreateToolhelp32Snapshot (TH32CS_SNAPPROCESS, 0);</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (sshot); <span class="keywordflow">if</span> (!sshot) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;$   <span class="keywordflow">for</span> (<span class="keywordtype">bool</span> ok = !!Process32First (sshot, &amp;info); ok; ok = !!Process32Next (sshot, &amp;info))</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;        <span class="keywordflow">if</span> (info.th32ProcessID == pid) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;$   CloseHandle (sshot);</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;$   <span class="keywordflow">return</span> &amp;info;</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;    }</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;<span class="keywordtype">bool</span> _txInDll()</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;    {</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;$1  MODULEENTRY32 mod = { <span class="keyword">sizeof</span> (mod) };</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;$   HANDLE sshot = CreateToolhelp32Snapshot (TH32CS_SNAPMODULE, 0);</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (sshot); <span class="keywordflow">if</span> (!sshot) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;$   <span class="keywordtype">bool</span> inDll = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;$   <span class="keywordflow">for</span> (<span class="keywordtype">bool</span> ok = !!Module32First (sshot, &amp;mod); ok; ok = !!Module32Next (sshot, &amp;mod))</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;        {</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;$       <span class="keywordflow">if</span> (!mod.modBaseAddr) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;$       IMAGE_DOS_HEADER* dosHdr = (IMAGE_DOS_HEADER*)  mod.modBaseAddr;</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;$       IMAGE_NT_HEADERS* ntHdr  = (IMAGE_NT_HEADERS*) (mod.modBaseAddr + dosHdr-&gt;e_lfanew);</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;$       inDll = (dosHdr-&gt;e_magic  == IMAGE_DOS_SIGNATURE &amp;&amp;</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;                 ntHdr-&gt;Signature == IMAGE_NT_SIGNATURE  &amp;&amp;</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;                (ntHdr-&gt;FileHeader.Characteristics &amp; IMAGE_FILE_DLL) != 0);</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;$       <span class="keywordflow">if</span> (<a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> ((BYTE*)(ptrdiff_t)_txInDll, mod.modBaseAddr, mod.modBaseAddr + mod.modBaseSize)) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;        }</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;$   CloseHandle (sshot);</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;$   <span class="keywordflow">return</span> inDll;</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;    }</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;<span class="comment">// You are here, little hacker?</span></div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;<span class="keywordtype">bool</span> _txKillProcess (DWORD pid)</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;    {</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (pid) return false;</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;$   HANDLE token = INVALID_HANDLE_VALUE;</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;$   OpenProcessToken (GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;token) asserted;</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;$   LUID luid = {0};</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;$   LookupPrivilegeValue (NULL, SE_DEBUG_NAME, &amp;luid) asserted;</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;$   TOKEN_PRIVILEGES priv = { 1, {{{ luid.LowPart, luid.HighPart}, SE_PRIVILEGE_ENABLED }}};</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;$   TOKEN_PRIVILEGES old  = {0};</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;$   DWORD oldSz = 0;</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;$   AdjustTokenPrivileges (token, <span class="keyword">false</span>, &amp;priv, <span class="keyword">sizeof</span> (priv), &amp;old, &amp;oldSz) asserted;</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;$   HANDLE proc = OpenProcess (PROCESS_ALL_ACCESS, 0, pid);</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;$   if (!proc) return false;</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;$   <span class="keywordtype">bool</span> ok = !!TerminateProcess (proc, 0);</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;$   CloseHandle (proc);</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;$   return ok;</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;    }</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;<span class="comment">// TXLib continues to hack the reality to make your life better, sweeter and easier</span></div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;PROC _txSetProcAddress (const <span class="keywordtype">char</span>* funcName, PROC newFunc, const <span class="keywordtype">char</span>* dllName <span class="comment">/*= NULL*/</span>, HMODULE module <span class="comment">/*= NULL*/</span>,</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;                        <span class="keywordtype">bool</span> debug <span class="comment">/*= false*/</span>)</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;    {</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;$1  <span class="keywordflow">if</span> (debug) printf (<span class="stringliteral">&quot;_txSetProcAddress (%s, 0x%p, %s, 0x%p):\n&quot;</span>, funcName, (<span class="keywordtype">void</span>*)(ptrdiff_t)newFunc, dllName, (<span class="keywordtype">void</span>*) module);</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;$   _TX_IF_ARGUMENT_FAILED (funcName) return NULL;</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;$   _TX_IF_ARGUMENT_FAILED (newFunc)  return NULL;</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;$   if (!module) module = GetModuleHandle (NULL);</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;$   if (!module) return NULL;</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;$   HMODULE dll     = (dllName)? GetModuleHandle (dllName)       : NULL;</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;$   PROC    oldFunc = (dll)?     GetProcAddress  (dll, funcName) : NULL;</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;<span class="comment">//  For PE structure and Import Table format, e.g. see https://books.google.ru/books?id=ifQPC86G66sC&amp;pg=PA255</span></div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;<span class="comment">//  and below through Figure 5-5, and/or http://www.brokenthorn.com/Resources/OSDevPE.html.</span></div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;    <span class="preprocessor">#define RVA_( type, addr )  ( (type) ((ptrdiff_t) module + (ptrdiff_t) (addr)) )</span></div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;$   IMAGE_DOS_HEADER* dosHdr = RVA_ (IMAGE_DOS_HEADER*, 0);</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;$   IMAGE_NT_HEADERS* ntHdr  = RVA_ (IMAGE_NT_HEADERS*, dosHdr-&gt;e_lfanew);</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;$   <span class="keywordflow">if</span> (dosHdr-&gt;e_magic   != IMAGE_DOS_SIGNATURE ||</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;        ntHdr -&gt;Signature != IMAGE_NT_SIGNATURE) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;$   DWORD impOffset = ntHdr-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress;</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;$   IMAGE_IMPORT_DESCRIPTOR* desc = RVA_ (IMAGE_IMPORT_DESCRIPTOR*, impOffset);</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;$   <span class="keywordflow">if</span> (desc == (IMAGE_IMPORT_DESCRIPTOR*) ntHdr) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;$   IMAGE_THUNK_DATA* thunk0 = NULL, * thunk1 = NULL;</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;$   <span class="keywordtype">char</span>* impDll = NULL;</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;$   <span class="keywordtype">char</span>* impName = NULL;</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;$   <span class="keywordtype">void</span>** impPtr = NULL;</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;$   <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;    <span class="keywordflow">for</span> (; desc-&gt;Name; desc++)</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;        {</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;$       impDll = RVA_ (<span class="keywordtype">char</span>*, desc-&gt;Name);</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;$       <span class="keywordflow">if</span> (dllName &amp;&amp; _stricmp (impDll, dllName) != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;$       <span class="keywordflow">for</span> (thunk0 = RVA_ (IMAGE_THUNK_DATA*, desc-&gt;OriginalFirstThunk),</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;             thunk1 = RVA_ (IMAGE_THUNK_DATA*, desc-&gt;FirstThunk);</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;             thunk0 &amp;&amp; thunk1 &amp;&amp; thunk1-&gt;u1.Function;</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;             thunk0++,</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;             thunk1++)</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;            {</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;            impName = (<span class="keywordtype">char</span>*) RVA_ (IMAGE_IMPORT_BY_NAME*, thunk0-&gt;u1.AddressOfData) -&gt; Name;</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;            impPtr  = (<span class="keywordtype">void</span>**)                            &amp;thunk1-&gt;u1.Function;  <span class="comment">// Should change it, so this is ptr</span></div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;            if (debug) printf (<span class="stringliteral">&quot;[0x%p] %s!%s\n&quot;</span>, *impPtr, impDll, impName);</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;            <span class="keywordflow">if</span> ((oldFunc &amp;&amp; (ptrdiff_t) oldFunc == (ptrdiff_t) *impPtr) ||</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;                (impName &amp;&amp; _stricmp (funcName, impName) == 0))</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;                {</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;                found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;                }</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;            }</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;$       <span class="keywordflow">if</span> (found) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;        }</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;    <span class="keywordflow">if</span> (debug)</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;        printf (<span class="stringliteral">&quot;_txSetProcAddress (%s, 0x%p, %s, 0x%p): &quot;</span>, funcName, (<span class="keywordtype">void</span>*)(ptrdiff_t) newFunc, dllName, (<span class="keywordtype">void</span>*) module),</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;        printf (found? <span class="stringliteral">&quot;FOUND\n\n&quot;</span> : <span class="stringliteral">&quot;NOT found\n\n&quot;</span>);</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;$   <span class="keywordflow">if</span> (!found) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;$   DWORD rights = PAGE_READWRITE;</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;$   <span class="keywordflow">if</span> (!VirtualProtect (impPtr, <span class="keyword">sizeof</span> (*impPtr), rights, &amp;rights)) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;$   *(PROC*) impPtr = newFunc;  <span class="comment">// In different MS-SDKs this field has different types (DWORD/DWORD*/etc)</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;$   VirtualProtect (impPtr, <span class="keyword">sizeof</span> (*impPtr), rights, &amp;rights);</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;$   <span class="keywordflow">return</span> oldFunc;</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;<span class="preprocessor">    #undef RVA_</span></div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;    }</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;<span class="comment">//{          [Internal] TXLib window functions     (_txCanvas...)</span></div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;<span class="comment">//{</span></div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;<span class="preprocessor">#if defined (_MSC_VER_6) || defined (_GCC_VER) &amp;&amp; (_GCC_VER &lt;= 345)</span></div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;<span class="preprocessor">    #define SetClassLong_  SetClassLong</span></div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;<span class="preprocessor">    #define GCL_HICON_     GCL_HICON</span></div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;<span class="preprocessor">    #define GCL_HICONSM_   GCL_HICONSM</span></div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;<span class="preprocessor">    #define GCL_HCURSOR_   GCL_HCURSOR</span></div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;<span class="preprocessor">    #define SetClassLong_  SetClassLongPtr</span></div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;<span class="preprocessor">    #define GCL_HICON_     GCLP_HICON</span></div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;<span class="preprocessor">    #define GCL_HICONSM_   GCLP_HICONSM</span></div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;<span class="preprocessor">    #define GCL_HCURSOR_   GCLP_HCURSOR</span></div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;<span class="keywordtype">unsigned</span> WINAPI _txCanvas_ThreadProc (<span class="keywordtype">void</span>* data)</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;    {</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;$1  _txCanvas_ThreadId = GetCurrentThreadId();</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;$   _TX_IF_ARGUMENT_FAILED (data) return false;</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;$   HWND wnd = _txCanvas_CreateWindow ((SIZE*) data);</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;$   if (!<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>()) return <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (&quot;\a&quot; &quot;Cannot create canvas&quot;), 0;</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;$   HICON   icon32 = LoadIcon   (GetModuleHandle (NULL), &quot;_TX_ICON&quot;);</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;$   HICON   icon16 = LoadIcon   (GetModuleHandle (NULL), &quot;_TX_ICONSM&quot;);</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;$   HCURSOR cursor = LoadCursor (GetModuleHandle (NULL), &quot;_TX_CURSOR&quot;);</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;$   SetClassLong_ (wnd, GCL_HICON_,   (DWORD)(ptrdiff_t) (icon32? icon32 : _txCreateTXIcon (32)));</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;$   SetClassLong_ (wnd, GCL_HICONSM_, (DWORD)(ptrdiff_t) (icon16? icon16 : _txCreateTXIcon (16)));</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;$   SetClassLong_ (wnd, GCL_HCURSOR_, (DWORD)(ptrdiff_t) (cursor? cursor : LoadCursor (NULL, IDC_ARROW)));</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;$   HACCEL accel = LoadAccelerators (NULL, &quot;_TX_ACCELERATORS&quot;);</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;    _TX_ON_DEBUG (OutputDebugString (<a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a> &quot; - STARTED: &quot; <a class="code" href="a00062.htm#ga43d277b4418068ebef1fd2bdbaf550f6">_TX_MODULE</a> &quot;\n&quot;));</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;$   _txRunning = true;</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;$   ShowWindow          (wnd, SW_SHOW);</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;$   SetForegroundWindow (wnd);</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;$   UpdateWindow        (wnd);</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;$   MSG msg = {0};</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;$   <span class="keywordflow">while</span> (GetMessage (&amp;msg, NULL, 0, 0))</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;        {</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;$       <span class="keywordflow">if</span> (!msg.hwnd) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;$       <span class="keywordflow">if</span> (accel != NULL &amp;&amp; TranslateAccelerator (wnd, accel, &amp;msg)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;$       TranslateMessage (&amp;msg);</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;$       DispatchMessage  (&amp;msg);</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;</div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;$       Sleep (0);</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;        }</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;$   <span class="keywordflow">if</span> (icon16) DestroyIcon (icon16);  <span class="comment">// If Explorer is displaying Tray Notification, these</span></div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;$   <span class="keywordflow">if</span> (icon32) DestroyIcon (icon32);  <span class="comment">// calls will possibly fail, and we&#39;ll get resource leak.</span></div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;$   LeaveCriticalSection (&amp;_txCanvas_LockBackBuf);</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;$   <span class="keywordflow">if</span> (_txRunning &amp;&amp; _txMain)         <span class="comment">// Main window is destroyed but main() is still running.</span></div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;        {                              <span class="comment">// No chances for good termination, so use exit().</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;$       exit ((<span class="keywordtype">int</span>) msg.wParam);</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;        }</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;    _TX_ON_DEBUG (OutputDebugString (<a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a> <span class="stringliteral">&quot; - STOPPED: &quot;</span> <a class="code" href="a00062.htm#ga43d277b4418068ebef1fd2bdbaf550f6">_TX_MODULE</a> <span class="stringliteral">&quot;\n&quot;</span>));</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;$   _txCanvas_ThreadId = 0;</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;    }</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;<span class="comment">//{</span></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;<span class="preprocessor">#undef SetClassLong</span></div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;<span class="preprocessor">#undef GCL_HICON_</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;<span class="preprocessor">#undef GCL_HICONSM_</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;<span class="preprocessor">#undef GCL_HCURSOR_</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;HWND _txCanvas_CreateWindow (SIZE* size)</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;    {</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (size) return NULL;</div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;</div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;$   static <span class="keywordtype">char</span> className[_TX_BUFSIZE] = &quot;&quot;;</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;$   _snprintf_s (className, sizeof (className) - 1 _TX_TRUNCATE,</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;                 &quot;<span class="comment">/*---[TXLib]-------------------------- &quot;</span></div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;<span class="comment">                 _TX_VERSION &quot;  &quot; __FILE__ &quot;  WndClass %08X &quot;</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;<span class="comment">                  &quot;--------------------------[TXLib]---*/</span>&quot;, (<span class="keywordtype">int</span>) GetTickCount());</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;$   WNDCLASSEX wc    = { <span class="keyword">sizeof</span> (wc) };</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;$   wc.style         = CS_HREDRAW | CS_VREDRAW | CS_OWNDC;</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;$   wc.lpfnWndProc   = _txCanvas_WndProc;</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;$   wc.hCursor       = LoadCursor (NULL, IDC_ARROW);</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;$   wc.hbrBackground = (HBRUSH) Win32::GetStockObject (HOLLOW_BRUSH);</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;$   wc.lpszClassName = className;</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;$   ATOM wndclass = RegisterClassEx (&amp;wc);</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;$   <span class="keywordflow">if</span> (!wndclass) <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;RegisterClass (\&quot;%s\&quot;) failed&quot;</span> <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> className), (HWND) NULL;</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;$   <span class="keywordtype">int</span> centered = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;$   <span class="keywordflow">if</span> (size-&gt;cx &lt; 0 &amp;&amp; size-&gt;cy &lt; 0) { size-&gt;cx *= -1; size-&gt;cy *= -1; centered = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;</div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;$   SIZE scr = { GetSystemMetrics (SM_CXSCREEN), GetSystemMetrics (SM_CYSCREEN) };</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;$   RECT r   = { 0, 0, size-&gt;cx, size-&gt;cy }; AdjustWindowRect (&amp;r, _txWindowStyle, <span class="keyword">false</span>);</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;$   SIZE sz  = { r.right - r.left, r.bottom - r.top };</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;$   HWND wnd = CreateWindowEx (WS_EX_APPWINDOW, className, <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a> (<span class="keyword">false</span>), _txWindowStyle,</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;                               centered? scr.cx/2 - sz.cx/2 : CW_USEDEFAULT,</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;                               centered? scr.cy/2 - sz.cy/2 : CW_USEDEFAULT,</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;                               sz.cx, sz.cy, NULL, NULL, NULL, NULL);</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;$   <span class="keywordflow">if</span> (!wnd || !<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>()) <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;Cannot create canvas: CreateWindowEx (\&quot;%s\&quot;) failed&quot;</span> <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> className), (HWND) NULL;</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;$   HMENU menu = GetSystemMenu (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;$   <span class="keywordflow">if</span> (!menu) <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>();</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;$   AppendMenu (menu, MF_SEPARATOR, 0, NULL)                       asserted;</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;$   AppendMenu (menu, MF_STRING, _TX_IDM_CONSOLE, &quot;Show &amp;Console&quot;) asserted;</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;$   AppendMenu (menu, MF_STRING, _TX_IDM_ABOUT,   &quot;&amp;About...&quot;)     asserted;</div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;</div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;$   HWND console = Win32::GetConsoleWindow();</div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;$   DWORD proc = 0;</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;$   GetWindowThreadProcessId (console, &amp;proc);</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;$   if (console &amp;&amp; (proc == GetCurrentProcessId() || _txIsParentWaitable()))</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;        { $ ShowWindow (console, _txConsoleMode); }</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;$   CheckMenuItem (menu, _TX_IDM_CONSOLE, (console? (IsWindowVisible (console)? MF_CHECKED : 0) : MF_DISABLED));</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>();</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;    }</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> _txCanvas_OK()</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;    {</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;    <span class="keywordflow">return</span> _txCanvas_ThreadId   &amp;&amp;</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;           _txCanvas_Window     &amp;&amp;</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;           _txCanvas_BackBuf[0] &amp;&amp;</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;           _txCanvas_BackBuf[1];</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;    }</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;<span class="keywordtype">int</span> _txCanvas_SetRefreshLock (<span class="keywordtype">int</span> count)</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;    {</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;$1  <span class="keywordtype">int</span> oldCount = _txCanvas_RefreshLock;</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;$   _txCanvas_RefreshLock = count;</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;$   HWND wnd = <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>();</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;$   <span class="keywordflow">if</span> ((_txCanvas_RefreshLock &lt;= 0 || oldCount &lt;= 0) &amp;&amp; wnd)</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;        { $ RedrawWindow (wnd, NULL, NULL, RDW_INVALIDATE | RDW_INTERNALPAINT | RDW_UPDATENOW); }</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;$   <span class="keywordflow">return</span> oldCount;</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;    }</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;HICON _txCreateTXIcon (<span class="keywordtype">int</span> size)</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;    {</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (size == 32 || size == 16) return NULL;</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;$   const <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> image32 [32*32+1] =</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;        &quot;00000000000000000000000000000000&quot;&quot;0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0&quot;&quot;0F0000000000000000000000000000F0&quot;&quot;0F0000000000000000000000000000F0&quot;</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;        &quot;0F0000000000000099999999999900F0&quot;&quot;0F0000000000000090300333330900F0&quot;&quot;0F0000000990000090000000000900F0&quot;&quot;0F00000099990000900BB000000900F0&quot;</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;        &quot;0F0000039999000090B00090900900F0&quot;&quot;0F0000009999000090B00999990900F0&quot;&quot;0F00000009903799900BB090900900F0&quot;&quot;0F000000009BB70090000010000900F0&quot;</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;        &quot;0F0000000B90000090000000000900F0&quot;&quot;0F000000B0B0000099999999999900F0&quot;&quot;0F00007B30B0000090000000000000F0&quot;&quot;0F00007300B0000090000000000000F0&quot;</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;        &quot;0F00000000B3000090000000000000F0&quot;&quot;0F0000000B0B000090000000000000F0&quot;&quot;0F000000B303B00090000000000000F0&quot;&quot;0F000003B000B00090000000000000F0&quot;</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;        &quot;0F00003B00003B0090000000000000F0&quot;&quot;0F0000300000030090000000000000F0&quot;&quot;0F0000000448888888888844000000F0&quot;&quot;0F00004886E6E6E60E66E6EEEE4400F0&quot;</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;        &quot;0F4488866E0E60E00660E06E66EEE4F0&quot;&quot;0F868806E06E06E666E66E00E06EE6F0&quot;&quot;0F08606E66E0066000E006E66E00E6F0&quot;&quot;0F8666E006600E00006600E006E00EF0&quot;</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;        &quot;0F000E066888888888888888606660F0&quot;&quot;0F66EEE6EE000E00000E00086EEEE6F0&quot;&quot;0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0&quot;&quot;00000000000000000000000000000000&quot;;</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;$   const <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> image16 [16*16+1] =</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;        &quot;0000000000000000&quot;&quot;0000000999999990&quot;&quot;0009000900000090&quot;&quot;0099900909973090&quot;&quot;0059700909009390&quot;&quot;0009799909973090&quot;&quot;0099000900000090&quot;&quot;0959330999999990&quot;</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;        &quot;0709500900000000&quot;&quot;0095930900000000&quot;&quot;0090393900000000&quot;&quot;0790073900000000&quot;&quot;0900000900000000&quot;&quot;000EE6E6E6E6E000&quot;&quot;0EE6E6E6E6E6EEE0&quot;&quot;0000000000000000&quot;;</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;$   const COLORREF pal[&#39;F&#39;-&#39;0&#39;+1] = { 0x000000, 0x002b2b, 0x555500, 0x005555, 0x808000, 0x008080, 0xaaaa00, 0x00aaaa, 0xd5d500, 0x00d5d5, 0,0,0,0,0,0,0,</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;                                      0xffff00, 0x00ffff, 0xffffaa, 0xaaffff, 0xd5d500, 0xffffff };</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;$   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image = (size == 32)? image32 : image16;</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;$   POINT sz = { size, size };</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;$   HDC dcMask  = _txBuffer_Create (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(), &amp;sz); <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (dcMask);</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;$   HDC dcColor = _txBuffer_Create (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(), &amp;sz); <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (dcColor);</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;$   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size*size; i++)</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;        {</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;        <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (<a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (std::nomeow, image[i], <span class="charliteral">&#39;0&#39;</span>, <span class="charliteral">&#39;9&#39;</span>) ||</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;                <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (std::nomeow, image[i], <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;F&#39;</span>));</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;        Win32::SetPixel (dcColor, i % size, i / size, pal [image[i] - <span class="charliteral">&#39;0&#39;</span>]);</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;        }</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;$   ICONINFO info = { <span class="keyword">true</span>, 0, 0, (HBITMAP) Win32::GetCurrentObject (dcMask,  OBJ_BITMAP),</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;                                  (HBITMAP) Win32::GetCurrentObject (dcColor, OBJ_BITMAP) };</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;$   HICON icon = CreateIconIndirect (&amp;info);</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (icon);</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;$   _txBuffer_Delete (&amp;dcMask)  asserted;</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;$   _txBuffer_Delete (&amp;dcColor) asserted;</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;$   return icon;</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;    }</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;<span class="comment">//{          [Internal] Main window event handlers (_txCanvas_On...)</span></div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;LRESULT CALLBACK _txCanvas_WndProc (HWND wnd, UINT msg, WPARAM wpar, LPARAM lpar)</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;    {</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;<span class="preprocessor">#ifdef _TX_ALLOW_TRACE</span></div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;    _txInTX++;</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;    <span class="keywordflow">if</span> (_txAllowTrace) _txTrace (__FILE__, __LINE__, <a class="code" href="a00062.htm#gab170f39ac0e379c324c73495f14a1309">__TX_FUNCTION__</a>,</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;                                <span class="stringliteral">&quot;%*s&quot;</span> <span class="stringliteral">&quot;0x%X &lt;- 0x%03X (0x%08X, 0x%08lX)&quot;</span>, 12 - _txInTX*2, <span class="stringliteral">&quot;&quot;</span>, wnd, msg, wpar, lpar);</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;    _txInTX--;</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;$1  <span class="keywordflow">if</span> (msg == WM_KEYDOWN &amp;&amp; wpar == VK_F12 &amp;&amp;</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;        GetKeyState (VK_SHIFT) &amp;&amp; GetKeyState (VK_CONTROL) &amp;&amp; GetKeyState (VK_MENU))</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;        {</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;$       _txCanvas_OnCmdABOUT (wnd,      wpar);</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;$       <span class="keywordflow">return</span> DefWindowProc (wnd, msg, wpar, lpar);</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;        }</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;    WNDPROC altWndProc = _txAltWndProc;  <span class="comment">// Cache to prevent change from main thread</span></div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;    <span class="keywordflow">if</span> (altWndProc)</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;        {</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;$       LRESULT res = altWndProc (wnd, msg, wpar, lpar);</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;$       <span class="keywordflow">if</span> (res) <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;        }</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;    <span class="keywordflow">switch</span> (msg)</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;        {</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;        <span class="keywordflow">case</span> WM_CREATE:       $     _txCanvas_OnCREATE     (wnd);             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;        <span class="keywordflow">case</span> WM_CLOSE:        $ <span class="keywordflow">if</span> (_txCanvas_OnCLOSE      (wnd)) <span class="keywordflow">break</span>; <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;        <span class="keywordflow">case</span> WM_DESTROY:      $     _txCanvas_OnDESTROY    (wnd);             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;        <span class="keywordflow">case</span> WM_PAINT:        $     _txCanvas_OnPAINT      (wnd);             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;        <span class="keywordflow">case</span> WM_TIMER:        $     _txCanvas_OnTIMER      (wnd, wpar);       <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;        <span class="keywordflow">case</span> WM_KEYDOWN:      $     _txCanvas_OnKEYDOWN    (wnd, wpar, lpar); <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;        <span class="keywordflow">case</span> WM_CHAR:         $     _txCanvas_OnCHAR       (wnd, wpar, lpar); <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;        <span class="keywordflow">case</span> WM_LBUTTONUP:</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;        <span class="keywordflow">case</span> WM_LBUTTONDOWN:</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;        <span class="keywordflow">case</span> WM_RBUTTONUP:</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;        <span class="keywordflow">case</span> WM_RBUTTONDOWN:</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;        <span class="keywordflow">case</span> WM_MBUTTONUP:</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;        <span class="keywordflow">case</span> WM_MBUTTONDOWN:</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;        <span class="keywordflow">case</span> WM_MOUSEMOVE:    $     _txCanvas_OnMOUSEMOVE  (wnd, wpar, lpar); <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;        }</div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;</div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;    <span class="keywordflow">if</span> (msg == WM_SYSCOMMAND) <span class="keywordflow">switch</span> (wpar)</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;        {</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;        <span class="keywordflow">case</span> _TX_IDM_ABOUT:   $     _txCanvas_OnCmdABOUT   (wnd, wpar);       <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;        <span class="keywordflow">case</span> _TX_IDM_CONSOLE: $     _txCanvas_OnCmdCONSOLE (wnd, wpar);       <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;        }</div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;$   <span class="keywordflow">return</span> DefWindowProc (wnd, msg, wpar, lpar);</div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;    }</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnCREATE (HWND wnd)</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;    {</div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (wnd) return false;</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;$   _txCanvas_BackBuf[0] = _txBuffer_Create (wnd); <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (_txCanvas_BackBuf[0]);</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;$   _txCanvas_BackBuf[1] = _txBuffer_Create (wnd); <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (_txCanvas_BackBuf[1]);</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;$   SetTimer (wnd, _txCanvas_RefreshTimer, _txWindowUpdateInterval, NULL) asserted;</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;$   _txCanvas_Window = wnd;</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;$   <a class="code" href="a00059.htm#ga96652018e2f835ab629ddf52c1686d67">txSetDefaults</a>();</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;$   return true;</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;    }</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnDESTROY (HWND wnd)</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;    {</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (wnd) return false;</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;    <span class="comment">// Инициируем остановку цикла сообщений</span></div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;$   PostQuitMessage (_txRunning? WM_DESTROY : EXIT_SUCCESS);</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;$   if (!_txCanvas_Window) return false;</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;</div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    <span class="comment">// Indicate that we are about to manually terminate</span></div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;$   _txExit = true;</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;    <span class="comment">// Lock GDI resources</span></div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;$   <span class="keywordtype">bool</span> locked = false;</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;$   _txWaitFor ((locked = <a class="code" href="a00063.htm#ga532fa8a55c4f3d4f94ff0fdceae732b2">txLock</a> (false), locked), _TX_TIMEOUT);</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;$   if (!locked) <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (&quot;Cannot lock GDI to free resources&quot;);</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;    <span class="comment">// Освобождаем пользовательские ресурсы</span></div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;</div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;$   if (_txCanvas_UserDCs &amp;&amp; _txCanvas_UserDCs-&gt;size())</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;        {</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;$       <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (NIIF_ERROR, NULL, <span class="stringliteral">&quot;Вы забыли освободить %d HDC.&quot;</span>, (<span class="keywordtype">int</span>) _txCanvas_UserDCs-&gt;size());</div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;$       Sleep (_TX_TIMEOUT);</div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;$       <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; _txCanvas_UserDCs-&gt;size(); i++) _txBuffer_Delete (&amp;_txCanvas_UserDCs-&gt;at (i));</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;$       _txCanvas_UserDCs-&gt;clear();</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;        }</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;    <span class="comment">// Освобождаем ресурсы, связанные с окном</span></div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;$   <span class="keywordflow">if</span> (_txCanvas_RefreshTimer) KillTimer (wnd, _txCanvas_RefreshTimer) asserted;</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;$   if (_txCanvas_BackBuf[1]) _txBuffer_Delete (&amp;_txCanvas_BackBuf[1])  asserted;</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;$   if (_txCanvas_BackBuf[0]) _txBuffer_Delete (&amp;_txCanvas_BackBuf[0])  asserted;</div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;$   <a class="code" href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a>();</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;    <span class="comment">// Indicate that we are destroyed</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;$   _txCanvas_Window = NULL;</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;$   return true;</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;    }</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnCLOSE (HWND wnd)</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;    {</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (wnd &amp;&amp; _txCanvas_OK()) return false;</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;$   if (_txMain &amp;&amp; _txRunning &amp;&amp;</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;        <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (&quot;Функция main() не завершена. Программа все еще работает. Прервать аварийно?    \n\n&quot;</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;                      &quot;Лучше подождать, когда main() завершится - это отображается в заголовке окна.&quot;,</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;                      <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a> (false), MB_OKCANCEL | MB_ICONSTOP) != IDOK) return false;</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;$   return true;</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;    }</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;</div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnTIMER (HWND wnd, WPARAM)</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;    {</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (wnd) return false;</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;$   if (_txCanvas_RefreshLock &gt; 0 || !_txRunning) return false;</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;$   InvalidateRect (wnd, NULL, false) asserted;</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;$   UpdateWindow   (wnd)              asserted;</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;$   return true;</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;    }</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnPAINT (HWND wnd)</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;    {</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (wnd &amp;&amp; _txCanvas_OK()) return false;</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;$   <span class="keywordtype">bool</span> forceRedraw   = GetAsyncKeyState (VK_MENU)  &amp;&amp; GetAsyncKeyState (VK_CONTROL) &amp;&amp;</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;                         GetAsyncKeyState (VK_SHIFT) &amp;&amp; GetAsyncKeyState (VK_SNAPSHOT);</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;$   PAINTSTRUCT ps = {0};</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;$   HDC dc = BeginPaint (wnd, &amp;ps);</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;$   <span class="keywordflow">if</span> (!dc) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;$   RECT r = {0};</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;$   GetClientRect (wnd, &amp;r) asserted;</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;$   POINT size = { r.right - r.left, r.bottom - r.top };</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;$   <span class="keywordflow">if</span> ((_txCanvas_RefreshLock &lt;= 0 || forceRedraw) &amp;&amp;</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;        <a class="code" href="a00063.htm#ga532fa8a55c4f3d4f94ff0fdceae732b2">txLock</a> (<span class="keyword">false</span>))</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;        {</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;$       Win32::BitBlt (_txCanvas_BackBuf[1], 0, 0, size.x, size.y, <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keyword">false</span>), 0, 0, SRCCOPY);</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;$       _txConsole_Draw (_txCanvas_BackBuf[1]);</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;$       <a class="code" href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a>();</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;        }</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;    <span class="comment">// Magic 100500 value is used to completely block screen refresh.</span></div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;    <span class="comment">// Since no value can be 100500 or above, this condition is always true and the refresh cannot be blocked IRL.</span></div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;    <span class="comment">// Do not use 100501 because it may lead to errors on some compilers and possible may crash the compilers</span></div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;    <span class="comment">// themselves.</span></div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;    <span class="comment">// Yes guys, with all your software installed. :(</span></div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;$   <span class="keywordflow">if</span> (_txCanvas_RefreshLock != 100500)</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;        { $ Win32::BitBlt (dc, 0, 0, size.x, size.y, _txCanvas_BackBuf[1], 0, 0, SRCCOPY); }</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;$   EndPaint (wnd, &amp;ps) asserted;</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;$   return true;</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;    }</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnKEYDOWN (HWND, WPARAM vk, LPARAM info)</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;    {</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;$1  INPUT_RECORD evt = {0};</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;$   evt.EventType                        = KEY_EVENT;</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;$   evt.Event.KeyEvent.bKeyDown          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;$   evt.Event.KeyEvent.wRepeatCount      = 1;</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;$   evt.Event.KeyEvent.uChar.AsciiChar   = (char)  MapVirtualKey ((WORD) vk, 2);   <span class="comment">// 2 == MAPVK_VK_TO_CHAR</span></div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;$   evt.Event.KeyEvent.wVirtualScanCode  = (WORD)  (info &gt;&gt; 16);</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;$   evt.Event.KeyEvent.wVirtualKeyCode   = (WORD)  vk;</div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;$   evt.Event.KeyEvent.dwControlKeyState = (DWORD) (info &amp; (1 &lt;&lt; 24))? ENHANCED_KEY : 0;</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;$   <span class="keywordflow">if</span> (evt.Event.KeyEvent.uChar.AsciiChar) <span class="keywordflow">return</span> <span class="keyword">false</span>;  <span class="comment">// Let TranslateMessage() and WM_CHAR do the job</span></div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;$   DWORD written = 0;</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;$   WriteConsoleInput (GetStdHandle (STD_INPUT_HANDLE), &amp;evt, 1, &amp;written);</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;    }</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnCHAR (HWND, WPARAM ch, LPARAM info)</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;    {</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;$1  INPUT_RECORD evt = {0};</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;$   evt.EventType                        = KEY_EVENT;</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;$   evt.Event.KeyEvent.bKeyDown          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;$   evt.Event.KeyEvent.wRepeatCount      = 1;</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;$   evt.Event.KeyEvent.uChar.AsciiChar   = (char) (ch);</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;$   evt.Event.KeyEvent.wVirtualScanCode  = (WORD) (info &gt;&gt; 16);</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;$   evt.Event.KeyEvent.wVirtualKeyCode   = (WORD) MapVirtualKey ((WORD) (info &gt;&gt; 16), 3);  <span class="comment">// 3 == MAPVK_VSC_TO_VK_EX</span></div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;$   evt.Event.KeyEvent.dwControlKeyState = 0;</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;$   DWORD written = 0;</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;$   WriteConsoleInput (GetStdHandle (STD_INPUT_HANDLE), &amp;evt, 1, &amp;written);</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;    }</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnMOUSEMOVE (HWND, WPARAM buttons, LPARAM coords)</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;    {</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (_txCanvas_OK()) return false;</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;$   _txMousePos.x   = LOWORD (coords);</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;$   _txMousePos.y   = HIWORD (coords);</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;$   _txMouseButtons = (<span class="keywordtype">unsigned</span>) buttons;</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;$   return true;</div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;    }</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;</div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnCmdCONSOLE (HWND wnd, WPARAM cmd)</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;    {</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (wnd) return false;</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;$   HWND console = Win32::GetConsoleWindow();</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;$   if (!console) return false;</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;</div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;$   <span class="keywordtype">bool</span> visible = !!IsWindowVisible (console);</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;</div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;$   ShowWindow (console, visible? SW_HIDE : SW_SHOW);</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;$   visible = !!IsWindowVisible (console);</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;$   CheckMenuItem (GetSystemMenu (wnd, false), (<span class="keywordtype">int</span>) cmd, visible? MF_CHECKED : MF_UNCHECKED);</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;$   return true;</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;    }</div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;<span class="keywordtype">bool</span> _txCanvas_OnCmdABOUT (HWND, WPARAM)</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;    {</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;$1  <span class="comment">//{ Overriding the missing names, if the set is uncomplete</span></div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;<span class="preprocessor">    #if defined (__MODULE)</span></div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;<span class="preprocessor">        #define ABOUT_NAME_    __MODULE</span></div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;<span class="preprocessor">        #define ABOUT_NAME_    &quot;TXLib&quot;</span></div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;<span class="preprocessor">    #if defined (__MODULE) || defined (__VERSION) || defined (__DESCRIPTION) || defined (__AUTHOR)</span></div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;<span class="preprocessor">        #ifndef __MODULE</span></div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;<span class="preprocessor">        #define __MODULE       &quot;TXLib&quot;                           &quot;\n&quot;  &quot;#define __MODULE to set the name.\n&quot;</span></div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;<span class="preprocessor">        #ifndef __VERSION</span></div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;<span class="preprocessor">        #define __VERSION      &quot;(0.000000000).&quot;                  &quot;\n&quot; &quot;#define __VERSION to set the string value.\n&quot;</span></div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;<span class="preprocessor">        #ifndef __DESCRIPTION</span></div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;<span class="preprocessor">        #define __DESCRIPTION  &quot;(Да, мне лень задать описание).&quot; &quot;\n&quot; &quot;#define __DESCRIPTION to override project role.\n&quot;</span></div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;<span class="preprocessor">        #ifndef __AUTHOR</span></div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;<span class="preprocessor">        #define __AUTHOR       &quot;(Непонятно кто).&quot;                &quot;\n&quot; &quot;#define __AUTHOR to override this name.&quot;</span></div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;$   time_t timeT     = time (NULL) - clock()/CLOCKS_PER_SEC;</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;$   <span class="keywordtype">char</span>   timeS[32] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;$   ctime_s (timeS, <span class="keyword">sizeof</span> (timeS), &amp;timeT);</div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;$   <span class="keyword">static</span> <span class="keywordtype">char</span> text[<a class="code" href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25">_TX_BUFSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;$   <span class="keywordtype">char</span> cwd [MAX_PATH] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;$   _snprintf_s (text, <span class="keyword">sizeof</span> (text) - 1 _TX_TRUNCATE,</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;</div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;                 <span class="stringliteral">&quot;Application:\n&quot;</span></div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;</div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;                 #<span class="keywordflow">if</span> defined (__MODULE) || defined (__VERSION) || defined (__DESCRIPTION) || defined (__AUTHOR)</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;                     __MODULE <span class="stringliteral">&quot; version &quot;</span> __VERSION <span class="stringliteral">&quot;\n&quot;</span> __DESCRIPTION <span class="stringliteral">&quot;\n&quot;</span> <span class="stringliteral">&quot;Copyright (c) &quot;</span> __AUTHOR <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;                 #<span class="keywordflow">else</span></div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;                     <span class="stringliteral">&quot;Здесь могла бы быть Ваша реклама :)\n&quot;</span></div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;                     <span class="stringliteral">&quot;#define __MODULE to \&quot;your program name\&quot; before including TXLib.h to use this billboard...\n&quot;</span></div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;                 #endif</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;                 <span class="stringliteral">&quot;\n&quot;</span> <span class="stringliteral">&quot;Developed with:\n\n&quot;</span></div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;                 <span class="stringliteral">&quot;The Dumb Artist Library (TX Library) - &quot;</span> <a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a> <span class="stringliteral">&quot;\n&quot;</span> _TX_AUTHOR <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;                 <span class="stringliteral">&quot;See license on: http://txlib.ru\n\n&quot;</span></div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;                 <span class="stringliteral">&quot;TXLib file:&quot;</span> <span class="stringliteral">&quot;\t&quot;</span> __FILE__ <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                 <span class="stringliteral">&quot;Compiled:&quot;</span>   <span class="stringliteral">&quot;\t&quot;</span> __DATE__ <span class="stringliteral">&quot; &quot;</span> __TIME__ <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="a00062.htm#ga3e287c38947fea870d01588fbd2a5fc9">_TX_BUILDMODE</a> <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="a00062.htm#gadd1c9ccd036228402b807abaea14f7ee">__TX_COMPILER__</a> <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;                 <span class="stringliteral">&quot;Started:&quot;</span>    <span class="stringliteral">&quot;\t&quot;</span> <span class="stringliteral">&quot;%.6s %.4s %.8s\n\n&quot;</span></div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;                 <span class="stringliteral">&quot;Run file:&quot;</span>   <span class="stringliteral">&quot;\t&quot;</span> <span class="stringliteral">&quot;%s\n&quot;</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                 <span class="stringliteral">&quot;Directory:&quot;</span>  <span class="stringliteral">&quot;\t&quot;</span> <span class="stringliteral">&quot;%s&quot;</span>,</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;                 timeS + 4, timeS + 20, timeS + 11,  <span class="comment">// These offsets are ANSI standardized</span></div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;                 <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a>(),</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;                 _getcwd (cwd, <span class="keyword">sizeof</span> (cwd) - 1));</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;$   <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (text, <span class="stringliteral">&quot;About &quot;</span> ABOUT_NAME_, MB_ICONINFORMATION);</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;    <span class="comment">// And a bit of HTTP-code in C++ function:</span></div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;    <span class="keywordflow">goto</span> http;</div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;    http:<span class="comment">//txlib.ru                                  // See valuable refs here :)</span></div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;<span class="preprocessor">    #undef ABOUT_NAME_</span></div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;    }</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;<span class="comment">//{          [Internal] Console-support functions  (_txConsole...)</span></div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;HWND _txConsole_Attach()</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;    {</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;$1  HWND console = Win32::GetConsoleWindow();</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;$   <span class="keywordflow">if</span> (!console)</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;        {</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;$       FreeConsole();</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;$       AllocConsole();</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;        }</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;$   console = Win32::GetConsoleWindow();</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;$   <span class="keywordflow">if</span> (!console) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;    <span class="comment">// Linux::Wine v1.2.2+ compatibility.</span></div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;    <span class="comment">// Beer compatibility will be added in future versions.</span></div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;    <span class="comment">// Минздрав РФ предупреждает: чрезмерное употребление wine вредит Вашему здоровью.</span></div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;$   <span class="keywordflow">if</span> (Win32::wine_get_version)</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;        {</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;$       Win32::GetNumberOfConsoleFonts = NULL;</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;$       Win32::GetCurrentConsoleFont   = NULL;</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;$       Win32::SetConsoleFont          = NULL;</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;        }</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;    <span class="comment">// Устанавливаем русскую кодовую страницу для консоли Windows</span></div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;$   SetConsoleCP       (_TX_CP);  <span class="comment">// 1251</span></div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;$   SetConsoleOutputCP (_TX_CP);  <span class="comment">// 1251</span></div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;    <span class="comment">// Устанавливаем русскую кодовую страницу для стандартной библиотеки, иначе не будут работать Unicode-версии</span></div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;    <span class="comment">// функций (wprintf, ...). Если компилите с помощью gcc и собираетесь использовать L&quot;unicode-строки&quot; с русским</span></div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;    <span class="comment">// языком, укажите опции в командной строке компилятора g++: -finput-charset=CP1251 -fexec-charset=CP1251.</span></div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;$   setlocale (LC_CTYPE, _TX_LC_CTYPE);                                    <span class="comment">//  &quot;Russian&quot;</span></div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;$   <span class="keywordflow">if</span> (!Win32::wine_get_version) _wsetlocale (LC_CTYPE, _TX_LC_CTYPE_W);  <span class="comment">// L&quot;Russian_Russia.ACP&quot;</span></div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;$   <span class="keyword">static</span> <span class="keywordtype">bool</span> done = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;$   <span class="keywordflow">if</span> (done) <span class="keywordflow">return</span> console;</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;    <span class="comment">// Впечатлительным лучше сюда не смотреть.</span></div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;$   <span class="keywordflow">if</span> (!Win32::wine_get_version)</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;        { $ _txConsole_SetUnicodeFont(); }</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;<span class="preprocessor">#ifndef _CONSOLE</span></div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;    <span class="comment">// Переоткрываем заново &lt;s&gt;Америку&lt;/s&gt; потоки ввода-вывода, если subsystem != console</span></div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;$                    *stdin  = *_fdopen (_open_osfhandle ((DWORD)(ptrdiff_t) GetStdHandle (STD_INPUT_HANDLE),  _O_TEXT), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;$   fflush (stdout); *stdout = *_fdopen (_open_osfhandle ((DWORD)(ptrdiff_t) GetStdHandle (STD_OUTPUT_HANDLE), _O_TEXT), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;$   fflush (stderr); *stderr = *_fdopen (_open_osfhandle ((DWORD)(ptrdiff_t) GetStdHandle (STD_ERROR_HANDLE),  _O_TEXT), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;$   setvbuf (stdin,  NULL, _IONBF, 0);</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;$   setvbuf (stdout, NULL, _IONBF, 0);</div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;$   setvbuf (stderr, NULL, _IONBF, 0);</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;$   ::std::ios::sync_with_stdio();</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;</div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;    <span class="comment">// That&#39;s all, folks</span></div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;$   done = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;$   <span class="keywordflow">return</span> console;</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;    }</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;</div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> _txConsole_OK()</div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;    {</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;    <span class="keywordflow">return</span> Win32::GetConsoleWindow() != NULL;</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;    }</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;<span class="keywordtype">bool</span> _txConsole_Detach (<span class="keywordtype">bool</span> activate)</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;    {</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;$1  HWND console = Win32::GetConsoleWindow();</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;$   <span class="keywordflow">if</span> (!console) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;$   EnableWindow (console, <span class="keyword">true</span>);</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;$   ShowWindow   (console, SW_SHOW);</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;</div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;$   <span class="keywordflow">if</span> (activate)</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;        {</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;$       SetForegroundWindow (console);</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;$       BringWindowToTop    (console);</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;        }</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;</div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;$   <span class="keywordflow">return</span> !!FreeConsole();</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;    }</div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;</div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;</div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;<span class="keywordtype">bool</span> _txConsole_Draw (HDC dc)</div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;    {</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;$   HANDLE out = GetStdHandle (STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;$   CONSOLE_SCREEN_BUFFER_INFO con = {{0}};</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;$   BOOL ok = GetConsoleScreenBufferInfo (out, &amp;con);</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;$   <span class="keywordflow">if</span> (!ok) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;</div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;$   POINT size = { con.srWindow.Right  - con.srWindow.Left + 1,</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;                   con.srWindow.Bottom - con.srWindow.Top  + 1 };</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;$   SIZE fontSz = { 12, 16 };</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;$   Win32::GetTextExtentPoint32 (dc, <span class="stringliteral">&quot;W&quot;</span>, 1, &amp;fontSz) asserted;</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;$   COLORREF pal [16] = { 0x000000, 0x800000, 0x008000, 0x808000, 0x000080, 0x800080, 0x008080, 0xC0C0C0,</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;                          0x808080, 0xFF0000, 0x00FF00, 0xFFFF00, 0x0000FF, 0xFF00FF, 0x00FFFF, 0xFFFFFF };</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;$   <span class="keywordflow">for</span> (<span class="keywordtype">short</span> y = 0; y &lt; size.y; y++)</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;        {</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">char</span> chr [_TX_BUFSIZE + 1] = <span class="stringliteral">&quot;&quot;</span>;  <span class="comment">// [con.dwSize.X + 1]; maybe will be truncated</span></div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;        <span class="keyword">static</span> WORD atr [_TX_BUFSIZE + 1] = {0}; <span class="comment">// [con.dwSize.X + 1]; maybe will be truncated</span></div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;        COORD coord = { (short) (con.srWindow.Left), (short) (y + con.srWindow.Top) };</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;        DWORD read  = 0;</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;        <span class="keywordflow">if</span> (!ReadConsoleOutputCharacter (out, chr, <a class="code" href="a00062.htm#gaf13b370e460b5a25a00c37c1a1c10927">SIZEARR</a> (chr) - 1, coord, &amp;read)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;        <span class="keywordflow">if</span> (!ReadConsoleOutputAttribute (out, atr, <a class="code" href="a00062.htm#gaf13b370e460b5a25a00c37c1a1c10927">SIZEARR</a> (atr) - 1, coord, &amp;read)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0, xEnd = size.x; x &lt; size.x; x = xEnd)</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;            {</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;            Win32::SetTextColor (dc, pal [ atr[x]       &amp; 0x0F]);</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;            Win32::SetBkColor   (dc, pal [(atr[x] &gt;&gt; 4) &amp; 0x0F]);</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;            Win32::SetBkMode    (dc,      (atr[x]       &amp; 0xF0)? OPAQUE : TRANSPARENT);</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;            <span class="keywordflow">for</span> (xEnd = x+1; atr[xEnd] == atr[x] &amp;&amp; xEnd &lt; size.x; xEnd++) {;}</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;            Win32::TextOut (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (fontSz.cx * (x + con.srWindow.Left)),</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;                                <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (fontSz.cy *  y), chr + x, xEnd - x) asserted;</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;            }</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;        }</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;$   Win32::SetTextColor (dc, pal [ con.wAttributes       &amp; 0x0F]);</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;$   Win32::SetBkColor   (dc, pal [(con.wAttributes &gt;&gt; 4) &amp; 0x0F]);</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;$   Win32::SetBkMode    (dc, TRANSPARENT);</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;</div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;$   if (_txConsole_IsBlinking &amp;&amp;</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;        <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (con.dwCursorPosition, con.srWindow) &amp;&amp;</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;        GetTickCount() % _txCursorBlinkInterval*2 &gt; _txCursorBlinkInterval &amp;&amp;</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;        GetForegroundWindow() == <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>())</div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;        {</div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;$       Win32::TextOut (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (fontSz.cx * (con.dwCursorPosition.X - con.srWindow.Left)),</div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;                            <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (fontSz.cy * (con.dwCursorPosition.Y - con.srWindow.Top)) + 1,</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;                            <span class="stringliteral">&quot;_&quot;</span>, 1) asserted;</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;        }</div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;$   return true;</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;    }</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;<span class="comment">//{          Welcome to the Duck Side! Together we will rule the Bathroom!</span></div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="keywordtype">bool</span> _txConsole_SetUnicodeFont()</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;    {</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;    <span class="comment">// Начиная с Висты все хорошо...</span></div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;$1  <span class="keywordflow">if</span> (Win32::GetCurrentConsoleFontEx &amp;&amp; Win32::SetCurrentConsoleFontEx)</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;        {</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;$       HANDLE out = GetStdHandle (STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;$       Win32::CONSOLE_FONT_INFOEX info = { <span class="keyword">sizeof</span> (info) };</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;$       <span class="keywordflow">if</span> (!Win32::GetCurrentConsoleFontEx (out, <span class="keyword">false</span>, &amp;info)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;$       info.FontFamily = 0x36;                                                    <span class="comment">// Unicode fixed-pitch</span></div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;$       <span class="keywordflow">if</span> (!*info.FaceName) info.dwFontSize.Y = (SHORT) (info.dwFontSize.Y + 2);  <span class="comment">// Terminal font is too small</span></div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;$       wcsncpy_s (info.FaceName, L<span class="stringliteral">&quot;Lucida Console&quot;</span>, <a class="code" href="a00062.htm#gaf13b370e460b5a25a00c37c1a1c10927">SIZEARR</a> (info.FaceName));</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;$       <span class="keywordflow">return</span> !!Win32::SetCurrentConsoleFontEx (out, <span class="keyword">false</span>, &amp;info);</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;        }</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;    <span class="comment">// ...а до этого все не так сладко</span></div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;</div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;$   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> uniFont = 10;  <span class="comment">// The Internet and W2K sources know this magic number</span></div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;$   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> uniSize = 20;  <span class="comment">// Size of the font desired, should be &gt; max of Raster Fonts</span></div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;$   <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;    <span class="comment">// Force Windows to use Unicode font by creating and run the console shortcut tuned to use that font.</span></div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;</div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;$   HANDLE out = GetStdHandle (STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;$   <span class="keywordflow">if</span> (Win32::GetNumberOfConsoleFonts &amp;&amp; Win32::GetNumberOfConsoleFonts() &lt;= uniFont)</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;        {</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;$       HRESULT init = Win32::CoInitialize (NULL);</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;$       <span class="keywordtype">size_t</span> sz = 0;</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;$       <span class="keywordtype">char</span> link [MAX_PATH] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;$       getenv_s (&amp;sz, link, <span class="keyword">sizeof</span> (link) - 1, <span class="stringliteral">&quot;TEMP&quot;</span>);</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;$       strncat_s (link, <span class="stringliteral">&quot;\\~txLink.lnk&quot;</span>, <span class="keyword">sizeof</span> (link) - 1);</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;</div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;$       <span class="keywordtype">char</span> comspec [MAX_PATH] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;$       getenv_s (&amp;sz, comspec, <span class="keyword">sizeof</span> (comspec), <span class="stringliteral">&quot;COMSPEC&quot;</span>);</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;</div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;$       (void) _unlink (link);</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;</div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;$       _txCreateShortcut (link, comspec, <span class="stringliteral">&quot;/c exit&quot;</span>, NULL, NULL, SW_SHOWMINNOACTIVE, NULL, 0, uniSize) asserted;</div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;$       ok = (Win32::ShellExecuteA (NULL, NULL, link, NULL, NULL, SW_SHOWMINNOACTIVE) &gt; (<span class="keywordtype">void</span>*)32);  <span class="comment">// Sic!</span></div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;        if (ok) { $ _txWaitFor (FindWindow (NULL, <span class="stringliteral">&quot;~txLink&quot;</span>), _TX_TIMEOUT); }</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;$       (void) _unlink (link);</div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;</div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;$       <span class="keywordflow">if</span> (init == S_OK) Win32::CoUninitialize();</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;        }</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;    <span class="comment">// If Unicode font is not already set, do set it.</span></div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;$   CONSOLE_FONT_INFO cur = {0};</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;    <span class="keywordflow">if</span> (Win32::GetCurrentConsoleFont) { $ Win32::GetCurrentConsoleFont (out, <span class="keyword">false</span>, &amp;cur); }</div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;$   ok &amp;= (cur.nFont &gt;= uniFont);</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;    <span class="keywordflow">if</span> (!ok) { $ ok &amp;= Win32::SetConsoleFont &amp;&amp; Win32::SetConsoleFont (out, uniFont); }</div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;$   HWND console = Win32::GetConsoleWindow();</div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;$   InvalidateRect (console, NULL, <span class="keyword">false</span>);</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;$   UpdateWindow   (console);</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;$   <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;    }</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;</div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;<span class="comment">//{          The nightmare helpers</span></div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;<span class="preprocessor">#define      _TX_TRY                { goto __tx_try; } __tx_try: { int __tx_error = S_OK; (void)__tx_error;</span></div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;<span class="preprocessor">#define      _TX_CHECKED( cmd )     { if (FAILED (__tx_error = (cmd))) goto __tx_catch; }</span></div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;<span class="preprocessor">#define      _TX_FAIL               { __tx_error = E_FAIL; goto __tx_catch; }</span></div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;<span class="preprocessor">#define      _TX_RETRY              { __tx_error = S_OK;   goto __tx_try;   }</span></div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;<span class="preprocessor">#define      _TX_OK                 ( SUCCEEDED (__tx_error) )</span></div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;<span class="preprocessor">#define      _TX_CATCH              goto __tx_finally; __tx_catch:</span></div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;<span class="preprocessor">#define      _TX_RETURN             goto __tx_finally;</span></div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;<span class="preprocessor">#define      _TX_FINALLY            __tx_finally:</span></div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;<span class="preprocessor">#define      _TX_ENDTRY             }</span></div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;<span class="comment">// Мало не покажется</span></div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;<span class="keywordtype">bool</span> _txCreateShortcut (<span class="keyword">const</span> <span class="keywordtype">char</span> shortcutName[],</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">char</span> fileToLink[], <span class="keyword">const</span> <span class="keywordtype">char</span> args[] <span class="comment">/*= NULL*/</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> workDir[] <span class="comment">/*= NULL*/</span>,</div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">char</span> description[] <span class="comment">/*= NULL*/</span>, <span class="keywordtype">int</span> cmdShow <span class="comment">/*= SW_SHOWNORMAL*/</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> iconFile[] <span class="comment">/*= NULL*/</span>, <span class="keywordtype">int</span> iconIndex <span class="comment">/*= 0*/</span>,</div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;                        <span class="keywordtype">int</span> fontSize <span class="comment">/*= 0*/</span>, COORD bufSize <span class="comment">/*= ZERO (COORD)*/</span>, COORD wndSize <span class="comment">/*= ZERO (COORD)*/</span>, COORD wndOrg <span class="comment">/*=ZERO (COORD)*/</span>)</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;    {</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (shortcutName &amp;&amp; *shortcutName) return false;</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;$   _TX_IF_ARGUMENT_FAILED (fileToLink   &amp;&amp; *fileToLink)   return false;</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;</div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;$   IShellLink* shellLink = NULL;</div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;$   Win32::IShellLinkDataList* dataList = NULL;</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;$   IPersistFile* file = NULL;</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;$   HRESULT init = Win32::CoInitialize (NULL);</div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;    _TX_TRY</div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;        {</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;$       _TX_CHECKED (Win32::CoCreateInstance (CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, Win32::IID_IShellLink, (<span class="keywordtype">void</span>**) &amp;shellLink));</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;$       <span class="keywordflow">if</span> (!shellLink) _TX_FAIL;</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;$       shellLink-&gt;SetPath (fileToLink);</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;$       shellLink-&gt;SetArguments (args);</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;$       shellLink-&gt;SetWorkingDirectory (workDir);</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;$       shellLink-&gt;SetDescription (description);</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;$       shellLink-&gt;SetShowCmd (cmdShow);</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;$       shellLink-&gt;SetIconLocation (iconFile, iconIndex);</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;</div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;$       _TX_CHECKED (shellLink-&gt;QueryInterface (Win32::IID_IShellLinkDataList, (<span class="keywordtype">void</span>**) &amp;dataList));</div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;$       <span class="keywordflow">if</span> (!dataList) _TX_FAIL;</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;$       Win32::NT_CONSOLE_PROPS props =</div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;          {{<span class="keyword">sizeof</span> (props), NT_CONSOLE_PROPS_SIG},</div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;            0x07, 0xF5,                                 <span class="comment">// wFillAttribute, wPopupFillAttribute</span></div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;           {bufSize.X, bufSize.Y},                      <span class="comment">// dwScreenBufferSize</span></div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;           {wndSize.X, wndSize.Y},                      <span class="comment">// dwWindowSize</span></div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;           {wndOrg.X,  wndOrg.Y},                       <span class="comment">// dwWindowOrigin</span></div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;            0,                                          <span class="comment">// nFont</span></div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;            0,                                          <span class="comment">// nInputBufferSize</span></div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;           {0, (short) fontSize},                       <span class="comment">// dwFontSize</span></div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;            0x36, 400, L<span class="stringliteral">&quot;Lucida Console&quot;</span>,               <span class="comment">// uFontFamily, uFontWeight, FaceName. We&#39;re dancing for this!</span></div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;            15,                                         <span class="comment">// uCursorSize</span></div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;            0,  1, 1, 0,                                <span class="comment">// bFullScreen, bQuickEdit, bInsertMode, bAutoPosition</span></div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;            50, 4, 0,                                   <span class="comment">// uHistoryBufferSize, uNumberOfHistoryBuffers, bHistoryNoDup</span></div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;           {0x000000, 0x800000, 0x008000, 0x808000, 0x000080, 0x800080, 0x008080, 0xC0C0C0,</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;            0x808080, 0xFF0000, 0x00FF00, 0xFFFF00, 0x0000FF, 0xFF00FF, 0x00FFFF, 0xFFFFFF}</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;            };</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;$       _TX_CHECKED (dataList-&gt;AddDataBlock (&amp;props));</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;</div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;$       _TX_CHECKED (shellLink-&gt;QueryInterface (Win32::IID_IPersistFile, (<span class="keywordtype">void</span>**) &amp;file));</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;$       <span class="keywordflow">if</span> (!file) _TX_FAIL;</div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;$       <span class="keywordtype">wchar_t</span> wName[MAX_PATH] = L<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;$       MultiByteToWideChar (_TX_CP, 0, shortcutName, -1, wName, MAX_PATH) || ZeroMemory (wName, <span class="keyword">sizeof</span> (wName));</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;$       _TX_CHECKED (file-&gt;Save (wName, <span class="keyword">true</span>));</div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;        }</div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;</div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;$   _TX_CATCH</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;$   _TX_FINALLY</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;$   <span class="keywordflow">if</span> (file)      file     -&gt;Release();</div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;$   <span class="keywordflow">if</span> (dataList)  dataList -&gt;Release();</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;$   <span class="keywordflow">if</span> (shellLink) shellLink-&gt;Release();</div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;$   <span class="keywordflow">if</span> (init == S_OK) Win32::CoUninitialize();</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;</div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;$   <span class="keywordflow">return</span> _TX_OK;</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;    _TX_ENDTRY</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;    }</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;<span class="comment">//{          [Internal] Memory DC functions (_txBuffer...)</span></div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;HDC _txBuffer_Create (HWND wnd, <span class="keyword">const</span> POINT* size, HBITMAP bitmap)</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;    {</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;$1  <a class="code" href="a00015.htm">txAutoLock</a> _lock;</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;$   HDC wndDC = GetDC (wnd);</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;$   <span class="keywordflow">if</span> (!wndDC) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;</div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;$   RECT r = {0};</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;$   <span class="keywordflow">if</span> (wnd) GetClientRect (wnd, &amp;r) asserted;</div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;$   POINT sz = { r.right - r.left, r.bottom - r.top };</div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;$   <span class="keywordflow">if</span> (!size) size = &amp;sz;</div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;$   HDC dc = Win32::CreateCompatibleDC (wndDC);</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;$   <span class="keywordflow">if</span> (!dc) <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;Cannot create buffer: CreateCompatibleDC() failed&quot;</span>);</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;$   HBITMAP bmap = bitmap? bitmap : Win32::CreateCompatibleBitmap (wndDC, size-&gt;x, size-&gt;y);</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;$   <span class="keywordflow">if</span> (!bmap) <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;Cannot create buffer: CreateCompatibleBitmap() failed&quot;</span>);</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;</div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;$   Win32::SelectObject (dc, bmap) asserted;</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;$   if (!bitmap) Win32::PatBlt (dc, 0, 0, size-&gt;x, size-&gt;y, BLACKNESS) asserted;</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;$   ReleaseDC (wnd, wndDC) asserted;</div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;</div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;$   return dc;</div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;    }</div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;<span class="keywordtype">bool</span> _txBuffer_Delete (HDC* dc)</div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;    {</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;$   if (!*dc) return false;</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;</div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;$   if (!Win32::GetObjectType (Win32::GetCurrentObject (*dc, OBJ_BITMAP))) return false;</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;$   <a class="code" href="a00015.htm">txAutoLock</a> _lock;</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;$   _txBuffer_Select (Win32::GetStockObject         (NULL_PEN),    *dc) asserted;</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;$   _txBuffer_Select (Win32::GetStockObject         (NULL_BRUSH),  *dc) asserted;</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;$   _txBuffer_Select (Win32::GetStockObject         (SYSTEM_FONT), *dc) asserted;</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;$   _txBuffer_Select (Win32::CreateCompatibleBitmap (*dc, 0, 0),   *dc) asserted;</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;$   Win32::DeleteObject (Win32::GetCurrentObject (*dc, OBJ_BITMAP)) asserted;</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;</div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;$   Win32::DeleteDC (*dc) asserted;</div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;</div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;$   *dc = NULL;</div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;</div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;$   return true;</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;    }</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;</div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;</div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;<span class="keywordtype">bool</span> _txBuffer_Select (HGDIOBJ obj, HDC dc <span class="comment">/*= txDC()*/</span>)</div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;    {</div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (obj) return false;</div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;$   _TX_IF_ARGUMENT_FAILED (dc)  return false;</div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;$   if (!Win32::GetObjectType (obj)) <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (&quot;Invalid GDI <span class="keywordtype">object</span> type&quot;);</div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;</div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;$   <a class="code" href="a00015.htm">txAutoLock</a> _lock;</div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;$   obj = Win32::SelectObject (dc, obj);</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;$   if (obj) Win32::DeleteObject (obj) asserted;</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;$   return obj != NULL;</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;    }</div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;</div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;<span class="comment">//{          Diagnostics</span></div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;<span class="keywordtype">void</span> _txOnSignal (<span class="keywordtype">int</span> sig<span class="comment">/* = 0*/</span>, <span class="keywordtype">int</span> fpe<span class="comment">/* = 0*/</span>)</div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;    {</div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;    <span class="keywordflow">if</span> (!sig &amp;&amp; !fpe)</div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;        {</div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;$1      signal (SIGSEGV, (<span class="keywordtype">void</span>(*)(<span class="keywordtype">int</span>))_txOnSignal) != SIG_ERR <a class="code" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a>;</div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;$       signal (SIGFPE,  (<span class="keywordtype">void</span>(*)(<span class="keywordtype">int</span>))_txOnSignal) != SIG_ERR <a class="code" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a>;</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;$       signal (SIGABRT, (<span class="keywordtype">void</span>(*)(<span class="keywordtype">int</span>))_txOnSignal) != SIG_ERR <a class="code" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a>;</div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;$       signal (SIGILL,  (<span class="keywordtype">void</span>(*)(<span class="keywordtype">int</span>))_txOnSignal) != SIG_ERR <a class="code" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a>;</div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;$       signal (SIGTERM, (<span class="keywordtype">void</span>(*)(<span class="keywordtype">int</span>))_txOnSignal) != SIG_ERR <a class="code" href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a>;</div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;$       <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;        }</div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;</div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* sSig = <span class="stringliteral">&quot;Неизвестный тип сигнала&quot;</span>;</div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* sFPE = <span class="stringliteral">&quot;неизвестный тип исключения&quot;</span>;</div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;</div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;<span class="preprocessor">    #define GET_DESCR_( str, code, descr )  case (code): { (str) = #code &quot;: &quot; descr; break; }</span></div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;</div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;    <span class="keywordflow">switch</span> (sig)</div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;        {</div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;        GET_DESCR_ (sSig, SIGSEGV, <span class="stringliteral">&quot;Доступ по неверному указателю. Ставьте ассерты!&quot;</span>)</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;        GET_DESCR_ (sSig, SIGILL,  &quot;Попытка выполнить недопустимую операцию. Проверьте указатели на функции.&quot;)</div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;        GET_DESCR_ (sSig, SIGABRT, &quot;Аварийное завершение программы, вызвана функция abort().&quot;)</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;        GET_DESCR_ (sSig, SIGTERM, &quot;Получен сигнал принудительного завершения программы.&quot;)</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;        GET_DESCR_ (sSig, SIGFPE,  &quot;Грубая ошибка в вычислениях, деление на 0 или что-нибудь еще&quot;)</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;        default:   break;</div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;        }</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;    if (sig == SIGFPE) switch (fpe)</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;        {</div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;        GET_DESCR_ (sFPE, 0x81 <span class="comment">/* _FPE_INVALID        */</span>, <span class="stringliteral">&quot;результат неверен&quot;</span>)</div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;        GET_DESCR_ (sFPE, 0x82 <span class="comment">/* _FPE_DENORMAL       */</span>, &quot;денормализация&quot;)</div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;        GET_DESCR_ (sFPE, 0x83 <span class="comment">/* _FPE_ZERODIVIDE     */</span>, &quot;деление на ноль&quot;)</div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;        GET_DESCR_ (sFPE, 0x84 <span class="comment">/* _FPE_OVERFLOW       */</span>, &quot;результат слишком большой&quot;)</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;        GET_DESCR_ (sFPE, 0x85 <span class="comment">/* _FPE_UNDERFLOW      */</span>, &quot;результат слишком маленький&quot;)</div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;        GET_DESCR_ (sFPE, 0x86 <span class="comment">/* _FPE_INEXACT        */</span>, &quot;результат неточен&quot;)</div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;        GET_DESCR_ (sFPE, 0x87 <span class="comment">/* _FPE_UNEMULATED     */</span>, &quot;операция не поддерживается&quot;)</div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;        GET_DESCR_ (sFPE, 0x88 <span class="comment">/* _FPE_SQRTNEG        */</span>, &quot;квадратный корень из отрицательного числа&quot;)</div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;        GET_DESCR_ (sFPE, 0x8A <span class="comment">/* _FPE_STACKOVERFLOW  */</span>, &quot;переполнение стека сопроцессора&quot;)</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;        GET_DESCR_ (sFPE, 0x8B <span class="comment">/* _FPE_STACKUNDERFLOW */</span>, &quot;в стеке сопроцессора не хватает данных&quot;)</div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;        GET_DESCR_ (sFPE, 0x8C <span class="comment">/* _FPE_EXPLICITGEN    */</span>, &quot;явный вызов исключения&quot;)</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;        default:   break;</div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;        }</div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;</div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;    <span class="preprocessor">#undef GET_DESCR_</span></div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;</div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;    _fpreset();</div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;</div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;    <span class="keywordflow">if</span> (sig == SIGFPE &amp;&amp; fpe)</div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;        _txError (NULL, 0, NULL, <span class="stringliteral">&quot;signal (%d, 0x%02X): %s: %s.&quot;</span> <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> sig <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> (<span class="keywordtype">unsigned</span>) fpe <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> sSig <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> sFPE);</div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;        _txError (NULL, 0, NULL, <span class="stringliteral">&quot;signal (%d): %s&quot;</span>              <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> sig                  <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> sSig);</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;</div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;    _txExit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;</div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;    _txCleanup();</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;    }</div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;</div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;</div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;<span class="keywordtype">void</span> _txOnUnexpected()</div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;    {</div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;    _txError (NULL, 0, NULL,</div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;              <span class="stringliteral">&quot;std::unexpected(): Необработанное исключение. Проверьте свои catch-блоки. Перехватите catch (...).    \n\n&quot;</span></div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;              <span class="stringliteral">&quot;Если вы (зря) используете спецификацию исключений для функций, проверьте, не нарушена ли она.&quot;</span>);</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;    }</div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;</div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;</div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;<span class="keywordtype">void</span> _txOnTerminate()</div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;    {</div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;    _txError (NULL, 0, NULL,</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;              <span class="stringliteral">&quot;std::terminate(): Программа будет завершена из-за неперехваченного исключения в функции main() или в деструкторе.    \n\n&quot;</span></div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;              <span class="stringliteral">&quot;Используйте try/catch блоки, перехватывайте catch (...), разбирайтесь, в чем дело.&quot;</span>);</div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;    }</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* _txError (<span class="keyword">const</span> <span class="keywordtype">char</span> file[] <span class="comment">/*= NULL*/</span>, <span class="keywordtype">int</span> line <span class="comment">/*= 0*/</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> func[] <span class="comment">/*= NULL*/</span>,</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> msg [] <span class="comment">/*= NULL*/</span>, ...)</div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;    {</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;    va_list arg; va_start (arg, msg);</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> nCalls = 0; nCalls++;</div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;</div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;    DWORD          winerr   = GetLastError();</div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;    <span class="keywordtype">int</span>            crterr   = errno;</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  doserr   = _doserrno;</div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;    <span class="keywordtype">unsigned</span>       threadId = GetCurrentThreadId();</div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;</div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;    <span class="keywordtype">bool</span> isFatal = (msg &amp;&amp; *msg == <span class="charliteral">&#39;\a&#39;</span>)? (msg++, <span class="keyword">true</span>) : <span class="keyword">false</span>;</div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;    <span class="keywordtype">bool</span> fmtOnly = (msg &amp;&amp; *msg == <span class="charliteral">&#39;\f&#39;</span>)? (msg++, <span class="keyword">true</span>) : <span class="keyword">false</span>;</div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> what[<a class="code" href="a00064.htm#gaa7273b2f613970c283053c5d9136addd">_TX_BIGBUFSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> str [<a class="code" href="a00064.htm#gaa7273b2f613970c283053c5d9136addd">_TX_BIGBUFSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;    <span class="keywordtype">char</span> *s = what;</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;</div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;<span class="preprocessor">    #define SZARG_(n)  sizeof (what) - 1 - (n) - (s-what) _TX_TRUNCATE</span></div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;</div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;TXLib сообщает:\n\n&quot;</span>);</div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;</div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;Программа: %s, &quot;</span>, <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a>());</div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;    <span class="keywordflow">if</span> (file)   s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;файл: %s, &quot;</span>,      file);</div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;    <span class="keywordflow">if</span> (line)   s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;строка: %d, &quot;</span>,    line);</div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;    <span class="keywordflow">if</span> (func)   s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;функция: %s.&quot;</span>,    func);</div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;</div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;    <span class="keywordflow">if</span> (msg)    s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;%s: &quot;</span>, (file || line || func)? <span class="stringliteral">&quot;Сообщение&quot;</span> : <span class="stringliteral">&quot;ВНЕЗАПНО&quot;</span>),</div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;                s += _vsnprintf_s  (s, SZARG_(1), msg, arg),</div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;</div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;#%d: %s, Instance: 0x%p, Flags: %c%c%c%c%c%c, Thread: 0x%08X%s&quot;</span>,</div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;                                                  nCalls, <a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a>, (<span class="keywordtype">void</span>*) &amp;_txInitialized,</div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;                                                  <span class="stringliteral">&quot;cC&quot;</span>[_txConsole], <span class="stringliteral">&quot;mM&quot;</span>[_txMain], <span class="stringliteral">&quot;dD&quot;</span>[_txIsDll], <span class="stringliteral">&quot;rR&quot;</span>[_txRunning], <span class="stringliteral">&quot;eE&quot;</span>[_txExit], <span class="stringliteral">&quot;tT&quot;</span>[_txAllowTrace],</div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;                                                  threadId,</div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;                                                  (threadId == _txMainThreadId)?    <span class="stringliteral">&quot; (Main)&quot;</span>   :</div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;                                                  (threadId == _txCanvas_ThreadId)? <span class="stringliteral">&quot; (Canvas)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;</div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;    <span class="keywordflow">if</span> (winerr) s +=  _snprintf_s  (s, SZARG_(0), <span class="stringliteral">&quot;, GetLastError(): %lu (&quot;</span>, winerr),</div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;                s += FormatMessage (FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,</div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;                                    NULL, winerr, MAKELANGID (LANG_NEUTRAL, SUBLANG_DEFAULT),</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;                                    s, (DWORD) (<span class="keyword">sizeof</span> (what) - (s-what)), NULL) - 2,</div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;                s -=  (s[-1] == <span class="charliteral">&#39;.&#39;</span>)? 1 : 0,</div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;</div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;    <span class="keywordflow">if</span> (crterr) s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;, errno: %d (%s)&quot;</span>,      crterr, (strerror_s (str, crterr), str));</div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;    <span class="keywordflow">if</span> (doserr) s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;, _doserrno: %lu (%s)&quot;</span>, doserr, (strerror_s (str, doserr), str));</div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;</div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;. %s\n&quot;</span>, ::std::uncaught_exception()? <span class="stringliteral">&quot;std::uncaught_exception(): true.&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;</div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;    <span class="keywordflow">if</span> (_txInTX &gt; 0 &amp;&amp; !(_txLine == line &amp;&amp; file &amp;&amp; _stricmp (_txFile, file) == 0))</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;                s +=  _snprintf_s  (s, SZARG_(1), <span class="stringliteral">&quot;From: %s (%d) %s.\n&quot;</span>, _txFile, _txLine, _txFunc);</div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;</div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;<span class="preprocessor">    #undef SZARG_</span></div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;    va_end (arg);</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;</div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;    <span class="keyword">struct </span>tools</div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;        {</div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">char</span>* compressSpaces (<span class="keywordtype">char</span>* dest, <span class="keyword">const</span> <span class="keywordtype">char</span>* src)</div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;            {</div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;            <span class="keywordtype">char</span>* dst = dest;</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;</div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">char</span> last = <span class="charliteral">&#39; &#39;</span>; *src; src++)</div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;                <span class="keywordflow">if</span> (isspace ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(*src))) { <span class="keywordflow">if</span> (last != <span class="charliteral">&#39; &#39;</span>) *dst++ = last = <span class="charliteral">&#39; &#39;</span>; }</div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;                <span class="keywordflow">else</span>                                                    *dst++ = last = *src;</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;</div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;            <span class="keywordflow">if</span> (dst &gt; dest &amp;&amp; dst[-1] == <span class="charliteral">&#39; &#39;</span>) dst--;</div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;            *dst++ = <span class="charliteral">&#39;\n&#39;</span>; *dst++ = 0;</div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;</div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;            <span class="keywordflow">return</span> dest;</div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;            }</div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;</div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">char</span>* replace (<span class="keywordtype">char</span>* dest, <span class="keyword">const</span> <span class="keywordtype">char</span>* src, <span class="keywordtype">char</span> find, <span class="keywordtype">char</span> repl)</div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;            {</div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;            <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;            <span class="keywordflow">for</span> (; src[i]; i++) dest[i] = (src[i] == find)? repl : src[i];</div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;            dest[i] = 0;</div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;</div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;            <span class="keywordflow">return</span> dest;</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;            }</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;        };</div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;</div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;$   <a class="code" href="a00062.htm#ga2b7cded1074eb3d4b25af75b4ffed73a">txOutputDebugPrintf</a> (<span class="stringliteral">&quot;%s - %s&quot;</span>, <a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a>, tools::compressSpaces (str, what));</div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;</div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;    <span class="keywordflow">if</span> (fmtOnly) <span class="keywordflow">return</span> what;</div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;</div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;    tools::replace (str, what, <span class="charliteral">&#39;\v&#39;</span>, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;    printf (<span class="stringliteral">&quot;\n&quot;</span> <span class="stringliteral">&quot;--------------------------------------------------\n&quot;</span></div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;                 <span class="stringliteral">&quot;%s&quot;</span></div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;                 <span class="stringliteral">&quot;--------------------------------------------------\n&quot;</span>, str);</div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;</div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;    tools::replace (str, what, <span class="charliteral">&#39;\v&#39;</span>, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;    <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (str, isFatal? <span class="stringliteral">&quot;Фатальная ошибка&quot;</span> : <span class="stringliteral">&quot;Ошибка в программе&quot;</span>, MB_ICONSTOP | MB_TOPMOST | MB_SYSTEMMODAL);</div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;</div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;    <span class="keywordflow">if</span> (!isFatal) <span class="keywordflow">return</span> what;</div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;</div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;    <span class="keywordflow">if</span> (!IsDebuggerPresent()) exit (EXIT_FAILURE);</div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;</div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;<span class="comment">//  vvvvvvvvvvvvvvvvvv</span></div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;    DebugBreak();   <span class="comment">//&gt;&gt;&gt; Вы в отладчике. Есть шанс посмотреть переменные и разобраться.</span></div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;<span class="comment">//  ^^^^^^^^^^^^^^^^^^</span></div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;</div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;    <span class="keywordflow">return</span> what;    <span class="comment">//&gt;&gt;&gt; Уходите из функции пошаговой отладкой (F10/F11). Следите за стеком вызовов (Alt+7).</span></div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;    }</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;</div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00062.htm#ga2b7cded1074eb3d4b25af75b4ffed73a">txOutputDebugPrintf</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> format[], ...)</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;    {</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;    <span class="keywordflow">if</span> (!format) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;    <span class="keywordtype">bool</span> msgbox = (*format == <span class="charliteral">&#39;\a&#39;</span>)? (format++, <span class="keyword">true</span>) : <span class="keyword">false</span>;</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;    <span class="keywordtype">bool</span> print  = (*format == <span class="charliteral">&#39;\f&#39;</span>)? (format++, <span class="keyword">true</span>) : <span class="keyword">false</span>;</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;    <span class="keywordtype">char</span> str[<a class="code" href="a00064.htm#gaa7273b2f613970c283053c5d9136addd">_TX_BIGBUFSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;    va_list arg; va_start (arg, format);</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;    <span class="keywordtype">int</span> n = _vsnprintf_s (str, <span class="keyword">sizeof</span> (str) - 1 _TX_TRUNCATE, format, arg);</div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;    va_end (arg);</div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;</div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;    OutputDebugString (str);</div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;</div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;    <span class="keywordflow">if</span> (print)</div>
<div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;        fprintf (stderr, <span class="stringliteral">&quot;%s&quot;</span>, str);</div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;</div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;    <span class="keywordflow">if</span> (msgbox)</div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;        <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (str, <span class="stringliteral">&quot;Оказывается, что&quot;</span>, MB_ICONEXCLAMATION | MB_TOPMOST);</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;</div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;    <span class="keywordflow">return</span> n;</div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;    }</div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;</div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;</div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* text, <span class="keyword">const</span> <span class="keywordtype">char</span>* header, <span class="keywordtype">unsigned</span> flags <span class="comment">/*= 0*/</span>)</div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;    {</div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">wchar_t</span> textW   [_TX_BIGBUFSIZE * <span class="keyword">sizeof</span> (wchar_t)] = L<span class="stringliteral">&quot;[NULL text]&quot;</span>;</div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">wchar_t</span> headerW [_TX_BUFSIZE    * <span class="keyword">sizeof</span> (wchar_t)] = L<span class="stringliteral">&quot;[NULL header]&quot;</span>;</div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;</div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;    <span class="keywordflow">if</span> (text)   MultiByteToWideChar (_TX_CP, 0, text,   -1, textW,   <a class="code" href="a00062.htm#gaf13b370e460b5a25a00c37c1a1c10927">SIZEARR</a> (textW))   || memset (textW,   0, <span class="keyword">sizeof</span> (textW));</div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;    <span class="keywordflow">if</span> (header) MultiByteToWideChar (_TX_CP, 0, header, -1, headerW, <a class="code" href="a00062.htm#gaf13b370e460b5a25a00c37c1a1c10927">SIZEARR</a> (headerW)) || memset (headerW, 0, <span class="keyword">sizeof</span> (headerW));</div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;</div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;    HWND wnd = _txCanvas_Window;</div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;    <span class="keywordflow">return</span> MessageBoxW ((wnd? wnd : Win32::GetConsoleWindow()), textW, headerW, flags | MB_SETFOREGROUND | MB_TOPMOST);</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;    }</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;</div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;</div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a> (<span class="keywordtype">bool</span> fileNameOnly <span class="comment">/*= true*/</span>)</div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;    {</div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> name[MAX_PATH] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;</div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;    <span class="keywordflow">if</span> (!*name) GetModuleFileName (NULL, name, <span class="keyword">sizeof</span> (name) - 1) || strcpy_s (name, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;    <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (*name);</div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;</div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;    <span class="keywordflow">if</span> (fileNameOnly) <span class="keywordflow">return</span> name;</div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;</div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> fullName[MAX_PATH] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;    strncpy_s (fullName, name, <span class="keyword">sizeof</span> (fullName) - 1);</div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;    <span class="keywordtype">char</span>* title = strrchr (fullName, <span class="charliteral">&#39;\\&#39;</span>); <span class="keywordflow">if</span> (!title) title = fullName;</div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;    <span class="keywordtype">char</span>* ext   = strrchr (fullName,  <span class="charliteral">&#39;.&#39;</span>); <span class="keywordflow">if</span> (!ext)   ext   = fullName + strlen (fullName);</div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;</div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;    <span class="keywordtype">size_t</span> sz = <span class="keyword">sizeof</span> (fullName) - (ext - fullName) - 1;</div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;</div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;<span class="preprocessor">    #if defined (_CRT_SECURE_CPP_OVERLOAD_SECURE_NAMES) &amp;&amp; _CRT_SECURE_CPP_OVERLOAD_SECURE_NAMES</span></div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;    strncpy_s (ext, sz, <span class="stringliteral">&quot; - TXLib&quot;</span>, sz);</div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;    strncpy   (ext,     <span class="stringliteral">&quot; - TXLib&quot;</span>, sz);</div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;</div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;    <span class="keywordflow">return</span> title + 1;</div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;    }</div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;</div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;</div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (<span class="keywordtype">unsigned</span> flags, <span class="keyword">const</span> <span class="keywordtype">char</span> title[], <span class="keyword">const</span> <span class="keywordtype">char</span> format[], ...)</div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;    {</div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (format) return false;</div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;</div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;$   va_list arg; va_start (arg, format);</div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;$   <span class="keywordtype">bool</span> ok = true;</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;</div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;    <span class="preprocessor">#if defined (_WIN32_IE) &amp;&amp; (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;</div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;$   NOTIFYICONDATA nid = { <span class="keyword">sizeof</span> (nid) };</div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;</div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;$   nid.uFlags = NIF_ICON | NIF_TIP | NIF_INFO;</div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;$   nid.hWnd   = NULL;</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;$   nid.uID    = 1;</div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;$   nid.hIcon  = _txCreateTXIcon (16); <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (nid.hIcon);</div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;$   strncpy_s    (nid.szTip, <span class="stringliteral">&quot;TXLib Information&quot;</span>, sizeof (nid.szTip));</div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;$   strncpy_s    (nid.szInfoTitle, (title? title : <span class="stringliteral">&quot;TXLib сообщает&quot;</span>), sizeof (nid.szInfoTitle) - 1);</div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;$   _vsnprintf_s (nid.szInfo, sizeof (nid.szInfo) _TX_TRUNCATE, format, arg);</div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;$   nid.dwInfoFlags = flags;</div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;</div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;$   <a class="code" href="a00062.htm#ga2b7cded1074eb3d4b25af75b4ffed73a">txOutputDebugPrintf</a> (<a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a> <span class="stringliteral">&quot; - Icon notification: %s: %s\n&quot;</span>, nid.szInfoTitle, nid.szInfo);</div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;</div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;$   ok &amp;= !!Shell_NotifyIcon (NIM_ADD,    (::NOTIFYICONDATA*) &amp;nid);</div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;$   ok &amp;= !!Shell_NotifyIcon (NIM_MODIFY, (::NOTIFYICONDATA*) &amp;nid);</div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;</div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;$   <span class="keywordflow">if</span> (nid.hIcon) DestroyIcon (nid.hIcon) asserted;</div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;</div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;    <span class="preprocessor">#else</span></div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;</div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;$   <span class="keywordtype">char</span> nid_szInfo[<a class="code" href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25">_TX_BUFSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;$   _vsnprintf_s (nid_szInfo, <span class="keyword">sizeof</span> (nid_szInfo) _TX_TRUNCATE, format, arg);</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;$   <a class="code" href="a00062.htm#ga2b7cded1074eb3d4b25af75b4ffed73a">txOutputDebugPrintf</a> (<a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a> <span class="stringliteral">&quot; - Icon notification (NOT displayed): %s: %s\n&quot;</span>, title, nid_szInfo);</div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;$   ok = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;</div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;$   (void)flags; (void)title;</div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;</div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;</div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;$   va_end (arg);</div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;$   <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;    }</div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;</div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;</div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;<span class="comment">//{          TXLib API implementation</span></div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;<span class="comment">//           Реализация TXLib API</span></div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;</div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="a00059.htm#ga0fc0db1a7c287bec31625bdf3a21922e">txVersion</a>()</div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;    {</div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a>;</div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;    }</div>
<div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;</div>
<div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;</div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#gacd2416cd6b89106ab6700d0c75922bee">txVersionNumber</a>()</div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;    {</div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00064.htm#ga6b76c63cd895c2be63ac8e690028623b">_TX_VER</a>;</div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;    }</div>
<div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;</div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;POINT <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;    {</div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;$1  BITMAP bmap = {0};</div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (Win32::GetObject (Win32::GetCurrentObject (dc, OBJ_BITMAP), <span class="keyword">sizeof</span> (bmap), &amp;bmap), dc) asserted;</div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;</div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;$   POINT size = { bmap.bmWidth, bmap.bmHeight };</div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;$   <span class="keywordflow">return</span> size;</div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;    }</div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;</div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;</div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#gaf8a8dcec482504bdc989fd1d9fc2f1d5">txGetExtentX</a> (HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;    {</div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (dc).x;</div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;    }</div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;</div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;</div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#ga6f5e36abe5f158a1b0a47e69c480f493">txGetExtentY</a> (HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;    {</div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (dc) .y;</div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;    }</div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;</div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;</div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;<span class="keyword">inline</span> HDC&amp; <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a> (<span class="keywordtype">bool</span> forced <span class="comment">/*= false*/</span>)</div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;    {</div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;    <span class="keywordflow">if</span> (forced) _TX_IF_TXWINDOW_FAILED { $1 <span class="keyword">static</span> HDC null = NULL; <span class="keywordflow">return</span> null; }</div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;</div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;$1  <span class="keywordflow">return</span> _txCanvas_BackBuf[0];</div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;    }</div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;</div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;</div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;<span class="keyword">inline</span> HWND <a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>()</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;    {</div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;$1  <span class="keywordflow">return</span> _txCanvas_Window;</div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;    }</div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;</div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;</div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gac9d8435ced05ddc5c29a1a5c9f58f752">txDestroyWindow</a>()</div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;    {</div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;$1  <span class="keywordflow">if</span> (!<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;</div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;$   <span class="keywordflow">if</span> (SendNotifyMessage (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(), (_txMain? WM_CLOSE : WM_DESTROY), 0, 0) == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;</div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;$   <span class="keywordflow">if</span> (_txMain)</div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;        {</div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;$       <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (NIIF_WARNING, NULL, <span class="stringliteral">&quot;\n&quot;</span> <span class="stringliteral">&quot;Очень, очень плохо завершать программу через txDestroyWindow().    \n\n&quot;</span></div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;                                               <span class="stringliteral">&quot;Возвращайтесь через main(), там вам будут рады.\n&quot;</span>);</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;$       Sleep (_TX_TIMEOUT);</div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;        }</div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;</div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;$   _txWaitFor (!_txCanvas_Window, _TX_TIMEOUT);</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;</div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;$   <span class="keywordflow">return</span> _txCanvas_Window == NULL;</div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;    }</div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;</div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;</div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a> (COLORREF color, <span class="keywordtype">double</span> thickness <span class="comment">/*= 1*/</span>, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;    {</div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;</div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;$   return _txBuffer_Select (Win32::CreatePen ((color == <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>? PS_NULL : PS_SOLID), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (thickness), color))</div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;            <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a>          ((Win32::SetTextColor (dc, color)), dc);</div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;    }</div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;</div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga5320ee0e9d6a16dbe492d28158eb33ec">txColor</a> (<span class="keywordtype">double</span> red, <span class="keywordtype">double</span> green, <span class="keywordtype">double</span> blue, <span class="keywordtype">double</span> thickness <span class="comment">/*= 1*/</span>, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;    {</div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;$   if (red   &gt; 1) red   = 1; if (red   &lt; 0) red   = 0;</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;$   if (green &gt; 1) green = 1; if (green &lt; 0) green = 0;</div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;$   if (blue  &gt; 1) blue  = 1; if (blue  &lt; 0) blue  = 0;</div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;</div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;$   return <a class="code" href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a> (<a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (<a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (red * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (green * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (blue * 255)), thickness, dc);</div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;    }</div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;</div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;</div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;COLORREF <a class="code" href="a00059.htm#ga446033e514db3f5b4f0ac9ae511cb1f6">txGetColor</a> (HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;    {</div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return CLR_INVALID;</div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;</div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;$   HGDIOBJ obj = <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::GetCurrentObject (dc, OBJ_PEN)), dc);</div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (obj); if (!obj) return CLR_INVALID;</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;</div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;$   union { EXTLOGPEN extLogPen; LOGPEN LogPen; } buf = {{0}};</div>
<div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;</div>
<div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;$   <span class="keywordtype">int</span> size = Win32::GetObject (obj, 0, NULL);</div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;$   Win32::GetObject (obj, <span class="keyword">sizeof</span> (buf), &amp;buf) asserted;</div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;</div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;$   return (size == sizeof (LOGPEN))? buf.LogPen.lopnColor : buf.extLogPen.elpColor;</div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;    }</div>
<div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;</div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;</div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a> (COLORREF color, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;    {</div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;</div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;$   return _txBuffer_Select ((color == <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>)? Win32::GetStockObject   (HOLLOW_BRUSH) :</div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;                                                        Win32::CreateSolidBrush (color), dc);</div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;    }</div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;</div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;</div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga8826459bc7d9b47431c2c0ef214bce8b">txFillColor</a> (<span class="keywordtype">double</span> red, <span class="keywordtype">double</span> green, <span class="keywordtype">double</span> blue, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;    {</div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;</div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;$   if (red   &gt; 1) red   = 1; if (red   &lt; 0) red   = 0;</div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;$   if (green &gt; 1) green = 1; if (green &lt; 0) green = 0;</div>
<div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;$   if (blue  &gt; 1) blue  = 1; if (blue  &lt; 0) blue  = 0;</div>
<div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;</div>
<div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;$   return <a class="code" href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a> (<a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (<a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (red * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (green * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (blue * 255)), dc);</div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;    }</div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;</div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;</div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;COLORREF <a class="code" href="a00059.htm#gac195074aa335131697243614f12b049c">txGetFillColor</a> (HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;    {</div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return CLR_INVALID;</div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;</div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;$   HGDIOBJ obj = <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::GetCurrentObject (dc, OBJ_BRUSH)), dc);</div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (obj); if (!obj) return CLR_INVALID;</div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;</div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;$   LOGBRUSH buf = {0};</div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::GetObject (obj, <span class="keyword">sizeof</span> (buf), &amp;buf)), dc) asserted;</div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;</div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;$   return buf.lbColor;</div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;    }</div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;</div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;</div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gafad118f7658b7fc982ad5b052ed6d296">txSetROP2</a> (<span class="keywordtype">int</span> mode <span class="comment">/*= R2_COPYPEN*/</span>, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;    {</div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;</div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;$   return <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::SetROP2 (dc, mode)), dc);</div>
<div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;    }</div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;</div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;</div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gae9c886ec2e8af26ce24325c5eebaaa9c">txClear</a> (HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;    {</div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;</div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;$   POINT size = <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (dc);</div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;$   return <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::PatBlt (dc, 0, 0, size.x, size.y, PATCOPY)), dc);</div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;    }</div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;</div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;</div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;inline <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaffd22a69ddbcfae7ac35ee3a6aac68a4">txSetPixel</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, COLORREF color, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;    {</div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;</div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::SetPixel (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y), color)), dc);</div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;</div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;$   return true;</div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;    }</div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;</div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;</div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;inline <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gab19f6b1ecae9e2fc07ad73bd34741391">txPixel</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> red, <span class="keywordtype">double</span> green, <span class="keywordtype">double</span> blue, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;    {</div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;$1  <span class="keywordflow">if</span> (red   &gt; 1) red   = 1; <span class="keywordflow">if</span> (red   &lt; 0) red   = 0;</div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;$   <span class="keywordflow">if</span> (green &gt; 1) green = 1; <span class="keywordflow">if</span> (green &lt; 0) green = 0;</div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;$   <span class="keywordflow">if</span> (blue  &gt; 1) blue  = 1; <span class="keywordflow">if</span> (blue  &lt; 0) blue  = 0;</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;</div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gaffd22a69ddbcfae7ac35ee3a6aac68a4">txSetPixel</a> (x, y, <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (<a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (red * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (green * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (blue * 255)), dc);</div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;    }</div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;</div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;<span class="keyword">inline</span> COLORREF <a class="code" href="a00059.htm#ga84acaeb16745f95fa84b22e48f4d351f">txGetPixel</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;    {</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return CLR_INVALID;</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;</div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;$   return <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::GetPixel (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y))), dc);</div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;    }</div>
<div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;</div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;</div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;    {</div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::MoveToEx (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y0), NULL)), dc) asserted;</div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::LineTo   (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x1), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y1)      )), dc) asserted;</div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;</div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;$   return true;</div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;    }</div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;</div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;</div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga6eb18624049385b1f2a6dbf29461092e">txRectangle</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;    {</div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;</div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::Rectangle (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x1), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y1))), dc) asserted;</div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;$   return true;</div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;    }</div>
<div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;</div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;</div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga14d1129ff586e19fc4d689888bf8dc2b">txPolygon</a> (const POINT points[], <span class="keywordtype">int</span> numPoints, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;    {</div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc)     return false;</div>
<div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;$   _TX_IF_ARGUMENT_FAILED (points) return false;</div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;</div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;$   return <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::Polygon (dc, points, numPoints)), dc);</div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;    }</div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;</div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;</div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gac6ec3514093e5ac1637a883bd65d9300">txEllipse</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;    {</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::Ellipse (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x1), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y1))), dc) asserted;</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;</div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;$   return true;</div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;    }</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaa14e9c2a46cf713efaa1f850074d8adc">txCircle</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> r)</div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;    {</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gac6ec3514093e5ac1637a883bd65d9300">txEllipse</a> (x-r, y-r, x+r, y+r);</div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;    }</div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;</div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;</div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga14ba2d5b1dfdfd09e94248d3ecd808a3">txArc</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> startAngle, <span class="keywordtype">double</span> totalAngle, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;    {</div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;</div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;$   POINT center = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((x0 + x1) /2), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((y0 + y1) /2) };</div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;$   <span class="keywordtype">double</span> start =  startAngle               * txPI/180,</div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;           end   = (startAngle + totalAngle) * txPI/180;</div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;</div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::Arc (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x1), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y1),</div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;                                     <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.x + 1E3*cos (start)), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.y - 1E3*sin (start)),</div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;                                     <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.x + 1E3*cos (end)),   <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.y - 1E3*sin (end)))), dc);</div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;    }</div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;</div>
<div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaef1c6ba744e887a2aab87e4694822a85">txPie</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> startAngle, <span class="keywordtype">double</span> totalAngle, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;    {</div>
<div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;</div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;$   POINT center = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((x0 + x1) /2), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((y0 + y1) /2) };</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;</div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;$   <span class="keywordtype">double</span> start =  startAngle               * txPI/180,</div>
<div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;           end   = (startAngle + totalAngle) * txPI/180;</div>
<div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;</div>
<div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::Pie (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x1), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y1),</div>
<div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;                                     <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.x + 1E3*cos (start)), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.y - 1E3*sin (start)),</div>
<div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;                                     <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.x + 1E3*cos (end)),   <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.y - 1E3*sin (end)))), dc);</div>
<div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;    }</div>
<div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;</div>
<div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;</div>
<div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga2d410925d21cb3b243d3eff7c63d434f">txChord</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> startAngle, <span class="keywordtype">double</span> totalAngle, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;    {</div>
<div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;</div>
<div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;$   POINT center = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((x0 + x1) /2), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((y0 + y1) /2) };</div>
<div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;</div>
<div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;$   <span class="keywordtype">double</span> start =  startAngle               * txPI/180,</div>
<div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;           end   = (startAngle + totalAngle) * txPI/180;</div>
<div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;</div>
<div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::Chord (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x1), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y1),</div>
<div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;                                       <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.x + 1E3*cos (start)), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.y - 1E3*sin (start)),</div>
<div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;                                       <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.x + 1E3*cos (end)),   <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (center.y - 1E3*sin (end)))), dc);</div>
<div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;    }</div>
<div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;</div>
<div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;</div>
<div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga2bf158fe69c8341faec28e9b1c76c5ff">txFloodFill</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y,</div>
<div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;                  COLORREF color <span class="comment">/*= TX_TRANSPARENT*/</span>, DWORD mode <span class="comment">/*= FLOODFILLSURFACE*/</span>, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;    {</div>
<div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return false;</div>
<div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;</div>
<div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;$   if (color == <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>) color = <a class="code" href="a00059.htm#ga84acaeb16745f95fa84b22e48f4d351f">txGetPixel</a> (x, y, dc);</div>
<div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;</div>
<div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;$   return <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::ExtFloodFill (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y), color, mode)), dc);</div>
<div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;    }</div>
<div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;</div>
<div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;</div>
<div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga7412858e48e26d02792018f26c9bf095">txTextOut</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, const <span class="keywordtype">char</span> text[], HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;    {</div>
<div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc)   return false;</div>
<div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;$   _TX_IF_ARGUMENT_FAILED (text) return false;</div>
<div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;</div>
<div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;$   <span class="keywordtype">int</span> len = (<span class="keywordtype">int</span>) strlen (text);</div>
<div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::TextOut (dc, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y), text, len)), dc) asserted;</div>
<div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;</div>
<div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160;$   return true;</div>
<div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;    }</div>
<div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;</div>
<div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160;</div>
<div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaa7451f04a577b18cd412100fc482471e">txDrawText</a> (<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, const <span class="keywordtype">char</span> text[],</div>
<div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;                 <span class="keywordtype">unsigned</span> format <span class="comment">/*= DT_CENTER | DT_VCENTER | DT_WORDBREAK | DT_WORD_ELLIPSIS*/</span>,</div>
<div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;                 HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;{</div>
<div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc)   return false;</div>
<div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;$   _TX_IF_ARGUMENT_FAILED (text) return false;</div>
<div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;</div>
<div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;$   RECT r = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y0), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (x1), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (y1) };</div>
<div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;</div>
<div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;$   <span class="keywordflow">if</span> (!strchr (text, <span class="charliteral">&#39;\n&#39;</span>)) format |= DT_SINGLELINE;</div>
<div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;</div>
<div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;$   <span class="keywordtype">unsigned</span> prev = <a class="code" href="a00059.htm#gaf70ef41eb21f9c5781aa616c32c75608">txSetTextAlign</a> (TA_LEFT | TA_TOP | TA_NOUPDATECP, dc);</div>
<div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;</div>
<div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;    <span class="keywordflow">if</span> (Win32::DrawText) { $ <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::DrawText (dc, text, -1, &amp;r, format)), dc) asserted; }</div>
<div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;</div>
<div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;$   <a class="code" href="a00059.htm#gaf70ef41eb21f9c5781aa616c32c75608">txSetTextAlign</a> (prev, dc);</div>
<div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;</div>
<div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;$   return true;</div>
<div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;}</div>
<div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;</div>
<div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;</div>
<div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaf641d0fd6b8816e61d097cfb10de53d9">txSelectFont</a> (const <span class="keywordtype">char</span> name[], <span class="keywordtype">double</span> sizeY, <span class="keywordtype">double</span> sizeX <span class="comment">/*= -1*/</span>,</div>
<div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;                   <span class="keywordtype">int</span> bold <span class="comment">/*= FW_DONTCARE*/</span>, <span class="keywordtype">bool</span> italic <span class="comment">/*= false*/</span>, <span class="keywordtype">bool</span> underline <span class="comment">/*= false*/</span>,</div>
<div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;                   <span class="keywordtype">bool</span> strikeout <span class="comment">/*= false*/</span>, <span class="keywordtype">double</span> angle <span class="comment">/*= 0*/</span>,</div>
<div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;                   HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;    {</div>
<div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc)   return false;</div>
<div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;$   _TX_IF_ARGUMENT_FAILED (name) return false;</div>
<div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;</div>
<div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;$   HGDIOBJ font = <a class="code" href="a00059.htm#ga1dc38c08e812d5f5a3c8f752a97c2bb2">txFontExist</a> (name)?</div>
<div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;                       Win32::CreateFont (<a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (sizeY), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((sizeX &gt;= 0)? sizeX : sizeY/3),</div>
<div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;                                          <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (angle*10), 0, bold, italic, underline, strikeout,</div>
<div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;                                          RUSSIAN_CHARSET, OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS,</div>
<div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;                                          DEFAULT_QUALITY, FIXED_PITCH, name)</div>
<div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;                       :</div>
<div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;                       Win32::GetStockObject (SYSTEM_FIXED_FONT);</div>
<div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;</div>
<div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;$   _txBuffer_Select (font, dc);</div>
<div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;</div>
<div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;$   return true;</div>
<div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;    }</div>
<div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;</div>
<div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;</div>
<div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;SIZE <a class="code" href="a00059.htm#ga593d51d633b7dc3aa06b34ef55b8047f">txGetTextExtent</a> (const <span class="keywordtype">char</span> text[], HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160;    {</div>
<div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;$1  SIZE size = {0};</div>
<div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;</div>
<div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;$   _TX_IF_ARGUMENT_FAILED (dc)   return size;</div>
<div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;$   _TX_IF_ARGUMENT_FAILED (text) return size;</div>
<div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;</div>
<div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::GetTextExtentPoint32 (dc, text, (<span class="keywordtype">int</span>) strlen (text), &amp;size)), dc) asserted;</div>
<div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;</div>
<div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;$   return size;</div>
<div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;    }</div>
<div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;</div>
<div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;</div>
<div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#gae9753c8c27223efbbe87be36d6525359">txGetTextExtentX</a> (const <span class="keywordtype">char</span> text[], HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;    {</div>
<div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#ga593d51d633b7dc3aa06b34ef55b8047f">txGetTextExtent</a> (text, dc) .cx;</div>
<div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;    }</div>
<div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;</div>
<div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;</div>
<div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00059.htm#ga269080a240637dd6d9060b6972c1c7c6">txGetTextExtentY</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> text[], HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;    {</div>
<div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#ga593d51d633b7dc3aa06b34ef55b8047f">txGetTextExtent</a> (text, dc) .cy;</div>
<div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;    }</div>
<div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;</div>
<div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;</div>
<div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#gaf70ef41eb21f9c5781aa616c32c75608">txSetTextAlign</a> (<span class="keywordtype">unsigned</span> align <span class="comment">/*= TA_CENTER | TA_BASELINE*/</span>, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;    {</div>
<div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dc) return 0;</div>
<div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;</div>
<div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;$   return <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::SetTextAlign (dc, align)), dc);</div>
<div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;    }</div>
<div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;</div>
<div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;</div>
<div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;LOGFONT* <a class="code" href="a00059.htm#ga1dc38c08e812d5f5a3c8f752a97c2bb2">txFontExist</a> (const <span class="keywordtype">char</span> name[])</div>
<div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;    {</div>
<div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (name) return NULL;</div>
<div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;</div>
<div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;$   static LOGFONT font = {0};</div>
<div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;$   font.lfCharSet = DEFAULT_CHARSET;</div>
<div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;$   strncpy_s (font.lfFaceName, name, sizeof (font.lfFaceName) - 1);</div>
<div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;</div>
<div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;$   <span class="keyword">struct </span>tools</div>
<div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;        {</div>
<div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">int</span> CALLBACK enumFonts (<span class="keyword">const</span> LOGFONT* fnt, <span class="keyword">const</span> TEXTMETRIC*, DWORD, LPARAM data)</div>
<div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;            {</div>
<div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;$           _TX_IF_ARGUMENT_FAILED (fnt)  return 0;</div>
<div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;$           _TX_IF_ARGUMENT_FAILED (data) return 0;</div>
<div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;</div>
<div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;            <span class="preprocessor">#ifndef __STRICT_ANSI__</span></div>
<div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;$           <span class="keywordflow">return</span> _strnicmp (fnt-&gt;lfFaceName, ((LOGFONT*)data)-&gt;lfFaceName, LF_FACESIZE);</div>
<div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;</div>
<div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;<span class="preprocessor">            #else</span></div>
<div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;$           <span class="keywordflow">return</span>  strncmp  (fnt-&gt;lfFaceName, ((LOGFONT*)data)-&gt;lfFaceName, LF_FACESIZE);</div>
<div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;</div>
<div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;            }</div>
<div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;        };</div>
<div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;</div>
<div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> ((Win32::EnumFontFamiliesEx (NULL, &amp;font, tools::enumFonts, (LPARAM) &amp;font, 0)), NULL) == 0? &amp;font : NULL;</div>
<div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;    }</div>
<div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;</div>
<div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;</div>
<div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gad4545266069ed42c29d01e7aa68d82d6">txSelectObject</a> (HGDIOBJ obj, HDC dc <span class="comment">/*= txDC (true)*/</span>)</div>
<div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;    {</div>
<div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (obj) return false;</div>
<div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;$   _TX_IF_ARGUMENT_FAILED (dc)  return false;</div>
<div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;</div>
<div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;$   return _txBuffer_Select (obj, dc);</div>
<div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;    }</div>
<div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;</div>
<div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;</div>
<div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;HDC <a class="code" href="a00059.htm#ga2f1b4b81b2b9280bb58c2d79930e2a63">txCreateCompatibleDC</a> (<span class="keywordtype">double</span> sizeX, <span class="keywordtype">double</span> sizeY, HBITMAP bitmap <span class="comment">/*= NULL*/</span>)</div>
<div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;    {</div>
<div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;$1  POINT size = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (sizeX), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (sizeY) };</div>
<div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;</div>
<div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;$   HDC dc = _txBuffer_Create (NULL, &amp;size, bitmap);</div>
<div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (dc); <span class="keywordflow">if</span> (!dc) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;</div>
<div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;$   <span class="keywordflow">if</span> (!_txCanvas_UserDCs) <span class="keywordflow">return</span> dc;</div>
<div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;</div>
<div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;$   <a class="code" href="a00015.htm">txAutoLock</a> _lock;</div>
<div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;$   _txCanvas_UserDCs-&gt;push_back (dc);</div>
<div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;</div>
<div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;$   <span class="keywordflow">if</span> (_txCanvas_UserDCs-&gt;size() &gt;= <a class="code" href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25">_TX_BUFSIZE</a>)</div>
<div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;        { $ <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (NIIF_WARNING, NULL, <span class="stringliteral">&quot;Вы загрузили уже %d HDC, системе может стать плохо.&quot;</span>, (<span class="keywordtype">int</span>) _txCanvas_UserDCs-&gt;size()); }</div>
<div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;</div>
<div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;$   <span class="keywordflow">return</span> dc;</div>
<div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;    }</div>
<div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;</div>
<div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;</div>
<div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;HDC <a class="code" href="a00059.htm#ga28123a5be2ad65c41550ccb558138476">txLoadImage</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> filename[], <span class="keywordtype">unsigned</span> imageFlags <span class="comment">/*= IMAGE_BITMAP*/</span>, <span class="keywordtype">unsigned</span> loadFlags <span class="comment">/*= LR_LOADFROMFILE*/</span>)</div>
<div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;    {</div>
<div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;$1  _TX_IF_TXWINDOW_FAILED                         <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;$   _TX_IF_ARGUMENT_FAILED (filename &amp;&amp; *filename) return NULL;</div>
<div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;</div>
<div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;$   HBITMAP image = (HBITMAP) Win32::LoadImage ((loadFlags &amp; LR_LOADFROMFILE)? NULL : GetModuleHandle (NULL),</div>
<div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;                                                 filename, imageFlags, 0, 0, loadFlags);</div>
<div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;$   if (!image) return NULL;</div>
<div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;</div>
<div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;$   HDC dc = <a class="code" href="a00059.htm#ga2f1b4b81b2b9280bb58c2d79930e2a63">txCreateCompatibleDC</a> (0, 0, image);</div>
<div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;</div>
<div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;$   if (!(loadFlags &amp; LR_LOADFROMFILE)) return dc;</div>
<div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;</div>
<div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;$   static <a class="code" href="a00057.htm">std</a>::map &lt;<a class="code" href="a00057.htm">std</a>::<span class="keywordtype">string</span>, <span class="keywordtype">unsigned</span>&gt; loadTimes;</div>
<div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;$   <a class="code" href="a00057.htm">std</a>::<span class="keywordtype">string</span> file = filename;</div>
<div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;$   <span class="keywordtype">unsigned</span> time    = GetTickCount();</div>
<div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;</div>
<div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;$   if ((<span class="keywordtype">long</span>) (time - loadTimes [file]) &lt; _TX_TIMEOUT)</div>
<div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;        { $ <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (NIIF_WARNING, NULL, <span class="stringliteral">&quot;Вы загружаете \&quot;%s\&quot; слишком часто, программа будет тормозить.&quot;</span>, filename); }</div>
<div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;</div>
<div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;$   loadTimes [file] = time;</div>
<div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;</div>
<div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;$   <span class="keywordflow">return</span> dc;</div>
<div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;    }</div>
<div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;</div>
<div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;</div>
<div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga505f212582bf9b2bf95a4ef15f84af42">txDeleteDC</a> (HDC* pdc)</div>
<div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;    {</div>
<div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;$1  _TX_IF_TXWINDOW_FAILED       <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;$   _TX_IF_ARGUMENT_FAILED (pdc) return false;</div>
<div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;</div>
<div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;$   HDC  dc = *pdc;</div>
<div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;$   <span class="keywordtype">bool</span> ok = _txBuffer_Delete (pdc);</div>
<div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;$   if (!ok) return false;</div>
<div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;</div>
<div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;$   if (!_txCanvas_UserDCs) return ok;</div>
<div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;</div>
<div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;$   <a class="code" href="a00015.htm">txAutoLock</a> _lock;</div>
<div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;$   <a class="code" href="a00057.htm">std</a>::vector &lt;HDC&gt; ::iterator i = <a class="code" href="a00057.htm">std</a>::find (_txCanvas_UserDCs-&gt;begin(), _txCanvas_UserDCs-&gt;end(), dc);</div>
<div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;$   if (i != _txCanvas_UserDCs-&gt;end()) { std::swap (*i, _txCanvas_UserDCs-&gt;back()); _txCanvas_UserDCs-&gt;pop_back(); }</div>
<div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;</div>
<div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;$   <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;    }</div>
<div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;</div>
<div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;</div>
<div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga505f212582bf9b2bf95a4ef15f84af42">txDeleteDC</a> (HDC dc)</div>
<div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;    {</div>
<div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;$1  _TX_IF_TXWINDOW_FAILED <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;</div>
<div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00059.htm#ga505f212582bf9b2bf95a4ef15f84af42">txDeleteDC</a> (&amp;dc);</div>
<div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;    }</div>
<div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;</div>
<div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;</div>
<div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height,</div>
<div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;               HDC src,  <span class="keywordtype">double</span> xSrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> ySrc <span class="comment">/*= 0*/</span>, DWORD rOp <span class="comment">/*= SRCCOPY*/</span>)</div>
<div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;    {</div>
<div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (src) return false;</div>
<div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;</div>
<div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;$   if (!dest) dest = <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a>();</div>
<div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;</div>
<div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;$   if (width &lt;= 0 || height &lt;= 0)</div>
<div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;        {</div>
<div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;$       POINT size = <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (src);</div>
<div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;$       <span class="keywordflow">if</span> (width  &lt;= 0) width  = size.x;</div>
<div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;$       <span class="keywordflow">if</span> (height &lt;= 0) height = size.y;</div>
<div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;        }</div>
<div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;</div>
<div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::BitBlt (dest, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (yDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (width), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (height),</div>
<div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;                                    src,  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xSrc),  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ySrc),  rOp)), dest);</div>
<div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;    }</div>
<div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;</div>
<div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;</div>
<div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, HDC src,</div>
<div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;                      <span class="keywordtype">double</span> xSrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> ySrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> width <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> height <span class="comment">/*= 0*/</span>,</div>
<div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;                      DWORD rOp <span class="comment">/*= SRCCOPY*/</span>)</div>
<div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;    {</div>
<div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (dest, xDest, yDest, width, height, src, xSrc, ySrc, rOp);</div>
<div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;    }</div>
<div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;</div>
<div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;</div>
<div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gab4b1096971ee1f427e9f0211c2b2dea4">txTransparentBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height,</div>
<div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;                       HDC src,  <span class="keywordtype">double</span> xSrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> ySrc <span class="comment">/*= 0*/</span>, COLORREF transColor <span class="comment">/*= TX_BLACK*/</span>)</div>
<div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;    {</div>
<div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (src) return false;</div>
<div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;</div>
<div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;$   if (!dest) dest = txDC();</div>
<div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;</div>
<div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;$   if (width &lt;= 0 || height &lt;= 0)</div>
<div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;        {</div>
<div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;$       POINT size = <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (src);</div>
<div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;$       <span class="keywordflow">if</span> (width  &lt;= 0) width  = size.x;</div>
<div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;$       <span class="keywordflow">if</span> (height &lt;= 0) height = size.y;</div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;        }</div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;</div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;$   <span class="keywordflow">return</span> (Win32::TransparentBlt)?</div>
<div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;        <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::TransparentBlt (dest, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (yDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (width), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (height),</div>
<div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;                                         src,  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xSrc),  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ySrc),  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (width), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (height), transColor)), dest)</div>
<div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;    :</div>
<div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;        <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::BitBlt         (dest, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (yDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (width), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (height),</div>
<div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;                                         src,  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xSrc),  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ySrc),  SRCCOPY)), dest), false;</div>
<div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;    }</div>
<div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;</div>
<div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;</div>
<div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gab4b1096971ee1f427e9f0211c2b2dea4">txTransparentBlt</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, HDC src,</div>
<div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;                              <span class="keywordtype">double</span> xSrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> ySrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> width <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> height <span class="comment">/*= 0*/</span>,</div>
<div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;                              COLORREF transColor <span class="comment">/*= TX_BLACK*/</span>)</div>
<div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;    {</div>
<div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#gab4b1096971ee1f427e9f0211c2b2dea4">txTransparentBlt</a> (dest, xDest, yDest, width, height, src, xSrc, ySrc, transColor);</div>
<div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;    }</div>
<div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;</div>
<div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;</div>
<div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga44dbdbacdbfd2d838f1c78b48c6c4475">txAlphaBlend</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height,</div>
<div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;                   HDC src,  <span class="keywordtype">double</span> xSrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> ySrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> alpha <span class="comment">/*= 1.0*/</span>,</div>
<div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;                   <span class="keywordtype">unsigned</span> format <span class="comment">/*= AC_SRC_ALPHA*/</span>)</div>
<div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;    {</div>
<div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (src) return false;</div>
<div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;</div>
<div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;$   if (!dest) dest = txDC();</div>
<div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;</div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;$   if (width &lt;= 0 || height &lt;= 0)</div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;        {</div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;$       POINT size = <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (src);</div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;$       <span class="keywordflow">if</span> (width  &lt;= 0) width  = size.x;</div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;$       <span class="keywordflow">if</span> (height &lt;= 0) height = size.y;</div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;        }</div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;</div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;$   <span class="keywordflow">if</span> (alpha &lt; 0) alpha = 0;</div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;$   <span class="keywordflow">if</span> (alpha &gt; 1) alpha = 1;</div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;</div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;$   BLENDFUNCTION blend = { AC_SRC_OVER, 0, (BYTE) <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (alpha * 255), (BYTE) format };</div>
<div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;</div>
<div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;$   <span class="keywordflow">return</span> (Win32::AlphaBlend)?</div>
<div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;        <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::AlphaBlend (dest, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (yDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (width), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (height),</div>
<div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;                                     src,  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xSrc),  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ySrc),  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (width), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (height), blend)), dest)</div>
<div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;    :</div>
<div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;        <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (!!(Win32::BitBlt     (dest, <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (yDest), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (width), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (height),</div>
<div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;                                     src,  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (xSrc),  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ySrc),  SRCCOPY)), dest), false;</div>
<div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;    }</div>
<div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;</div>
<div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;</div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga44dbdbacdbfd2d838f1c78b48c6c4475">txAlphaBlend</a> (HDC dest, <span class="keywordtype">double</span> xDest, <span class="keywordtype">double</span> yDest, HDC src,</div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;                          <span class="keywordtype">double</span> xSrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> ySrc <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> width <span class="comment">/*= 0*/</span>, <span class="keywordtype">double</span> height <span class="comment">/*= 0*/</span>,</div>
<div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;                          <span class="keywordtype">double</span> alpha <span class="comment">/*= 1.0*/</span>, <span class="keywordtype">unsigned</span> format <span class="comment">/*= AC_SRC_ALPHA*/</span>)</div>
<div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;    {</div>
<div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;$1  <span class="keywordflow">return</span> <a class="code" href="a00059.htm#ga44dbdbacdbfd2d838f1c78b48c6c4475">txAlphaBlend</a> (dest, xDest, yDest, width, height, src, xSrc, ySrc, alpha, format);</div>
<div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;    }</div>
<div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;</div>
<div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;</div>
<div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gadbf205883201eba91653fe541baedf71">txSaveImage</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, HDC dc <span class="comment">/*= txDC()*/</span>)</div>
<div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;    {</div>
<div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (filename) return false;</div>
<div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;$   _TX_IF_ARGUMENT_FAILED (dc)       return false;</div>
<div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;</div>
<div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;$   POINT size = <a class="code" href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a> (dc);</div>
<div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;</div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;$   <span class="keywordtype">size_t</span> szHdrs = sizeof (BITMAPFILEHEADER) + sizeof (BITMAPINFOHEADER),</div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;           szImg  = (size.x * size.y) * sizeof (RGBQUAD);</div>
<div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;</div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;$   BITMAPFILEHEADER hdr  = { 0x4D42 <span class="comment">/* &#39;MB&#39; */</span>, (DWORD) (szHdrs + szImg), 0, 0, (DWORD) szHdrs };</div>
<div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;$   BITMAPINFOHEADER info = { <span class="keyword">sizeof</span> (info), size.x, size.y, 1, (WORD) (<span class="keyword">sizeof</span> (RGBQUAD) * 8), BI_RGB };</div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;</div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;$   <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;</div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;$   RGBQUAD* buf = <span class="keyword">new</span> RGBQUAD [size.x * size.y];</div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;$   ok &amp;= (buf != NULL);</div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;</div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;$   <span class="keywordflow">if</span> (ok) Win32::GetDIBits (dc, (HBITMAP) Win32::GetCurrentObject (dc, OBJ_BITMAP),</div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;                              0, size.y, buf, (BITMAPINFO*) &amp;info, DIB_RGB_COLORS);</div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;$   FILE* f = NULL;</div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;$   <span class="keywordflow">if</span> (ok) fopen_s (&amp;f, filename, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;$   ok &amp;= (f != NULL);</div>
<div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;</div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;$   <span class="keywordflow">if</span> (ok) ok &amp;= (fwrite (&amp;hdr,  <span class="keyword">sizeof</span> (hdr),  1, f) == 1);</div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;$   <span class="keywordflow">if</span> (ok) ok &amp;= (fwrite (&amp;info, <span class="keyword">sizeof</span> (info), 1, f) == 1);</div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;$   <span class="keywordflow">if</span> (ok) ok &amp;= (fwrite (buf,   szImg,         1, f) == 1);</div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;</div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;$   ok &amp;= (f &amp;&amp; fclose (f) == 0);</div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;</div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;$   <span class="keyword">delete</span>[] buf;</div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;</div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;$   <span class="keywordflow">return</span> ok;</div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;    }</div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;</div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;</div>
<div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00059.htm#gaff3d9c60900531f438a19216485bdd41">txUpdateWindow</a> (<span class="keywordtype">int</span> update <span class="comment">/*= true*/</span>)</div>
<div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;    {</div>
<div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;$1  <span class="keywordflow">return</span> _txCanvas_SetRefreshLock (update &gt;= 0? !update : -update);</div>
<div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;    }</div>
<div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;</div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;</div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00059.htm#gae92e621aaed81f90e4d142356e38762a">txBegin</a>()</div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;    {</div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;$1  _txCanvas_SetRefreshLock (_txCanvas_RefreshLock + 1);</div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;</div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;$   <span class="keywordflow">return</span> _txCanvas_RefreshLock;</div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;    }</div>
<div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;</div>
<div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160;</div>
<div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00059.htm#ga809dc04afd5348247846ee01ce9a06e6">txEnd</a>()</div>
<div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;    {</div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;$1  _txCanvas_SetRefreshLock (_txCanvas_RefreshLock - 1);</div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;</div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;$   <span class="keywordflow">return</span> _txCanvas_RefreshLock;</div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;    }</div>
<div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;</div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;</div>
<div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;<span class="keywordtype">double</span> <a class="code" href="a00059.htm#ga56227ddccbe156355eaca50264bf3334">txSleep</a> (<span class="keywordtype">double</span> time)</div>
<div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;    {</div>
<div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;$1  LARGE_INTEGER start = {{0}};</div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;$   QueryPerformanceCounter (&amp;start) asserted;</div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;</div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;$   LARGE_INTEGER freq = {{0}};</div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;$   QueryPerformanceFrequency (&amp;freq) asserted;</div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;</div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;$   <span class="keywordtype">int</span> lock = _txCanvas_RefreshLock;</div>
<div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;$   _txCanvas_RefreshLock = 0;</div>
<div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;</div>
<div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;$   HWND wnd = txWindow();</div>
<div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;    if (wnd) { $ RedrawWindow (wnd, NULL, NULL, RDW_INVALIDATE | RDW_INTERNALPAINT | RDW_UPDATENOW) asserted; }</div>
<div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;</div>
<div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;$   Sleep (<a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> ((time &gt;= 0)? time : 0));</div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;</div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;$   _txCanvas_RefreshLock = lock;</div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;</div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;$   LARGE_INTEGER stop = {{0}};</div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;$   QueryPerformanceCounter (&amp;stop) asserted;</div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;</div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;$   return 1000.0 * (<span class="keywordtype">double</span>) (stop.QuadPart - start.QuadPart) / (<span class="keywordtype">double</span>) freq.QuadPart;</div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;    }</div>
<div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;</div>
<div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;</div>
<div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00063.htm#ga532fa8a55c4f3d4f94ff0fdceae732b2">txLock</a> (<span class="keywordtype">bool</span> wait <span class="comment">/*= true*/</span>)</div>
<div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;    {</div>
<div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;$1  <span class="keywordflow">if</span> (_txCanvas_RefreshLock &lt;= 0 || _txExit) Sleep (0);</div>
<div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;</div>
<div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;$   <span class="keywordflow">if</span> (wait) { $ <span class="keywordflow">return</span>      EnterCriticalSection (&amp;_txCanvas_LockBackBuf), <span class="keyword">true</span>; }</div>
<div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;    <span class="keywordflow">else</span>      { $ <span class="keywordflow">return</span> !!TryEnterCriticalSection (&amp;_txCanvas_LockBackBuf);       }</div>
<div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;    }</div>
<div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;</div>
<div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;</div>
<div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a>()</div>
<div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;    {</div>
<div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;$1  LeaveCriticalSection (&amp;_txCanvas_LockBackBuf);</div>
<div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;</div>
<div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;$   <span class="keywordflow">if</span> (_txCanvas_RefreshLock &lt;= 0 || _txExit) Sleep (0);</div>
<div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;    }</div>
<div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;</div>
<div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;</div>
<div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;<span class="keyword">inline</span> T <a class="code" href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a> (T value)</div>
<div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;    {</div>
<div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;$1  <a class="code" href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a>();</div>
<div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;$   <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;    }</div>
<div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;</div>
<div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;</div>
<div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;<span class="keyword">inline</span> POINT <a class="code" href="a00060.htm#ga452a1a7dc5d3f467c8b79b9db3ea053e">txMousePos</a>()</div>
<div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;    {</div>
<div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;$1  _TX_IF_TXWINDOW_FAILED <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga779aead84bda35892b48c54418144d4d">ZERO</a> (POINT);</div>
<div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;</div>
<div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;$   <span class="keywordflow">return</span> _txMousePos;</div>
<div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;    }</div>
<div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;</div>
<div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;</div>
<div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00060.htm#ga6adbdb491a8eec2a4209c54874ae7b7d">txMouseX</a>()</div>
<div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;    {</div>
<div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;$1  <span class="keywordflow">return</span> _txMousePos.x;</div>
<div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;    }</div>
<div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;</div>
<div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;</div>
<div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00060.htm#ga572acf2310d35defaa9a37a2ec260576">txMouseY</a>()</div>
<div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;    {</div>
<div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;$1  <span class="keywordflow">return</span> _txMousePos.y;</div>
<div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;    }</div>
<div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;</div>
<div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;</div>
<div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="a00060.htm#ga9da82cc7df5b5e082153f20b206762b4">txMouseButtons</a>()</div>
<div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;    {</div>
<div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;$1  _TX_IF_TXWINDOW_FAILED <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;</div>
<div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;$   <span class="keywordflow">return</span> _txMouseButtons;</div>
<div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;    }</div>
<div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;</div>
<div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;</div>
<div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (<span class="keywordtype">unsigned</span> color <span class="comment">/*= 0x07*/</span>)</div>
<div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;    {</div>
<div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;$1  <span class="keywordflow">return</span> !!SetConsoleTextAttribute (GetStdHandle (STD_OUTPUT_HANDLE), (WORD) color);</div>
<div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;    }</div>
<div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;</div>
<div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;</div>
<div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#ga9f2215b90264133de36ed7c2120f75f5">txGetConsoleAttr</a>()</div>
<div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;    {</div>
<div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;$1  CONSOLE_SCREEN_BUFFER_INFO con = {{0}};</div>
<div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;$   GetConsoleScreenBufferInfo (GetStdHandle (STD_OUTPUT_HANDLE), &amp;con);</div>
<div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;</div>
<div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;$   <span class="keywordflow">return</span> con.wAttributes;</div>
<div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;    }</div>
<div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;</div>
<div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;</div>
<div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;POINT <a class="code" href="a00059.htm#gaee548f7b5672cbcbb99246e0291d7336">txSetConsoleCursorPos</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;    {</div>
<div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;$1  POINT fontSz = <a class="code" href="a00059.htm#ga56faf7c36cf0112165fb705fedf6ec8e">txGetConsoleFontSize</a>();</div>
<div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;</div>
<div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;$   CONSOLE_SCREEN_BUFFER_INFO con = {{0}};</div>
<div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;$   GetConsoleScreenBufferInfo (GetStdHandle (STD_OUTPUT_HANDLE), &amp;con) asserted;</div>
<div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;</div>
<div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;$   COORD pos = { (short) <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (1.0 * x / fontSz.x + con.srWindow.Left),</div>
<div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;                  (short) <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (1.0 * y / fontSz.y + con.srWindow.Top ) };</div>
<div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;</div>
<div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;$   SetConsoleCursorPosition (GetStdHandle (STD_OUTPUT_HANDLE), pos) asserted;</div>
<div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;</div>
<div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;$   POINT prev = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (1.0 * (con.dwCursorPosition.X - con.srWindow.Left) / fontSz.x),</div>
<div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;                   <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (1.0 * (con.dwCursorPosition.Y - con.srWindow.Top ) / fontSz.y) };</div>
<div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;$   <span class="keywordflow">return</span> prev;</div>
<div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;    }</div>
<div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;</div>
<div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;</div>
<div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;POINT <a class="code" href="a00059.htm#ga3227242c57eef33049cdaee655f4faee">txGetConsoleCursorPos</a>()</div>
<div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;    {</div>
<div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;$1  POINT fontSz = <a class="code" href="a00059.htm#ga56faf7c36cf0112165fb705fedf6ec8e">txGetConsoleFontSize</a>();</div>
<div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;</div>
<div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;$   CONSOLE_SCREEN_BUFFER_INFO con = {{0}};</div>
<div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;$   GetConsoleScreenBufferInfo (GetStdHandle (STD_OUTPUT_HANDLE), &amp;con) asserted;</div>
<div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;</div>
<div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;$   POINT pos = { <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (1.0 * (con.dwCursorPosition.X - con.srWindow.Left) / fontSz.x),</div>
<div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;                  <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (1.0 * (con.dwCursorPosition.Y - con.srWindow.Top ) / fontSz.y) };</div>
<div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;$   <span class="keywordflow">return</span> pos;</div>
<div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;    }</div>
<div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;</div>
<div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;</div>
<div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga2cb63c12d9206e9ed2b2c83c9a08f68e">txClearConsole</a>()</div>
<div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;    {</div>
<div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;$1  HANDLE out = GetStdHandle (STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;</div>
<div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;$   CONSOLE_SCREEN_BUFFER_INFO con = {{0}};</div>
<div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;$   GetConsoleScreenBufferInfo (out, &amp;con) asserted;</div>
<div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;</div>
<div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;$   COORD start = {con.srWindow.Left, con.srWindow.Top};</div>
<div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;</div>
<div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;$   DWORD len   = (con.srWindow.Right  - con.srWindow.Left + 1) *</div>
<div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;                  (con.srWindow.Bottom - con.srWindow.Top  + 1);</div>
<div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;</div>
<div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;$   DWORD written = 0;</div>
<div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;$   FillConsoleOutputCharacter (out, 0x20 <span class="comment">/*&#39; &#39;*/</span>,    len, start, &amp;written) asserted;</div>
<div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;$   FillConsoleOutputAttribute (out, con.wAttributes, len, start, &amp;written) asserted;</div>
<div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;</div>
<div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;$   SetConsoleCursorPosition (GetStdHandle (STD_OUTPUT_HANDLE), start) asserted;</div>
<div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160;</div>
<div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;$   return written == len;</div>
<div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160;    }</div>
<div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;</div>
<div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;</div>
<div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;POINT <a class="code" href="a00059.htm#ga56faf7c36cf0112165fb705fedf6ec8e">txGetConsoleFontSize</a>()</div>
<div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;    {</div>
<div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;$1  CONSOLE_FONT_INFO font = {0, {8, 16}};</div>
<div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;</div>
<div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;$   <span class="keywordflow">if</span> (Win32::GetCurrentConsoleFont)</div>
<div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160;        { $ Win32::GetCurrentConsoleFont (GetStdHandle (STD_OUTPUT_HANDLE), <span class="keyword">false</span>, &amp;font) asserted; }</div>
<div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;</div>
<div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;$   SIZE size = { font.dwFontSize.X, font.dwFontSize.Y };</div>
<div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;$   <a class="code" href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a> (Win32::GetTextExtentPoint32 (_txCanvas_BackBuf[1], <span class="stringliteral">&quot;W&quot;</span>, 1, &amp;size), <a class="code" href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a>());</div>
<div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;</div>
<div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;$   POINT sizeFont = { size.cx, size.cy };</div>
<div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;$   <span class="keywordflow">return</span> sizeFont;</div>
<div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;    }</div>
<div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;</div>
<div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;</div>
<div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#gaa148d2040d20ed74cf46ab186c35f9ed">txTextCursor</a> (<span class="keywordtype">bool</span> blink <span class="comment">/*= true*/</span>)</div>
<div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;    {</div>
<div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;$1  <span class="keywordtype">bool</span> old = _txConsole_IsBlinking;</div>
<div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;</div>
<div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;$   _txConsole_IsBlinking = blink;</div>
<div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;</div>
<div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;$   <span class="keywordflow">return</span> old;</div>
<div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;    }</div>
<div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;</div>
<div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;</div>
<div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga177f8bcb7544821ea4b5bd0571fe7196">txPlaySound</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> filename[] <span class="comment">/*= NULL*/</span>, DWORD mode <span class="comment">/*= SND_ASYNC*/</span>)</div>
<div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;    {</div>
<div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (!(filename &amp;&amp; !*filename)) return false;</div>
<div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;</div>
<div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;$   mode |= SND_FILENAME | SND_NODEFAULT | SND_NOWAIT;</div>
<div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;$   if (mode &amp; SND_LOOP) mode = (mode &amp; ~SND_SYNC) | SND_ASYNC;</div>
<div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;</div>
<div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;$   if (!filename) mode = SND_PURGE;</div>
<div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;</div>
<div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;$   return !!Win32::PlaySound (filename, NULL, mode);</div>
<div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;    }</div>
<div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;</div>
<div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;</div>
<div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;<span class="comment">// +--&lt;&lt;&lt; Это вряд ли имеет отношение к тому, что вы ищете :)</span></div>
<div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;<span class="comment">// V      Полезно смотреть не только вверх, но и вниз</span></div>
<div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;</div>
<div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;WNDPROC <a class="code" href="a00063.htm#ga30fb1a6913174dfcea5079391f655be2">txSetWindowsHook</a> (WNDPROC wndProc <span class="comment">/*= NULL*/</span>)</div>
<div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;    {</div>
<div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;$1  WNDPROC old = _txAltWndProc; _txAltWndProc = wndProc;</div>
<div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;$   <span class="keywordflow">return</span>  old;</div>
<div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;    }</div>
<div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160;</div>
<div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160;</div>
<div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;<span class="comment">//     +--&lt;&lt;&lt; А это, наконец, искомое определение этой функции.</span></div>
<div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;<span class="comment">//     |      Смотрите по сторонам! Нужная вам функция где-то рядом.</span></div>
<div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;<span class="comment">//     |</span></div>
<div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;<span class="comment">//     v</span></div>
<div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="a00059.htm#ga93cecf6b117fc403c0488f388b78a6d1">txIDontWantToHaveAPauseAfterMyProgramBeforeTheWindowWillClose_AndIWillNotBeAskingWhereIsMyPicture</a>()</div>
<div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;    {</div>
<div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;$1  <a class="code" href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a> (<span class="stringliteral">&quot;Это запланированная ошибка. Такое бывает. Вы хотели вызвать:\n\n&quot;</span></div>
<div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;</div>
<div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;                  <span class="stringliteral">&quot;txIDontWantToHaveAPauseAfterMyProgramBeforeTheWindowWillClose_AndIWillNotBeAskingWhereIsMyPicture()\n\n&quot;</span></div>
<div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;</div>
<div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;                  <span class="stringliteral">&quot;Хоть вы долго [копировали]набирали это имя, на самом деле эта функция не реализована. &quot;</span></div>
<div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;                  <span class="stringliteral">&quot;Есть другая функция, которая убирает авто-паузу в конце программы, но в хелпе про нее не написано.\n\n&quot;</span></div>
<div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;</div>
<div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;                  <span class="stringliteral">&quot;Но не все так плохо. Определение нужной функции есть в исходных текстах TXLib.h, оно лежит рядом &quot;</span></div>
<div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;                  <span class="stringliteral">&quot;с определением той функции с длинным названием, которую вы сейчас вызвали.\n\n&quot;</span></div>
<div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;</div>
<div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;                  <span class="stringliteral">&quot;Нажмите в редакторе Ctrl+O, найдите и откройте файл TXLib.h (он лежит в папке, куда вы &quot;</span></div>
<div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;                  <span class="stringliteral">&quot;установили TXLib), затем нажмите Ctrl+F и ищите \&quot;txIDontWant\&quot;. Удачи!\n\n&quot;</span>,</div>
<div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;</div>
<div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;                  <span class="stringliteral">&quot;Не получилось&quot;</span>, MB_ICONSTOP);</div>
<div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;</div>
<div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;    <span class="comment">// The truth is out there... (C++files)</span></div>
<div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;</div>
<div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;    }</div>
<div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;</div>
<div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;</div>
<div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;<span class="comment">// Bingo! Now you are learned to use the Sources, Luke. And may the Source be with you.</span></div>
<div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;</div>
<div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> txDisableAutoPause()</div>
<div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;    {</div>
<div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;$1  _txExit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;$   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;    }</div>
<div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;</div>
<div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;</div>
<div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;<span class="preprocessor">#define txCircle    ; txCircle</span></div>
<div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;<span class="preprocessor">#define txSetColor  ; txSetColor</span></div>
<div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;</div>
<div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00059.htm#gac76227ff55076802ea267be18b4d7a8d">txDrawMan</a> (<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> sizeX, <span class="keywordtype">int</span> sizeY, COLORREF color, <span class="keywordtype">double</span> handL, <span class="keywordtype">double</span> handR, <span class="keywordtype">double</span> twist,</div>
<div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;                <span class="keywordtype">double</span> head, <span class="keywordtype">double</span> eyes, <span class="keywordtype">double</span> wink, <span class="keywordtype">double</span> crazy, <span class="keywordtype">double</span> smile, <span class="keywordtype">double</span> hair, <span class="keywordtype">double</span> wind)</div>
<div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;    {</div>
<div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> msg[] = <span class="stringliteral">&quot;\0/А я - человечек из библиотеки!\0/Меня объясняли на уроке!\0/Напиши меня сам!\0/&quot;</span>;</div>
<div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> count = GetTickCount(), L = 0;</div>
<div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;</div>
<div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;    COLORREF lineColor = <a class="code" href="a00059.htm#ga446033e514db3f5b4f0ac9ae511cb1f6">txGetColor</a>();</div>
<div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;    COLORREF fillColor = <a class="code" href="a00059.htm#gac195074aa335131697243614f12b049c">txGetFillColor</a>();</div>
<div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;</div>
<div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;    <a class="code" href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a>     (<a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a5308a5fc6c34169a8af67630a5a750d5">TX_DARKGRAY</a>);</div>
<div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;    <a class="code" href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a> (<a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>);</div>
<div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;</div>
<div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;    <a class="code" href="a00059.htm#ga6eb18624049385b1f2a6dbf29461092e">txRectangle</a> (x - sizeX/2, y - sizeY, x + sizeX/2, y);</div>
<div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;    <a class="code" href="a00059.htm#gaa14e9c2a46cf713efaa1f850074d8adc">txCircle</a> (x, y, 4);</div>
<div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;</div>
<div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;    <a class="code" href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a>     (color);</div>
<div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;    <a class="code" href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a> (color);</div>
<div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;</div>
<div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x + twist * sizeX, y - 0.35 * sizeY, x, y - 0.7 * sizeY);</div>
<div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;</div>
<div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x, y - 0.7 * sizeY, x - sizeX/2, y - (0.7 + handL) * sizeY);</div>
<div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x, y - 0.7 * sizeY, x + sizeX/2, y - (0.7 + handR) * sizeY);</div>
<div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;</div>
<div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x + twist * sizeX, y - 0.35 * sizeY, x - sizeX/2, y);</div>
<div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x + twist * sizeX, y - 0.35 * sizeY, x + sizeX/2, y);</div>
<div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;</div>
<div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;    <a class="code" href="a00059.htm#gaa14e9c2a46cf713efaa1f850074d8adc">txCircle</a> (x, y - (0.85 + head) * sizeY, 0.15 * sizeY);</div>
<div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;</div>
<div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x, y - (1 + head) * sizeY, x +  wind/10        * sizeX, y - (1 + head + hair/10) * sizeY);</div>
<div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x, y - (1 + head) * sizeY, x + (wind/10 - 0.1) * sizeX, y - (1 + head + hair/10) * sizeY);</div>
<div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x, y - (1 + head) * sizeY, x + (wind/10 + 0.1) * sizeX, y - (1 + head + hair/10) * sizeY);</div>
<div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;</div>
<div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;    <a class="code" href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a>     (~color &amp; 0xFFFFFF);  <span class="comment">// Inverse the color</span></div>
<div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;    <a class="code" href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a> (~color &amp; 0xFFFFFF);</div>
<div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;</div>
<div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x, y - (0.8 + head - 0.05 * smile/2) * sizeY, x - 0.05 * sizeY, y - (0.8 + head + 0.05 * smile/2) * sizeY),</div>
<div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;    <a class="code" href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a> (x, y - (0.8 + head - 0.05 * smile/2) * sizeY, x + 0.05 * sizeY, y - (0.8 + head + 0.05 * smile/2) * sizeY),</div>
<div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;    <a class="code" href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a> (4, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)!! (L+<span class="charliteral">&#39;L&#39;</span>)[msg], <span class="stringliteral">&quot;\n%s\n&quot;</span>, msg + (count++ % 3)[<span class="stringliteral">&quot;\&quot;&lt;&quot;</span>]);</div>
<div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;</div>
<div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;    <a class="code" href="a00059.htm#gaa14e9c2a46cf713efaa1f850074d8adc">txCircle</a> (x - 0.05 * sizeY, y - (0.9 + head - 0.02 * crazy) * sizeY, eyes * (1 + 0.5*wink) * 0.02 * sizeY);</div>
<div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;    <a class="code" href="a00059.htm#gaa14e9c2a46cf713efaa1f850074d8adc">txCircle</a> (x + 0.05 * sizeY, y - (0.9 + head + 0.02 * crazy) * sizeY, eyes * (1 - 0.5*wink) * 0.02 * sizeY),</div>
<div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;    Sleep (1000 + count%2);</div>
<div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;</div>
<div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;    <a class="code" href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a>     (lineColor);</div>
<div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;    <a class="code" href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a> (fillColor);</div>
<div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;    }</div>
<div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;</div>
<div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;<span class="preprocessor">#undef txCircle</span></div>
<div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160;<span class="preprocessor">#undef txSetColor</span></div>
<div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;</div>
<div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;</div>
<div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00062.htm#ga7b470eef58eabacf9c7820ce6d392506">txDump</a> (<span class="keyword">const</span> <span class="keywordtype">void</span>* address, <span class="keyword">const</span> <span class="keywordtype">char</span> name[] <span class="comment">/*= &quot;txDump()&quot;*/</span>)</div>
<div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;    {</div>
<div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* p = (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) address;</div>
<div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;    <span class="keywordtype">unsigned</span> x = 0;</div>
<div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;</div>
<div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;    <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x0F);</div>
<div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;    printf (<span class="stringliteral">&quot;\n%8.8s &quot;</span>, name? name : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;</div>
<div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;    <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x0E);</div>
<div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;    <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++) printf (<span class="stringliteral">&quot;%02X &quot;</span>, x);</div>
<div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;    <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++) printf (<span class="stringliteral">&quot;%X&quot;</span>,    x);</div>
<div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;</div>
<div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; 16; y++, p += 16)</div>
<div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;        {</div>
<div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;        <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x0E);</div>
<div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;        printf (<span class="stringliteral">&quot;\n&quot;</span> <span class="stringliteral">&quot;%8p &quot;</span>, p);</div>
<div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;</div>
<div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;        <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++) { <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x0A + x/4%2); printf (<span class="stringliteral">&quot;%02X &quot;</span>, p[x]); }</div>
<div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;        <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++) { <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x0A + x/4%2); printf (<span class="stringliteral">&quot;%c&quot;</span>, (isprint (p[x]) &amp;&amp; !iscntrl (p[x]))? p[x] : <span class="charliteral">&#39;.&#39;</span>); }</div>
<div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;        }</div>
<div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;</div>
<div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;    <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (0x07);</div>
<div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;    printf (<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;    }</div>
<div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;</div>
<div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;</div>
<div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;<span class="keywordtype">double</span> <a class="code" href="a00059.htm#gaebe0b0f6b1324031ee6b9461ba5b0ab3">txQueryPerformance</a>()</div>
<div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;    {</div>
<div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;$1  <span class="keywordtype">int</span> maxTime    =  500;</div>
<div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;$   <span class="keywordtype">int</span> maxSamples =  100;</div>
<div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;$   POINT size     = {500, 500};</div>
<div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;</div>
<div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;$   HDC dc = _txBuffer_Create (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>(), &amp;size, NULL);</div>
<div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (dc); <span class="keywordflow">if</span> (!dc) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;</div>
<div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;$   DWORD mask = (DWORD) SetThreadAffinityMask (GetCurrentThread(), 1);</div>
<div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (mask);</div>
<div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;</div>
<div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160;$   LARGE_INTEGER freq = {{0}};</div>
<div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;$   QueryPerformanceFrequency (&amp;freq) asserted;</div>
<div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;</div>
<div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;$   LARGE_INTEGER start = {{0}};</div>
<div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;$   QueryPerformanceCounter (&amp;start) asserted;</div>
<div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;</div>
<div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;$   <span class="keywordtype">int</span> samples = 0;</div>
<div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;$   while (samples++ &lt; maxSamples)</div>
<div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;        {</div>
<div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;$       LARGE_INTEGER cur = {{0}};</div>
<div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;$       QueryPerformanceCounter (&amp;cur) asserted;</div>
<div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;</div>
<div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;$       <span class="keywordtype">double</span> t = 1000.0 * (<span class="keywordtype">double</span>) (cur.QuadPart - start.QuadPart) / (<span class="keywordtype">double</span>) freq.QuadPart;</div>
<div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160;$       if (t &gt; maxTime) break;</div>
<div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;</div>
<div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;        <span class="comment">// Draw test scene</span></div>
<div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;</div>
<div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;$       for (<span class="keywordtype">int</span> y = 0; y &lt; size.y; y += 10)</div>
<div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;        for (<span class="keywordtype">int</span> x = 0; x &lt; size.x; x += 10) Win32::TextOut (dc, x, y, &quot;*&quot;, 1);</div>
<div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160;</div>
<div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;$       Win32::Ellipse (dc, 0, 0, size.x, size.y);</div>
<div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;$       Win32::ExtFloodFill (dc, size.x/2, size.y/2, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a>, FLOODFILLSURFACE);</div>
<div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;</div>
<div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;$       <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (dc, size.x/2,        0, size.x/2, size.y/2, dc,        0,        0) asserted;</div>
<div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;$       <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (dc, size.x/2, size.y/2, size.x/2, size.y/2, dc,        0, size.y/2) asserted;</div>
<div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;$       <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (dc,        0, size.y/2, size.x/2, size.y/2, dc,        0,        0) asserted;</div>
<div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;$       <a class="code" href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a> (dc, size.x/2, size.y/2, size.x/2, size.y/2, dc, size.x/2,        0) asserted;</div>
<div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;        }</div>
<div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;</div>
<div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;$   mask = (DWORD) SetThreadAffinityMask (GetCurrentThread(), mask);</div>
<div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;$   <a class="code" href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a> (mask);</div>
<div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;</div>
<div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;$   _txBuffer_Delete (&amp;dc);</div>
<div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;</div>
<div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;$   return 15.0 * samples / sqrt (1.0 * size.x * size.y);</div>
<div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;    }</div>
<div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;</div>
<div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;</div>
<div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (COLORREF color, COLORREF component)</div>
<div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;    {</div>
<div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;$1  <span class="keywordflow">switch</span> (component)</div>
<div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;        {</div>
<div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a342ad901a39ab4b40f091f6699b64927">TX_RED</a>:</div>
<div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aba144158f057694f9f08189c0b6a7d65">TX_HUE</a>:        $ <span class="keywordflow">return</span> (color &gt;&gt;  0) &amp; 0xFF;</div>
<div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;</div>
<div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aa13a0e0eb4587540bd06cb5d55083032">TX_GREEN</a>:</div>
<div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a18419bb9192c947fb25d517765dd04cc">TX_SATURATION</a>: $ <span class="keywordflow">return</span> (color &gt;&gt;  8) &amp; 0xFF;</div>
<div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;</div>
<div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aac23422a0b96bfc917484ba1fb0990de">TX_BLUE</a>:</div>
<div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5acc91e717a52d475213f0201bfae5341e">TX_LIGHTNESS</a>:  $ <span class="keywordflow">return</span> (color &gt;&gt; 16) &amp; 0xFF;</div>
<div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;</div>
<div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;        <span class="keywordflow">default</span>:            $ <span class="keywordflow">return</span> CLR_INVALID;</div>
<div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;        }</div>
<div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;    }</div>
<div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;</div>
<div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;</div>
<div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;COLORREF <a class="code" href="a00059.htm#ga0dc8953591b63696392ec581c6b25f7c">txRGB2HSL</a> (COLORREF rgbColor)</div>
<div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;    {</div>
<div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;$1  <span class="keywordtype">int</span> r = <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (rgbColor, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a342ad901a39ab4b40f091f6699b64927">TX_RED</a>),</div>
<div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;        g = <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (rgbColor, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aa13a0e0eb4587540bd06cb5d55083032">TX_GREEN</a>),</div>
<div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;        b = <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (rgbColor, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aac23422a0b96bfc917484ba1fb0990de">TX_BLUE</a>);</div>
<div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;</div>
<div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;$   <span class="keywordtype">double</span> m1 = <a class="code" href="a00062.htm#ga62a815bcebe103c8d30f23a878615988">MAX</a> (<a class="code" href="a00062.htm#ga62a815bcebe103c8d30f23a878615988">MAX</a> (r, g), b) / 255.0,</div>
<div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;           m2 = <a class="code" href="a00062.htm#gada1fc1ec7742eaee6a6268966f7ac065">MIN</a> (<a class="code" href="a00062.htm#gada1fc1ec7742eaee6a6268966f7ac065">MIN</a> (r, g), b) / 255.0,</div>
<div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;           dm = m1 - m2,</div>
<div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;           sm = m1 + m2,</div>
<div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;</div>
<div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;           ir = r / 255.0,</div>
<div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;           ig = g / 255.0,</div>
<div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;           ib = b / 255.0,</div>
<div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;</div>
<div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;           ih = 0,</div>
<div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;           is = 0,</div>
<div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;           il = sm / 2;</div>
<div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160;</div>
<div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;$   <span class="keyword">const</span> <span class="keywordtype">double</span> prec = 0.001;</div>
<div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;</div>
<div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;$   <span class="keywordflow">if</span> (fabs (dm) &lt; prec)</div>
<div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;        {</div>
<div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;$       is = dm / ((sm &lt;= 1)? sm : (2-sm));</div>
<div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;</div>
<div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;$       <span class="keywordtype">double</span> cr = (m1 - ir) / dm,</div>
<div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;               cg = (m1 - ig) / dm,</div>
<div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;               cb = (m1 - ib) / dm;</div>
<div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;</div>
<div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;$       <span class="keywordflow">if</span> (fabs (ir - m1) &lt; prec) ih =     cb - cg;</div>
<div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;$       <span class="keywordflow">if</span> (fabs (ig - m1) &lt; prec) ih = 2 + cr - cb;</div>
<div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;$       <span class="keywordflow">if</span> (fabs (ib - m1) &lt; prec) ih = 4 + cg - cr;</div>
<div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;        }</div>
<div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;</div>
<div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;$   ih = (ih &gt;= 0)? ih*60 : ih*60 + 360;</div>
<div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;</div>
<div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (<a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ih / 360 * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (is * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (il * 255));</div>
<div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;    }</div>
<div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;</div>
<div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;</div>
<div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;COLORREF <a class="code" href="a00059.htm#ga1a87b7cd3e5a74e4dc6828d42d03fffa">txHSL2RGB</a> (COLORREF hslColor)</div>
<div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;    {</div>
<div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;$1  <span class="keyword">struct </span>xRGB</div>
<div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;        {</div>
<div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">double</span> calc (<span class="keywordtype">double</span> h, <span class="keywordtype">double</span> m1, <span class="keywordtype">double</span> m2)</div>
<div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;            {</div>
<div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;$           <span class="keywordflow">if</span> (h &lt; 0)   h += 360;</div>
<div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;$           <span class="keywordflow">if</span> (h &gt; 360) h -= 360;</div>
<div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;</div>
<div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;$           <span class="keywordflow">return</span> (h &lt;  60)? m1 + (m2-m1) *      h  / 60 :</div>
<div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;                   (h &lt; 180)? m2 :</div>
<div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;                   (h &lt; 240)? m1 + (m2-m1) * (240-h) / 60 :</div>
<div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;                              m1;</div>
<div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;            }</div>
<div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;        };</div>
<div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;</div>
<div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;$   <span class="keywordtype">int</span> h = <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (hslColor, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aba144158f057694f9f08189c0b6a7d65">TX_HUE</a>),</div>
<div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;        s = <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (hslColor, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a18419bb9192c947fb25d517765dd04cc">TX_SATURATION</a>),</div>
<div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;        l = <a class="code" href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a> (hslColor, <a class="code" href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5acc91e717a52d475213f0201bfae5341e">TX_LIGHTNESS</a>);</div>
<div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;</div>
<div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;$   <span class="keywordtype">double</span> ih = h / 255.0 * 360.0,</div>
<div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;           il = l / 100.0,</div>
<div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;           is = s / 100.0,</div>
<div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;</div>
<div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;           m2 = (il &lt;= 0.5)? il * (1 + is) : il + is - il * is,</div>
<div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;           m1 = 2 * il - m2,</div>
<div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;</div>
<div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;           ir = s? xRGB::calc (ih + 120, m1, m2) : il,</div>
<div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;           ig = s? xRGB::calc (ih,       m1, m2) : il,</div>
<div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;           ib = s? xRGB::calc (ih - 120, m1, m2) : il;</div>
<div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160;</div>
<div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;$   <span class="keywordflow">return</span> <a class="code" href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a> (<a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ir * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ig * 255), <a class="code" href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a> (ib * 255));</div>
<div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;    }</div>
<div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;</div>
<div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;</div>
<div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="a00062.htm#gaa4558a3bf2a126a9e19c5a3655520787">random</a> (<span class="keywordtype">int</span> range)</div>
<div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;    {</div>
<div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;    <span class="keywordflow">if</span> (_txInitialized &amp;&amp; (_txCanvas_ThreadId != GetCurrentThreadId()) &amp;&amp; (rand() % 100 == 0))</div>
<div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;        printf (<span class="stringliteral">&quot; %.4s &quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*) (_txSystemMessage + !(rand() &amp; 0x0F)));</div>
<div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;</div>
<div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;    <span class="keywordflow">return</span> rand() % range;</div>
<div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;    }</div>
<div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;</div>
<div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;</div>
<div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="a00062.htm#gaa4558a3bf2a126a9e19c5a3655520787">random</a> (<span class="keywordtype">double</span> left, <span class="keywordtype">double</span> right)</div>
<div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;    {</div>
<div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;    <span class="keywordflow">if</span> (_txInitialized &amp;&amp; (_txCanvas_ThreadId != GetCurrentThreadId()) &amp;&amp; (rand() % 100 == 0))</div>
<div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;        printf (<span class="stringliteral">&quot; %.4s &quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*) (_txSystemMessage + !(rand() &amp; 0x0F)));</div>
<div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;</div>
<div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;    <span class="keywordflow">return</span> left + (right - left) * ((<span class="keywordtype">double</span>) rand() / RAND_MAX);</div>
<div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;    }</div>
<div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;</div>
<div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;</div>
<div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;template &lt;typename Tx, typename Ta, typename Tb&gt;</div>
<div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;inline <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (<a class="code" href="a00057.htm">std</a>::nomeow_t, Tx x, Ta a, Tb b)</div>
<div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;    {</div>
<div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;    <span class="keywordflow">return</span> a &lt;= x &amp;&amp; x &lt;= b;</div>
<div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;    }</div>
<div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;</div>
<div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;</div>
<div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tx, <span class="keyword">typename</span> Ta, <span class="keyword">typename</span> Tb&gt;</div>
<div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (Tx x, Ta a, Tb b)</div>
<div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;    {</div>
<div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;    <span class="keywordflow">if</span> (_txInitialized &amp;&amp; (_txCanvas_ThreadId != GetCurrentThreadId()) &amp;&amp; (rand() % 100 == 0))</div>
<div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;        printf (<span class="stringliteral">&quot; %.4s &quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*) (_txSystemMessage + !(rand() &amp; 0x0F)));</div>
<div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;</div>
<div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (std::nomeow, x, a, b);</div>
<div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;    }</div>
<div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;</div>
<div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;</div>
<div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (<span class="keyword">const</span> POINT&amp; pt, <span class="keyword">const</span> RECT&amp; rect)</div>
<div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;    {</div>
<div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;    _TX_IF_ARGUMENT_FAILED (&amp;pt)   return 0;</div>
<div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;    _TX_IF_ARGUMENT_FAILED (&amp;rect) return 0;</div>
<div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;</div>
<div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;    if (_txInitialized &amp;&amp; (_txCanvas_ThreadId != GetCurrentThreadId()) &amp;&amp; (rand() % 100 == 0))</div>
<div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;        printf (&quot; %.4s &quot;, (const <span class="keywordtype">char</span>*) (_txSystemMessage + !(rand() &amp; 0x0F)));</div>
<div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;</div>
<div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;    return <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (pt.x, rect.left, rect.right) &amp;&amp;</div>
<div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;           <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (pt.y, rect.top,  rect.bottom);</div>
<div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;    }</div>
<div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;</div>
<div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;</div>
<div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;inline <span class="keywordtype">bool</span> <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (const COORD&amp; pt, const SMALL_RECT&amp; rect)</div>
<div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;    {</div>
<div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;    _TX_IF_ARGUMENT_FAILED (&amp;pt)   return 0;</div>
<div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;    _TX_IF_ARGUMENT_FAILED (&amp;rect) return 0;</div>
<div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;</div>
<div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;    if (_txInitialized &amp;&amp; (_txCanvas_ThreadId != GetCurrentThreadId()) &amp;&amp; (rand() % 10 == 0))</div>
<div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;        printf (&quot; %.4s &quot;, (const <span class="keywordtype">char</span>*) (_txSystemMessage + !(rand() &amp; 0x0F)));</div>
<div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;</div>
<div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;    return <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (pt.X, rect.Left, rect.Right) &amp;&amp;</div>
<div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;           <a class="code" href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a> (pt.Y, rect.Top,  rect.Bottom);</div>
<div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;    }</div>
<div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;</div>
<div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;</div>
<div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00062.htm#ga5de732de72c46b992ac2feeac2de7e42">tx_fpreset</a>()</div>
<div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;    {</div>
<div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;$1  <a class="code" href="a00015.htm">txAutoLock</a> _lock;</div>
<div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;</div>
<div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;$   _fpreset();</div>
<div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;</div>
<div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;$   <span class="keywordtype">unsigned</span> old87 = 0, new87 = 0x0008001C; <span class="comment">// _EM_INVALID | _EM_DENORMAL | _EM_ZERODIVIDE | _EM_OVERFLOW | _EM_UNDERFLOW</span></div>
<div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;</div>
<div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;$   <span class="keywordflow">if</span> (_controlfp_s (&amp;old87, 0, 0) == 0)</div>
<div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;        { $ (void) _controlfp_s (&amp;old87, old87 &amp; ~new87, 0x0008001F <span class="comment">/* _MCW_EM */</span>); }</div>
<div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;    }</div>
<div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;</div>
<div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;</div>
<div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;<span class="keyword">inline</span> T zero()</div>
<div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;<span class="preprocessor">#ifdef _MSC_VER_6</span></div>
<div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;    { T __zero = {0}; <span class="keywordflow">return</span> __zero; }</div>
<div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;</div>
<div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;    { T __zero = { }; <span class="keywordflow">return</span> __zero; }</div>
<div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;</div>
<div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;</div>
<div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;</div>
<div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;<span class="comment">//{          txDialog methods implementation</span></div>
<div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;<span class="comment">//           Реализация методов класса txDialog</span></div>
<div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;</div>
<div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;<a class="code" href="a00016.htm#a081a2029ed8e4ffd6726c9f39966a04c">txDialog::txDialog</a> () :</div>
<div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;    layout_ (NULL)</div>
<div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;    {$1}</div>
<div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;</div>
<div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;</div>
<div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;<a class="code" href="a00016.htm#a081a2029ed8e4ffd6726c9f39966a04c">txDialog::txDialog</a> (<span class="keyword">const</span> Layout* layout) :</div>
<div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;    layout_ (layout)</div>
<div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;    {$1}</div>
<div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;</div>
<div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;</div>
<div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;<span class="keyword">const</span> <a class="code" href="a00013.htm">txDialog::Layout</a>* <a class="code" href="a00016.htm#a971fb450a33205168aff3a7b186e04a3">txDialog::setLayout</a> (<span class="keyword">const</span> Layout* layout)</div>
<div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;    {</div>
<div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;$1  return ::std::swap (layout_, layout), layout;</div>
<div class="line"><a name="l08543"></a><span class="lineno"> 8543</span>&#160;    }</div>
<div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;</div>
<div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;</div>
<div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;INT_PTR <a class="code" href="a00016.htm#ae1990ecaf5a955c66eae928aa0d9c896">txDialog::dialogBox</a> (WORD resourceID)</div>
<div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;    {</div>
<div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;$1  <span class="keyword">const</span> <span class="keywordtype">char</span>* resName = (<span class="keywordtype">char</span>*)(ptrdiff_t) resourceID;</div>
<div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;</div>
<div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;$   <span class="keywordflow">if</span> (!FindResource (NULL, resName, RT_DIALOG)) <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;Не найден ресурс диалога %d&quot;</span> <a class="code" href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a> resourceID), 0;</div>
<div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;</div>
<div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;$   <span class="keywordflow">return</span> DialogBoxParam (NULL, resName, NULL, dialogProc__, (LPARAM) <span class="keyword">this</span>);</div>
<div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;    }</div>
<div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;</div>
<div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;</div>
<div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;INT_PTR <a class="code" href="a00016.htm#ae1990ecaf5a955c66eae928aa0d9c896">txDialog::dialogBox</a> (<span class="keyword">const</span> <a class="code" href="a00013.htm">txDialog::Layout</a>* layout <span class="comment">/*= NULL*/</span>, <span class="keywordtype">size_t</span> bufsize <span class="comment">/*= 0*/</span>)</div>
<div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;    {</div>
<div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;$1  <span class="keywordflow">if</span> (!layout)  layout = layout_;</div>
<div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;$   <span class="keywordflow">if</span> (!layout)  <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;Не установлен динамический шаблон диалога&quot;</span>), 0;</div>
<div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;</div>
<div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;$   <span class="keywordflow">if</span> (!bufsize) bufsize = 1024;</div>
<div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;</div>
<div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;$   DLGTEMPLATE* tmpl = (DLGTEMPLATE*) GlobalAlloc (GPTR, bufsize);</div>
<div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;$   <span class="keywordflow">if</span> (!tmpl) <span class="keywordflow">return</span> <a class="code" href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a> (<span class="stringliteral">&quot;GlobalAlloc(): Нет памяти для шаблона диалога&quot;</span>), 0;</div>
<div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;</div>
<div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;$   <span class="keyword">const</span> Layout* dlg = &amp;layout[0];</div>
<div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;$   <span class="keyword">const</span> Layout  def = { <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657ada5bcedb21f2f49324595669e7b54cc7">DIALOG</a>, NULL, 0, 0,0,0,0, WS_CAPTION | WS_SYSMENU | DS_MODALFRAME | DS_CENTER, <span class="stringliteral">&quot;MS Shell Dlg&quot;</span>, 8 };</div>
<div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;</div>
<div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;$   <span class="keywordtype">void</span>* ptr = _tx_DLGTEMPLATE_Create (tmpl, bufsize,</div>
<div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;                                       (dlg-&gt;style? dlg-&gt;style : def.style) | DS_SETFONT, 0, 0,</div>
<div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;                                        dlg-&gt;x, dlg-&gt;y, dlg-&gt;sx, dlg-&gt;sy,</div>
<div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;                                        dlg-&gt;caption?  dlg-&gt;caption  : def.caption,</div>
<div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;                                        dlg-&gt;font?     dlg-&gt;font     : def.font,</div>
<div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;                                        dlg-&gt;fontsize? dlg-&gt;fontsize : def.fontsize, NULL);</div>
<div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160;$   WORD i = 0;</div>
<div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;$   <span class="keywordflow">for</span> (i = 1; layout[i].<a class="code" href="a00013.htm#a2591914a85c05cce0fc862df1a569064">wndclass</a> != <a class="code" href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a30e281002a3bce0b5778269b9d831b41">END</a>; ++i)</div>
<div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;        {</div>
<div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;$       <span class="keyword">const</span> Layout* item = &amp;layout[i];</div>
<div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;</div>
<div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;$       ptr = _tx_DLGTEMPLATE_Add (ptr, bufsize - ((<span class="keywordtype">char</span>*)ptr - (<span class="keywordtype">char</span>*)tmpl),</div>
<div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;                                   item-&gt;style | WS_VISIBLE, 0, item-&gt;x, item-&gt;y, item-&gt;sx, item-&gt;sy,</div>
<div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;                                   item-&gt;id, (<span class="keyword">const</span> <span class="keywordtype">char</span>*) item-&gt;wndclass, item-&gt;caption);</div>
<div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;        }</div>
<div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;</div>
<div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;$   tmpl-&gt;cdit = (<span class="keywordtype">unsigned</span> short) (i-1);</div>
<div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;$   INT_PTR res = DialogBoxIndirectParam (NULL, tmpl, NULL, dialogProc__, (LPARAM) <span class="keyword">this</span>);</div>
<div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;</div>
<div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;$   GlobalFree (tmpl);</div>
<div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;</div>
<div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;$   <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;    }</div>
<div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;</div>
<div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;</div>
<div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a00016.htm#a39efe9383833aedb0839d2519173930e">txDialog::dialogProc</a> (HWND, UINT, WPARAM, LPARAM)</div>
<div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;    {</div>
<div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;$1  <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;    }</div>
<div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;</div>
<div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;</div>
<div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;ptrdiff_t CALLBACK txDialog::dialogProc__ (HWND wnd, UINT msg, WPARAM wParam, LPARAM lParam)</div>
<div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;    {</div>
<div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;$1  <span class="keyword">static</span> <a class="code" href="a00016.htm">txDialog</a>* this__ = NULL;</div>
<div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160;</div>
<div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;$   <span class="keywordflow">if</span> (msg == WM_INITDIALOG) this__ = (<a class="code" href="a00016.htm">txDialog</a>*) lParam;</div>
<div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;$   <span class="keywordflow">if</span> (!this__) <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;</div>
<div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;$   <span class="keywordflow">switch</span> (msg)</div>
<div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;        {</div>
<div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;        <span class="keywordflow">case</span> WM_INITDIALOG: $ SetForegroundWindow (wnd);         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;</div>
<div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;        <span class="keywordflow">case</span> WM_COMMAND:    $ <span class="keywordflow">switch</span> (LOWORD (wParam))</div>
<div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;            {</div>
<div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;            <span class="keywordflow">case</span> IDOK:</div>
<div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;            <span class="keywordflow">case</span> IDCANCEL:  $ SetForegroundWindow (<a class="code" href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a>());</div>
<div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;                            $ EndDialog (wnd, (INT_PTR) this__); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;            <span class="keywordflow">default</span>:        $ <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;            }</div>
<div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;</div>
<div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;        <span class="keywordflow">default</span>:            $ <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;        }</div>
<div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;</div>
<div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;$   <span class="keywordflow">return</span> this__-&gt; <a class="code" href="a00016.htm#a39efe9383833aedb0839d2519173930e">dialogProc</a> (wnd, msg, wParam, lParam);</div>
<div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;    }</div>
<div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;</div>
<div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;</div>
<div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;<span class="keywordtype">void</span>* _tx_DLGTEMPLATE_Create (<span class="keywordtype">void</span>* globalMem, <span class="keywordtype">size_t</span> bufsize, DWORD style, DWORD exStyle,</div>
<div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;                              WORD controls, <span class="keywordtype">short</span> x, <span class="keywordtype">short</span> y, <span class="keywordtype">short</span> cx, <span class="keywordtype">short</span> cy,</div>
<div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> caption[], <span class="keyword">const</span> <span class="keywordtype">char</span> font[], WORD fontsize, HANDLE menu)</div>
<div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;    {</div>
<div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (globalMem) return NULL;</div>
<div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;</div>
<div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;$   WORD* pw = (WORD*) globalMem;</div>
<div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;</div>
<div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;$   DLGTEMPLATE* tmpl = ((DLGTEMPLATE*&amp;) pw)++;</div>
<div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;</div>
<div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160;$   tmpl-&gt;style = style;</div>
<div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;$   tmpl-&gt;dwExtendedStyle = exStyle;</div>
<div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;$   tmpl-&gt;cdit  = controls;</div>
<div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;$   tmpl-&gt;x     = x;</div>
<div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;$   tmpl-&gt;y     = y;</div>
<div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;$   tmpl-&gt;cx    = cx;</div>
<div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;$   tmpl-&gt;cy    = cy;</div>
<div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;</div>
<div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;$   *pw++ = (WORD)(ptrdiff_t) NULL;</div>
<div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;$   *pw++ = (WORD)(ptrdiff_t) menu;</div>
<div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;</div>
<div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;$   if (caption)</div>
<div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;        {</div>
<div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;$       pw  += MultiByteToWideChar   (_TX_CP, 0, caption? caption : <span class="stringliteral">&quot;&quot;</span>, -1, (<span class="keywordtype">wchar_t</span>*) pw,</div>
<div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;                                     (<span class="keywordtype">int</span>) (bufsize? bufsize - ((<span class="keywordtype">char</span>*)pw - (<span class="keywordtype">char</span>*)globalMem) : 0xFFFF));</div>
<div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;        }</div>
<div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;</div>
<div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;$   <span class="keywordflow">if</span> (style &amp; DS_SETFONT)</div>
<div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;         {</div>
<div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;$        *pw++ = fontsize;</div>
<div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;$         pw  += MultiByteToWideChar (_TX_CP, 0, font?    font    : <span class="stringliteral">&quot;&quot;</span>, -1, (<span class="keywordtype">wchar_t</span>*) pw,</div>
<div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;                                     (<span class="keywordtype">int</span>) (bufsize? bufsize - ((<span class="keywordtype">char</span>*)pw - (<span class="keywordtype">char</span>*)globalMem) : 0xFFFF));</div>
<div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;         }</div>
<div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;</div>
<div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;$   <span class="keywordflow">return</span> pw;</div>
<div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;    }</div>
<div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;</div>
<div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;</div>
<div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;<span class="keywordtype">void</span>* _tx_DLGTEMPLATE_Add (<span class="keywordtype">void</span>* dlgTemplatePtr, <span class="keywordtype">size_t</span> bufsize, DWORD style, DWORD exStyle,</div>
<div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;                           <span class="keywordtype">short</span> x, <span class="keywordtype">short</span> y, <span class="keywordtype">short</span> cx, <span class="keywordtype">short</span> cy,</div>
<div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;                           WORD <span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> wclass[], <span class="keyword">const</span> <span class="keywordtype">char</span> caption[])</div>
<div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;    {</div>
<div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;$1  _TX_IF_ARGUMENT_FAILED (dlgTemplatePtr) return NULL;</div>
<div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;</div>
<div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;$   WORD* pw = (LPWORD) dlgTemplatePtr;  <span class="comment">// Force align at word boundary</span></div>
<div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;$   (ULONG&amp;) pw  += 3;</div>
<div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;$   (ULONG&amp;) pw &gt;&gt;= 2;</div>
<div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160;$   (ULONG&amp;) pw &lt;&lt;= 2;</div>
<div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;</div>
<div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;$   DLGITEMTEMPLATE* tmpl = ((DLGITEMTEMPLATE*&amp;) pw)++;</div>
<div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;</div>
<div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;$   tmpl-&gt;style = style;</div>
<div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;$   tmpl-&gt;dwExtendedStyle = exStyle;</div>
<div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;$   tmpl-&gt;x     = x;</div>
<div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;$   tmpl-&gt;y     = y;</div>
<div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;$   tmpl-&gt;cx    = cx;</div>
<div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;$   tmpl-&gt;cy    = cy;</div>
<div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;$   tmpl-&gt;<span class="keywordtype">id</span>    = <span class="keywordtype">id</span>;</div>
<div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160;</div>
<div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;$   if (HIWORD (wclass) == 0xFFFF)</div>
<div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160;        {</div>
<div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;$       *pw++ = (WORD) (HIWORD ((ptrdiff_t) wclass));</div>
<div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;$       *pw++ = (WORD) (LOWORD ((ptrdiff_t) wclass));</div>
<div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;        }</div>
<div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wclass)</div>
<div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;        {</div>
<div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;$       pw  += MultiByteToWideChar (_TX_CP, 0, const_cast &lt;char*&gt; (wclass), -1, (<span class="keywordtype">wchar_t</span>*) pw,</div>
<div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;                                   (<span class="keywordtype">int</span>) (bufsize? bufsize - ((<span class="keywordtype">char</span>*)pw - (<span class="keywordtype">char</span>*)dlgTemplatePtr) : 0xFFFF));</div>
<div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;        }</div>
<div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160;        {</div>
<div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;$       *pw++ = 0;</div>
<div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;        }</div>
<div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;</div>
<div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;$   <span class="keywordflow">if</span> (caption)</div>
<div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160;         {</div>
<div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;$        pw  += MultiByteToWideChar (_TX_CP, 0, caption, -1, (<span class="keywordtype">wchar_t</span>*) pw,</div>
<div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;                                    (<span class="keywordtype">int</span>) (bufsize? bufsize - ((<span class="keywordtype">char</span>*)pw - (<span class="keywordtype">char</span>*)dlgTemplatePtr) : 0xFFFF));</div>
<div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;         }</div>
<div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08712"></a><span class="lineno"> 8712</span>&#160;        {</div>
<div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;$       *pw++ = 0;</div>
<div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160;        }</div>
<div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160;</div>
<div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;$   *pw++ = 0;</div>
<div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;</div>
<div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;$   <span class="keywordflow">return</span> pw;</div>
<div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;    }</div>
<div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;</div>
<div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;</div>
<div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;<span class="comment">//{          Cleaning up the utility macros</span></div>
<div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;<span class="comment">//           Очистка служебных макросов</span></div>
<div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;</div>
<div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;<span class="preprocessor">#undef       $</span></div>
<div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;</div>
<div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;</div>
<div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;</div>
<div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;} }  <span class="comment">// namespace TX, anonymous namespace</span></div>
<div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;</div>
<div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;<span class="comment">//{          Easy using of TX:: and some of std::</span></div>
<div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08747"></a><span class="lineno"> 8747</span>&#160;</div>
<div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a00058.htm">TX</a>;            <span class="comment">// Allow easy usage of TXLib functions</span></div>
<div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;</div>
<div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;using ::std::cin;              <span class="comment">// Predefined usings to avoid &quot;using namespace std&quot;</span></div>
<div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;using ::std::cout;</div>
<div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;using ::std::cerr;</div>
<div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;using ::std::string;</div>
<div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;</div>
<div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160;</div>
<div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;<span class="comment">//{          [Experimental] Debugging macros</span></div>
<div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;<span class="comment"></span><span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160;</div>
<div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;<span class="comment">//{----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;<span class="comment"></span><span class="comment">//}----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;</div>
<div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;<span class="preprocessor">#ifndef __TX_DEBUG_MACROS</span></div>
<div class="line"><a name="l08841"></a><span class="lineno"><a class="line" href="a00062.htm#gaaa5d2cd4ba134312dcaca4e8316bbe9e"> 8841</a></span>&#160;<span class="preprocessor">#define __TX_DEBUG_MACROS  (&quot;Группа отладочных $-макросов&quot;)</span></div>
<div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;</div>
<div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;</div>
<div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;<span class="preprocessor">#define $_(var)      _txDump (var)</span></div>
<div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;</div>
<div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160;<span class="preprocessor">#define $(var)     ( _txDump ((var),  &quot;[&quot; #var &quot; = &quot;, &quot;] &quot;) )</span></div>
<div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;</div>
<div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;<span class="preprocessor">#define $$(cmd)    ( ::std::cerr &lt;&lt; &quot;\n[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot;]\n&quot;,  \</span></div>
<div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;<span class="preprocessor">                     _txDump ((cmd),&quot;\n[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot;: &quot;, &quot;, DONE]\n&quot;) )</span></div>
<div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;</div>
<div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;<span class="preprocessor">#define $$_(cmd)   ( ::std::cerr &lt;&lt; &quot;\n[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot;]\n&quot;,  \</span></div>
<div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;<span class="preprocessor">                     _txDump ((cmd),  &quot;[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot;: &quot;, &quot;, DONE]\n&quot;) )</span></div>
<div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;</div>
<div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;<span class="preprocessor">#define $$$(cmd)   { ::std::cerr &lt;&lt; &quot;\n[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot;]\n&quot;;  \</span></div>
<div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;<span class="preprocessor">                     _txDumpSuffix (&quot;\n[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot; DONE]\n&quot;); { cmd; } }</span></div>
<div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160;</div>
<div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;<span class="preprocessor">#define $$$_(cmd)  { ::std::cerr &lt;&lt; &quot;\n[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot;]\n&quot;;  \</span></div>
<div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;<span class="preprocessor">                     _txDumpSuffix   (&quot;[&quot; __TX_FILELINE__ &quot;: &quot; #cmd &quot; DONE]\n&quot;); { cmd; } }</span></div>
<div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;</div>
<div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;<span class="preprocessor">#define $$$$       {       txOutputDebugPrintf (&quot;\f\n&quot;); \</span></div>
<div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;<span class="preprocessor">                   { $s $l txOutputDebugPrintf (&quot;\f&quot; &quot;[%s (%d) %s]&quot;, __FILE__, __LINE__, __TX_FUNCTION__); } txOutputDebugPrintf (&quot;\f\n&quot;); }</span></div>
<div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160;</div>
<div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;<span class="preprocessor">#define $$$$_      {       txOutputDebugPrintf (&quot;\f\n&quot;); \</span></div>
<div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;<span class="preprocessor">                   { $s $l txOutputDebugPrintf (&quot;\f&quot; &quot;[%s]&quot;, __func__);                                    } txOutputDebugPrintf (&quot;\f\n&quot;); }</span></div>
<div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;</div>
<div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;<span class="preprocessor">#define $n            ::std::cerr &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;</div>
<div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;<span class="preprocessor">#define $s            _txSaveConsoleAttr __txSaveConsoleAttr;</span></div>
<div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;</div>
<div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;<span class="preprocessor">#define $T            txSetConsoleAttr (0x00);</span></div>
<div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160;<span class="preprocessor">#define $B            txSetConsoleAttr (0x01);</span></div>
<div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;<span class="preprocessor">#define $G            txSetConsoleAttr (0x02);</span></div>
<div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;<span class="preprocessor">#define $C            txSetConsoleAttr (0x03);</span></div>
<div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;<span class="preprocessor">#define $R            txSetConsoleAttr (0x04);</span></div>
<div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;<span class="preprocessor">#define $M            txSetConsoleAttr (0x05);</span></div>
<div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;<span class="preprocessor">#define $Y            txSetConsoleAttr (0x06);</span></div>
<div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;<span class="preprocessor">#define $d            txSetConsoleAttr (0x07);</span></div>
<div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160;<span class="preprocessor">#define $D            txSetConsoleAttr (0x08);</span></div>
<div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;<span class="preprocessor">#define $b            txSetConsoleAttr (0x09);</span></div>
<div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;<span class="preprocessor">#define $g            txSetConsoleAttr (0x0a);</span></div>
<div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;<span class="preprocessor">#define $c            txSetConsoleAttr (0x0b);</span></div>
<div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;<span class="preprocessor">#define $r            txSetConsoleAttr (0x0c);</span></div>
<div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;<span class="preprocessor">#define $m            txSetConsoleAttr (0x0d);</span></div>
<div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160;<span class="preprocessor">#define $y            txSetConsoleAttr (0x0e);</span></div>
<div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;<span class="preprocessor">#define $t            txSetConsoleAttr (0x0f);</span></div>
<div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;</div>
<div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;<span class="preprocessor">#define $i            txSetConsoleAttr (0x1b);</span></div>
<div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;<span class="preprocessor">#define $I            txSetConsoleAttr (0x1e);</span></div>
<div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;<span class="preprocessor">#define $a            txSetConsoleAttr (0x2a);</span></div>
<div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;<span class="preprocessor">#define $A            txSetConsoleAttr (0x2e);</span></div>
<div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;<span class="preprocessor">#define $e            txSetConsoleAttr (0x4f);</span></div>
<div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;<span class="preprocessor">#define $E            txSetConsoleAttr (0x4e);</span></div>
<div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;<span class="preprocessor">#define $w            txSetConsoleAttr (0x5d);</span></div>
<div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;<span class="preprocessor">#define $W            txSetConsoleAttr (0x5e);</span></div>
<div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;<span class="preprocessor">#define $f            txSetConsoleAttr (0xc0);</span></div>
<div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;<span class="preprocessor">#define $F            txSetConsoleAttr (0xc5);</span></div>
<div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;<span class="preprocessor">#define $l            txSetConsoleAttr (0x80);</span></div>
<div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;<span class="preprocessor">#define $L            txSetConsoleAttr (0x87);</span></div>
<div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;</div>
<div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;</div>
<div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;<span class="preprocessor">#if !defined (_MSC_VER_6)</span></div>
<div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;</div>
<div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span></div>
<div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;<span class="keyword">const</span> T&amp; _txDump (<span class="keyword">const</span> T&amp; value, <span class="keyword">const</span> <span class="keywordtype">char</span>* prefix = <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span>* suffix = <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;    {</div>
<div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;    ::std::cerr &lt;&lt; prefix &lt;&lt; value &lt;&lt; suffix;</div>
<div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;    <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;    }</div>
<div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;</div>
<div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;</div>
<div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span></div>
<div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;      T&amp; _txDump (      T&amp; value, <span class="keyword">const</span> <span class="keywordtype">char</span>* prefix = <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span>* suffix = <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;    {</div>
<div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;    ::std::cerr &lt;&lt; prefix &lt;&lt; value &lt;&lt; suffix;</div>
<div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;    <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160;    }</div>
<div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;</div>
<div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;<span class="keyword">struct </span>_txDumpSuffix</div>
<div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;    {</div>
<div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* suffix_;</div>
<div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;</div>
<div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;    <span class="keyword">inline</span>  _tx_explicit _txDumpSuffix (<span class="keyword">const</span> <span class="keywordtype">char</span>* suffix = <span class="stringliteral">&quot;&quot;</span>) : suffix_ (suffix)     {}</div>
<div class="line"><a name="l08926"></a><span class="lineno"> 8926</span>&#160;    <span class="keyword">inline</span>              ~_txDumpSuffix()                         { ::std::cerr &lt;&lt; suffix_; }</div>
<div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;</div>
<div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;    _txDumpSuffix             (<span class="keyword">const</span> _txDumpSuffix&amp;);</div>
<div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;    _txDumpSuffix&amp; operator = (<span class="keyword">const</span> _txDumpSuffix&amp;);</div>
<div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160;    };</div>
<div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;</div>
<div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;<span class="keyword">struct </span>_txSaveConsoleAttr</div>
<div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;    {</div>
<div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;    <span class="keywordtype">unsigned</span> attr_;</div>
<div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;</div>
<div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160;    <span class="keyword">inline</span>              _txSaveConsoleAttr()           : attr_ (<a class="code" href="a00059.htm#ga9f2215b90264133de36ed7c2120f75f5">txGetConsoleAttr</a> ()) {}</div>
<div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;    <span class="keyword">inline</span> _tx_explicit _txSaveConsoleAttr (WORD attr) : attr_ (<a class="code" href="a00059.htm#ga9f2215b90264133de36ed7c2120f75f5">txGetConsoleAttr</a> ()) { <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (attr);  }</div>
<div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;    <span class="keyword">inline</span>             ~_txSaveConsoleAttr()                                         { <a class="code" href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a> (attr_); }</div>
<div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;    };</div>
<div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160;</div>
<div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;</div>
<div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160;</div>
<div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;</div>
<div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;<span class="comment">//{          Compiler- and platform-specific</span></div>
<div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;<span class="comment">//           Адаптация к компиляторам и платформам</span></div>
<div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;<span class="preprocessor">#if defined (_GCC_VER) &amp;&amp; (_GCC_VER &gt;= 420)</span></div>
<div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;</div>
<div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;<span class="preprocessor">    #pragma GCC optimize           &quot;strict-aliasing&quot;</span></div>
<div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;</div>
<div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;<span class="preprocessor">    #if (_GCC_VER &gt;= 460)</span></div>
<div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;<span class="preprocessor">    #pragma GCC pop_options</span></div>
<div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;</div>
<div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic warning &quot;-Wnon-virtual-dtor&quot;</span></div>
<div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic warning &quot;-Wshadow&quot;</span></div>
<div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic warning &quot;-Wstrict-aliasing&quot;</span></div>
<div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic warning &quot;-Wunused-label&quot;</span></div>
<div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;</div>
<div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;</div>
<div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;</div>
<div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;<span class="preprocessor">#if defined (_MSC_VER)</span></div>
<div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;</div>
<div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;<span class="preprocessor">    #pragma warning (pop)</span></div>
<div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;</div>
<div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;</div>
<div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;<span class="preprocessor">#if defined (__INTEL_COMPILER)</span></div>
<div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;</div>
<div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;<span class="preprocessor">    #pragma warning (default:  174)             // remark: expression has no effect</span></div>
<div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;<span class="preprocessor">    #pragma warning (default:  304)             // remark: access control not specified (&quot;public&quot; by default)</span></div>
<div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;<span class="preprocessor">    #pragma warning (default:  444)             // remark: destructor for base class &quot;...&quot; is not virtual</span></div>
<div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160;<span class="preprocessor">    #pragma warning (default:  522)             // remark: function redeclared &quot;inline&quot; after being called</span></div>
<div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;<span class="preprocessor">    #pragma warning (default: 1684)             // conversion from pointer to same-sized integral type (potential portability problem)</span></div>
<div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;                                           </div>
<div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160;<span class="preprocessor">    #pragma warning (disable:  981)             // remark: operands are evaluated in unspecified order             </span></div>
<div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;                                                                                                                   </div>
<div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;<span class="preprocessor">#endif                                                                                                             </span></div>
<div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;                                                                                                                   </div>
<div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;<span class="comment">//}                                                                                                                </span></div>
<div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;<span class="comment">//-----------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;                                                                                                                   </div>
<div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;<span class="preprocessor">#endif // __TXLIB_H_INCLUDED                                                                                       </span></div>
<div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;                                                                                                                   </div>
<div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;<span class="comment">// EOF                                                                                                             </span></div>
<div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;<span class="comment">//=================================================================================================================</span></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a4992f4f094a8e2ae9fdb68cfff1f6025"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a4992f4f094a8e2ae9fdb68cfff1f6025">TX_WHITE</a></div><div class="ttdoc">Белый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00865">Example04/TXLib.h:865</a></div></div>
<div class="ttc" id="a00060_htm_ga6adbdb491a8eec2a4209c54874ae7b7d"><div class="ttname"><a href="a00060.htm#ga6adbdb491a8eec2a4209c54874ae7b7d">txMouseX</a></div><div class="ttdeci">int txMouseX()</div><div class="ttdoc">Возвращает Х-Координату Мыши! </div></div>
<div class="ttc" id="a00059_htm_ga7412858e48e26d02792018f26c9bf095"><div class="ttname"><a href="a00059.htm#ga7412858e48e26d02792018f26c9bf095">txTextOut</a></div><div class="ttdeci">bool txTextOut(double x, double y, const char text[], HDC dc=txDC(true))</div><div class="ttdoc">Рисует текст. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5aaefd282232c1503377c5a5e3545c579a"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aaefd282232c1503377c5a5e3545c579a">TX_GRAY</a></div><div class="ttdoc">Серый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00855">Example04/TXLib.h:855</a></div></div>
<div class="ttc" id="a00062_htm_ga36851fb6c9bcfc7eaea57befafe98e6d"><div class="ttname"><a href="a00062.htm#ga36851fb6c9bcfc7eaea57befafe98e6d">TX_HANDLE</a></div><div class="ttdeci">#define TX_HANDLE(id)                                                                                                                    </div><div class="ttdoc">Заголовок обработчика сообщения (Message handler) карты сообщений. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04598">Example04/TXLib.h:4598</a></div></div>
<div class="ttc" id="a00015_htm_ad8c38da2a4d92f89e4adb506e26e35c9"><div class="ttname"><a href="a00015.htm#ad8c38da2a4d92f89e4adb506e26e35c9">txAutoLock::txAutoLock</a></div><div class="ttdeci">_tx_explicit txAutoLock(CRITICAL_SECTION *cs, bool mandatory=true)</div><div class="ttdoc">Конструктор, блокирует критическую секцию </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04254">Example04/TXLib.h:4254</a></div></div>
<div class="ttc" id="a00062_htm_ga177f8bcb7544821ea4b5bd0571fe7196"><div class="ttname"><a href="a00062.htm#ga177f8bcb7544821ea4b5bd0571fe7196">txPlaySound</a></div><div class="ttdeci">bool txPlaySound(const char filename[]=NULL, DWORD mode=SND_ASYNC)</div><div class="ttdoc">Воспроизводит звуковой файл. </div></div>
<div class="ttc" id="a00016_htm_a0a41d301a3d12cd2542f609bb77d81a1"><div class="ttname"><a href="a00016.htm#a0a41d301a3d12cd2542f609bb77d81a1">txDialog::~txDialog</a></div><div class="ttdeci">virtual ~txDialog()</div><div class="ttdoc">Деструктор. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04452">Example04/TXLib.h:4452</a></div></div>
<div class="ttc" id="a00059_htm_gaf8a8dcec482504bdc989fd1d9fc2f1d5"><div class="ttname"><a href="a00059.htm#gaf8a8dcec482504bdc989fd1d9fc2f1d5">txGetExtentX</a></div><div class="ttdeci">int txGetExtentX(HDC dc=txDC(true))</div><div class="ttdoc">Возвращает ширину холста. </div></div>
<div class="ttc" id="a00059_htm_gac195074aa335131697243614f12b049c"><div class="ttname"><a href="a00059.htm#gac195074aa335131697243614f12b049c">txGetFillColor</a></div><div class="ttdeci">COLORREF txGetFillColor(HDC dc=txDC(true))</div><div class="ttdoc">Возвращает текущий цвет заполнения фигур. </div></div>
<div class="ttc" id="a00064_htm_gaddc6398e255e44934e56e22f91874d19"><div class="ttname"><a href="a00064.htm#gaddc6398e255e44934e56e22f91874d19">_TX_VERSION</a></div><div class="ttdeci">#define _TX_VERSION</div><div class="ttdoc">Текущая версия библиотеки. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00082">Example04/TXLib.h:82</a></div></div>
<div class="ttc" id="a00059_htm_gac76227ff55076802ea267be18b4d7a8d"><div class="ttname"><a href="a00059.htm#gac76227ff55076802ea267be18b4d7a8d">txDrawMan</a></div><div class="ttdeci">void txDrawMan(int x, int y, int sizeX, int sizeY, COLORREF color, double handL, double handR, double twist, double head, double eyes, double wink, double crazy, double smile, double hair, double wind)</div><div class="ttdoc">Рисует человечка. </div></div>
<div class="ttc" id="a00059_htm_ga9d0606f08bafcbb4a4796b3d3c880dea"><div class="ttname"><a href="a00059.htm#ga9d0606f08bafcbb4a4796b3d3c880dea">txLine</a></div><div class="ttdeci">bool txLine(double x0, double y0, double x1, double y1, HDC dc=txDC(true))</div><div class="ttdoc">Рисует линию. </div></div>
<div class="ttc" id="a00064_htm_ga4ddb32d7a8a676537014da7aea7bf273"><div class="ttname"><a href="a00064.htm#ga4ddb32d7a8a676537014da7aea7bf273">_txWindowStyle</a></div><div class="ttdeci">int _txWindowStyle</div><div class="ttdoc">Стиль графического окна библиотеки. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03924">Example04/TXLib.h:3924</a></div></div>
<div class="ttc" id="a00062_htm_ga934291e39288d75c477c6022e67920e1"><div class="ttname"><a href="a00062.htm#ga934291e39288d75c477c6022e67920e1">assert</a></div><div class="ttdeci">#define assert(cond)    </div><div class="ttdoc">Замена стандартного макроса assert(), с выдачей сообщения через txMessageBox(), консоль и OutputDebug...</div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03378">Example04/TXLib.h:3378</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a2331cdb79541487869e7c2445a2eb5f0"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a2331cdb79541487869e7c2445a2eb5f0">TX_YELLOW</a></div><div class="ttdoc">Желтый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00864">Example04/TXLib.h:864</a></div></div>
<div class="ttc" id="a00061_htm_gga5b47575087d696b5fddf972ce4d83657a84a79295b5dc09aeffdc04a1844691fb"><div class="ttname"><a href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a84a79295b5dc09aeffdc04a1844691fb">txDialog::BUTTON</a></div><div class="ttdoc">Кнопка </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04376">Example02/TXLib.h:4376</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5aba144158f057694f9f08189c0b6a7d65"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aba144158f057694f9f08189c0b6a7d65">TX_HUE</a></div><div class="ttdoc">Цветовой тон цвета в модели HSL. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00871">Example04/TXLib.h:871</a></div></div>
<div class="ttc" id="a00063_htm_ga532fa8a55c4f3d4f94ff0fdceae732b2"><div class="ttname"><a href="a00063.htm#ga532fa8a55c4f3d4f94ff0fdceae732b2">txLock</a></div><div class="ttdeci">bool txLock(bool wait=true)</div><div class="ttdoc">Блокировка холста (контекста рисования). </div></div>
<div class="ttc" id="a00062_htm_gafca36de229c170968d003c75dbf3e728"><div class="ttname"><a href="a00062.htm#gafca36de229c170968d003c75dbf3e728">TX_BEGIN_MESSAGE_MAP</a></div><div class="ttdeci">#define TX_BEGIN_MESSAGE_MAP()                                                                                                                              </div><div class="ttdoc">Заголовок карты сообщений (Message Map). </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04574">Example04/TXLib.h:4574</a></div></div>
<div class="ttc" id="a00059_htm_gaee548f7b5672cbcbb99246e0291d7336"><div class="ttname"><a href="a00059.htm#gaee548f7b5672cbcbb99246e0291d7336">txSetConsoleCursorPos</a></div><div class="ttdeci">POINT txSetConsoleCursorPos(double x, double y)</div><div class="ttdoc">Устанавливает позицию мигающего курсора консоли. </div></div>
<div class="ttc" id="a00059_htm_ga56faf7c36cf0112165fb705fedf6ec8e"><div class="ttname"><a href="a00059.htm#ga56faf7c36cf0112165fb705fedf6ec8e">txGetConsoleFontSize</a></div><div class="ttdeci">POINT txGetConsoleFontSize()</div><div class="ttdoc">Возвращает размеры шрифта консоли. </div></div>
<div class="ttc" id="a00064_htm_gaab281ee20ea6be5eae34d0e15bf03dcf"><div class="ttname"><a href="a00064.htm#gaab281ee20ea6be5eae34d0e15bf03dcf">_TX_NOINIT</a></div><div class="ttdeci">#define _TX_NOINIT</div><div class="ttdoc">Запрет ранней инициализации TXLib. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03884">Example04/TXLib.h:3884</a></div></div>
<div class="ttc" id="a00059_htm_ga14d1129ff586e19fc4d689888bf8dc2b"><div class="ttname"><a href="a00059.htm#ga14d1129ff586e19fc4d689888bf8dc2b">txPolygon</a></div><div class="ttdeci">bool txPolygon(const POINT points[], int numPoints, HDC dc=txDC(true))</div><div class="ttdoc">Рисует ломаную линию или многоугольник. </div></div>
<div class="ttc" id="a00059_htm_gaf70ef41eb21f9c5781aa616c32c75608"><div class="ttname"><a href="a00059.htm#gaf70ef41eb21f9c5781aa616c32c75608">txSetTextAlign</a></div><div class="ttdeci">unsigned txSetTextAlign(unsigned align=TA_CENTER|TA_BASELINE, HDC dc=txDC(true))</div><div class="ttdoc">Устанавливает текущее выравнивание текста. </div></div>
<div class="ttc" id="a00059_htm_gaf641d0fd6b8816e61d097cfb10de53d9"><div class="ttname"><a href="a00059.htm#gaf641d0fd6b8816e61d097cfb10de53d9">txSelectFont</a></div><div class="ttdeci">bool txSelectFont(const char name[], double sizeY, double sizeX=-1, int bold=FW_DONTCARE, bool italic=false, bool underline=false, bool strikeout=false, double angle=0, HDC dc=txDC(true))</div><div class="ttdoc">Выбирает текущий шрифт. </div></div>
<div class="ttc" id="a00059_htm_ga593d51d633b7dc3aa06b34ef55b8047f"><div class="ttname"><a href="a00059.htm#ga593d51d633b7dc3aa06b34ef55b8047f">txGetTextExtent</a></div><div class="ttdeci">SIZE txGetTextExtent(const char text[], HDC dc=txDC(true))</div><div class="ttdoc">Вычисляет размеры текстовой надписи. </div></div>
<div class="ttc" id="a00013_htm_a2591914a85c05cce0fc862df1a569064"><div class="ttname"><a href="a00013.htm#a2591914a85c05cce0fc862df1a569064">txDialog::Layout::wndclass</a></div><div class="ttdeci">CONTROL wndclass</div><div class="ttdoc">Тип контрола </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04407">Example02/TXLib.h:4407</a></div></div>
<div class="ttc" id="a00063_htm_ga30fb1a6913174dfcea5079391f655be2"><div class="ttname"><a href="a00063.htm#ga30fb1a6913174dfcea5079391f655be2">txSetWindowsHook</a></div><div class="ttdeci">WNDPROC txSetWindowsHook(WNDPROC wndProc=NULL)</div><div class="ttdoc">Устанавливает альтернативную функцию обработки оконных сообщений Windows (оконную функцию) для окна T...</div></div>
<div class="ttc" id="a00062_htm_ga43d277b4418068ebef1fd2bdbaf550f6"><div class="ttname"><a href="a00062.htm#ga43d277b4418068ebef1fd2bdbaf550f6">_TX_MODULE</a></div><div class="ttdeci">#define _TX_MODULE</div><div class="ttdoc">Имя модуля TXLib, входит в диагностические сообщения. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03680">Example04/TXLib.h:3680</a></div></div>
<div class="ttc" id="a00059_htm_ga0dc8953591b63696392ec581c6b25f7c"><div class="ttname"><a href="a00059.htm#ga0dc8953591b63696392ec581c6b25f7c">txRGB2HSL</a></div><div class="ttdeci">COLORREF txRGB2HSL(COLORREF rgbColor)</div><div class="ttdoc">Преобразует цвет из формата RGB в формат HSL. </div></div>
<div class="ttc" id="a00016_htm"><div class="ttname"><a href="a00016.htm">txDialog</a></div><div class="ttdoc">Базовый класс для диалоговых окон. </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04354">Example02/TXLib.h:4354</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a9f0adfcb24eeb418fc39fe950db65ec8"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a9f0adfcb24eeb418fc39fe950db65ec8">TX_BLACK</a></div><div class="ttdoc">Черный цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00847">Example04/TXLib.h:847</a></div></div>
<div class="ttc" id="a00062_htm_ga3f4a70a0e5076cb4f4addcab0ca760cd"><div class="ttname"><a href="a00062.htm#ga3f4a70a0e5076cb4f4addcab0ca760cd">TX_END_MESSAGE_MAP</a></div><div class="ttdeci">#define TX_END_MESSAGE_MAP</div><div class="ttdoc">Завершитель карты сообщений. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04636">Example04/TXLib.h:4636</a></div></div>
<div class="ttc" id="a00059_htm_gab4b1096971ee1f427e9f0211c2b2dea4"><div class="ttname"><a href="a00059.htm#gab4b1096971ee1f427e9f0211c2b2dea4">txTransparentBlt</a></div><div class="ttdeci">bool txTransparentBlt(HDC dest, double xDest, double yDest, double width, double height, HDC src, double xSrc=0, double ySrc=0, COLORREF transColor=TX_BLACK)</div><div class="ttdoc">Копирует изображение с одного холста (контекста рисования, DC) на другой с учетом прозрачности...</div></div>
<div class="ttc" id="a00059_htm_gac9d8435ced05ddc5c29a1a5c9f58f752"><div class="ttname"><a href="a00059.htm#gac9d8435ced05ddc5c29a1a5c9f58f752">txDestroyWindow</a></div><div class="ttdeci">bool txDestroyWindow()</div><div class="ttdoc">Уничтожает окно TXLib. </div></div>
<div class="ttc" id="a00061_htm_ga364e78410e64fb751d3a0253d08f98e2"><div class="ttname"><a href="a00061.htm#ga364e78410e64fb751d3a0253d08f98e2">txInputBox</a></div><div class="ttdeci">const char * txInputBox(const char *text=NULL, const char *caption=NULL, const char *input=NULL)</div><div class="ttdoc">Ввод строки в отдельном окне. </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04675">Example02/TXLib.h:4675</a></div></div>
<div class="ttc" id="a00061_htm_gga5b47575087d696b5fddf972ce4d83657a30e281002a3bce0b5778269b9d831b41"><div class="ttname"><a href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a30e281002a3bce0b5778269b9d831b41">txDialog::END</a></div><div class="ttdoc">Конец описания диалога </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04382">Example02/TXLib.h:4382</a></div></div>
<div class="ttc" id="a00062_htm_ga5cd767f8040c04a51cb0173bf9255247"><div class="ttname"><a href="a00062.htm#ga5cd767f8040c04a51cb0173bf9255247">TX_ERROR</a></div><div class="ttdeci">#define TX_ERROR(...)  </div><div class="ttdoc">Выводит развернутое диагностическое сообщение. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03504">Example04/TXLib.h:3504</a></div></div>
<div class="ttc" id="a00058_htm"><div class="ttname"><a href="a00058.htm">TX</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a081ac86689e98e0c036e960e9cb159ac"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a081ac86689e98e0c036e960e9cb159ac">TX_NULL</a></div><div class="ttdoc">Прозрачный цвет. Отключает рисование. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00867">Example04/TXLib.h:867</a></div></div>
<div class="ttc" id="a00059_htm_ga9f2215b90264133de36ed7c2120f75f5"><div class="ttname"><a href="a00059.htm#ga9f2215b90264133de36ed7c2120f75f5">txGetConsoleAttr</a></div><div class="ttdeci">unsigned txGetConsoleAttr()</div><div class="ttdoc">Возвращает текущие цветовые атрибуты консоли. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a1c1e8dec8618fe54eee9e569a828a504"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a1c1e8dec8618fe54eee9e569a828a504">TX_LIGHTRED</a></div><div class="ttdoc">Светло-красный цвет. Не самого лучшего оттенка. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00861">Example04/TXLib.h:861</a></div></div>
<div class="ttc" id="a00059_htm_gaef1c6ba744e887a2aab87e4694822a85"><div class="ttname"><a href="a00059.htm#gaef1c6ba744e887a2aab87e4694822a85">txPie</a></div><div class="ttdeci">bool txPie(double x0, double y0, double x1, double y1, double startAngle, double totalAngle, HDC dc=txDC(true))</div><div class="ttdoc">Рисует сектор эллипса. </div></div>
<div class="ttc" id="a00059_htm_ga505f212582bf9b2bf95a4ef15f84af42"><div class="ttname"><a href="a00059.htm#ga505f212582bf9b2bf95a4ef15f84af42">txDeleteDC</a></div><div class="ttdeci">bool txDeleteDC(HDC dc)</div><div class="ttdoc">Уничтожает холст (контекст рисования, DC) в памяти. </div></div>
<div class="ttc" id="a00062_htm_ga0eb921342afd27ed2bf8a78f97872577"><div class="ttname"><a href="a00062.htm#ga0eb921342afd27ed2bf8a78f97872577">txNotifyIcon</a></div><div class="ttdeci">bool txNotifyIcon(unsigned flags, const char title[], const char format[],...) _TX_CHECK_FORMAT(3)</div><div class="ttdoc">Выводит всплывающее сообщение в системном трее. </div></div>
<div class="ttc" id="a00015_htm_a7b87eb977476f0d637336e9b8c580943"><div class="ttname"><a href="a00015.htm#a7b87eb977476f0d637336e9b8c580943">txAutoLock::txAutoLock</a></div><div class="ttdeci">_tx_explicit txAutoLock(bool mandatory=true)</div><div class="ttdoc">Конструктор для блокировки холста TXLib. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04277">Example04/TXLib.h:4277</a></div></div>
<div class="ttc" id="a00059_htm_gae47b05ec325f3bda871e46c8c74919e8"><div class="ttname"><a href="a00059.htm#gae47b05ec325f3bda871e46c8c74919e8">txWindow</a></div><div class="ttdeci">HWND txWindow()</div><div class="ttdoc">Возвращает дескриптор окна рисования </div></div>
<div class="ttc" id="a00059_htm_gae92e621aaed81f90e4d142356e38762a"><div class="ttname"><a href="a00059.htm#gae92e621aaed81f90e4d142356e38762a">txBegin</a></div><div class="ttdeci">int txBegin()</div><div class="ttdoc">Блокирует обновление изображения окна, во избежание мигания. </div></div>
<div class="ttc" id="a00064_htm_ga9a495d013c6f08cd50220aca99ca56c2"><div class="ttname"><a href="a00064.htm#ga9a495d013c6f08cd50220aca99ca56c2">_TX_ALLOW_KILL_PARENT</a></div><div class="ttdeci">#define _TX_ALLOW_KILL_PARENT</div><div class="ttdoc">Разрешать принудительное завершение вызывающих программ, ждущих нажатия клавиш после завершения TXLib...</div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04030">Example04/TXLib.h:4030</a></div></div>
<div class="ttc" id="a00059_htm_gaff3d9c60900531f438a19216485bdd41"><div class="ttname"><a href="a00059.htm#gaff3d9c60900531f438a19216485bdd41">txUpdateWindow</a></div><div class="ttdeci">int txUpdateWindow(int update=true)</div><div class="ttdoc">Разрешает или запрещает автоматическое обновление изображения в окне. </div></div>
<div class="ttc" id="a00064_htm_ga7859e95fc4faec435abe372989f4f8ac"><div class="ttname"><a href="a00064.htm#ga7859e95fc4faec435abe372989f4f8ac">_TX_TIMEOUT</a></div><div class="ttdeci">const int _TX_TIMEOUT</div><div class="ttdoc">Таймаут операций ожидания (мс) </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03955">Example04/TXLib.h:3955</a></div></div>
<div class="ttc" id="a00059_htm_ga56227ddccbe156355eaca50264bf3334"><div class="ttname"><a href="a00059.htm#ga56227ddccbe156355eaca50264bf3334">txSleep</a></div><div class="ttdeci">double txSleep(double time)</div><div class="ttdoc">Задерживает выполнение программы на определенное время. </div></div>
<div class="ttc" id="a00059_htm_ga6971b22d5486b242e20a8dea1f21422a"><div class="ttname"><a href="a00059.htm#ga6971b22d5486b242e20a8dea1f21422a">txOK</a></div><div class="ttdeci">bool txOK()</div><div class="ttdoc">Проверка правильности работы библиотеки </div></div>
<div class="ttc" id="a00064_htm_ga2c0a4fe0612f109c5c88d6d55a061db5"><div class="ttname"><a href="a00064.htm#ga2c0a4fe0612f109c5c88d6d55a061db5">_TX_WAITABLE_PARENTS</a></div><div class="ttdeci">#define _TX_WAITABLE_PARENTS</div><div class="ttdoc">Список запускающих программ, которые ждут нажатия клавиши после завершения процесса TXLib...</div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03999">Example04/TXLib.h:3999</a></div></div>
<div class="ttc" id="a00059_htm_ga3b4c1a73b014daa67100c9dbb875f3bf"><div class="ttname"><a href="a00059.htm#ga3b4c1a73b014daa67100c9dbb875f3bf">txSetConsoleAttr</a></div><div class="ttdeci">bool txSetConsoleAttr(unsigned colors=0x07)</div><div class="ttdoc">Устанавливает цветовые атрибуты консоли. </div></div>
<div class="ttc" id="a00060_htm_ga572acf2310d35defaa9a37a2ec260576"><div class="ttname"><a href="a00060.htm#ga572acf2310d35defaa9a37a2ec260576">txMouseY</a></div><div class="ttdeci">int txMouseY()</div><div class="ttdoc">Возвращает Y-Координату Мыши! </div></div>
<div class="ttc" id="a00059_htm_ga4eb8174c83ee96b076204ac87914f726"><div class="ttname"><a href="a00059.htm#ga4eb8174c83ee96b076204ac87914f726">txDC</a></div><div class="ttdeci">HDC &amp; txDC(bool forced=false)</div><div class="ttdoc">Возвращает дескриптор контекста рисования основного холста </div></div>
<div class="ttc" id="a00059_htm_gafad118f7658b7fc982ad5b052ed6d296"><div class="ttname"><a href="a00059.htm#gafad118f7658b7fc982ad5b052ed6d296">txSetROP2</a></div><div class="ttdeci">bool txSetROP2(int mode=R2_COPYPEN, HDC dc=txDC(true))</div><div class="ttdoc">Устанавливает режим взаимодействия цветов при рисовании. </div></div>
<div class="ttc" id="a00059_htm_ga84acaeb16745f95fa84b22e48f4d351f"><div class="ttname"><a href="a00059.htm#ga84acaeb16745f95fa84b22e48f4d351f">txGetPixel</a></div><div class="ttdeci">COLORREF txGetPixel(double x, double y, HDC dc=txDC(true))</div><div class="ttdoc">Возвращает текущий цвет точки (пикселя) на экране. </div></div>
<div class="ttc" id="a00062_htm_gaa4558a3bf2a126a9e19c5a3655520787"><div class="ttname"><a href="a00062.htm#gaa4558a3bf2a126a9e19c5a3655520787">random</a></div><div class="ttdeci">int random(int range)</div><div class="ttdoc">Генератор случайных чисел </div></div>
<div class="ttc" id="a00059_htm_ga446033e514db3f5b4f0ac9ae511cb1f6"><div class="ttname"><a href="a00059.htm#ga446033e514db3f5b4f0ac9ae511cb1f6">txGetColor</a></div><div class="ttdeci">COLORREF txGetColor(HDC dc=txDC(true))</div><div class="ttdoc">Возвращает текущий цвет линий и текста. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a342ad901a39ab4b40f091f6699b64927"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a342ad901a39ab4b40f091f6699b64927">TX_RED</a></div><div class="ttdoc">Темно-красный цвет. Слишком темный. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00851">Example04/TXLib.h:851</a></div></div>
<div class="ttc" id="a00062_htm_ga61997e2af7f7c3d2e40ef9a612000220"><div class="ttname"><a href="a00062.htm#ga61997e2af7f7c3d2e40ef9a612000220">TX_DEBUG_ERROR</a></div><div class="ttdeci">#define TX_DEBUG_ERROR</div><div class="ttdoc">Выводит развернутое диагностическое сообщение в отладочном режиме. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03531">Example04/TXLib.h:3531</a></div></div>
<div class="ttc" id="a00062_htm_gae4dfd7b0d66121016d6466d2ff10e8ba"><div class="ttname"><a href="a00062.htm#gae4dfd7b0d66121016d6466d2ff10e8ba">_</a></div><div class="ttdeci">#define _</div><div class="ttdoc">Макрос, позволяющий передать переменное число параметров в какой-либо другой макрос. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03574">Example04/TXLib.h:3574</a></div></div>
<div class="ttc" id="a00059_htm_ga5320ee0e9d6a16dbe492d28158eb33ec"><div class="ttname"><a href="a00059.htm#ga5320ee0e9d6a16dbe492d28158eb33ec">txColor</a></div><div class="ttdeci">bool txColor(double red, double green, double blue, double thickness=1, HDC dc=txDC(true))</div><div class="ttdoc">Устанавливает текущий цвет линий и текста. </div></div>
<div class="ttc" id="a00059_htm_ga9740c30c000a8163acb3a7b6a8f7edc4"><div class="ttname"><a href="a00059.htm#ga9740c30c000a8163acb3a7b6a8f7edc4">txSetFillColor</a></div><div class="ttdeci">bool txSetFillColor(COLORREF color, HDC dc=txDC(true))</div><div class="ttdoc">Устанавливает текущий цвет заполнения фигур. </div></div>
<div class="ttc" id="a00061_htm_gga5b47575087d696b5fddf972ce4d83657ada5bcedb21f2f49324595669e7b54cc7"><div class="ttname"><a href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657ada5bcedb21f2f49324595669e7b54cc7">txDialog::DIALOG</a></div><div class="ttdoc">Начало описания диалога </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04375">Example02/TXLib.h:4375</a></div></div>
<div class="ttc" id="a00059_htm_gae9753c8c27223efbbe87be36d6525359"><div class="ttname"><a href="a00059.htm#gae9753c8c27223efbbe87be36d6525359">txGetTextExtentX</a></div><div class="ttdeci">int txGetTextExtentX(const char text[], HDC dc=txDC(true))</div><div class="ttdoc">Вычисляет ширину текстовой надписи. </div></div>
<div class="ttc" id="a00063_htm_gafdd807831b131ba38d5856b6ee4e8287"><div class="ttname"><a href="a00063.htm#gafdd807831b131ba38d5856b6ee4e8287">txGDI</a></div><div class="ttdeci">#define txGDI(command, dc)</div><div class="ttdoc">Вызов функции Win32 GDI с автоматической блокировкой и разблокировкой. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03832">Example04/TXLib.h:3832</a></div></div>
<div class="ttc" id="a00064_htm_ga352331b32407c4e95bc4f7a5e39fad25"><div class="ttname"><a href="a00064.htm#ga352331b32407c4e95bc4f7a5e39fad25">_TX_BUFSIZE</a></div><div class="ttdeci">const unsigned _TX_BUFSIZE</div><div class="ttdoc">Размеры внутренних статических строковых буферов TXLib. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03972">Example04/TXLib.h:3972</a></div></div>
<div class="ttc" id="a00059_htm_ga3227242c57eef33049cdaee655f4faee"><div class="ttname"><a href="a00059.htm#ga3227242c57eef33049cdaee655f4faee">txGetConsoleCursorPos</a></div><div class="ttdeci">POINT txGetConsoleCursorPos()</div><div class="ttdoc">Возвращает позицию мигающего курсора консоли. </div></div>
<div class="ttc" id="a00016_htm_ae1990ecaf5a955c66eae928aa0d9c896"><div class="ttname"><a href="a00016.htm#ae1990ecaf5a955c66eae928aa0d9c896">txDialog::dialogBox</a></div><div class="ttdeci">INT_PTR dialogBox(const Layout *layout=NULL, size_t bufsize=0)</div><div class="ttdoc">Запускает диалоговое окно. </div></div>
<div class="ttc" id="a00062_htm_ga0d2f29556bce1d021656c3ca520c7957"><div class="ttname"><a href="a00062.htm#ga0d2f29556bce1d021656c3ca520c7957">In</a></div><div class="ttdeci">bool In(Tx x, Ta a, Tb b)</div><div class="ttdoc">Проверка, находится ли параметр х внутри замкнутого интервала [a; b]. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5aec305e1fce8a99fca3c442364389e22b"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aec305e1fce8a99fca3c442364389e22b">TX_MAGENTA</a></div><div class="ttdoc">Темно-малиновый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00852">Example04/TXLib.h:852</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a00514ed69e9dd0fafeb324c0258f9030"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a00514ed69e9dd0fafeb324c0258f9030">TX_LIGHTBLUE</a></div><div class="ttdoc">Светло-синий цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00858">Example04/TXLib.h:858</a></div></div>
<div class="ttc" id="a00062_htm_ga7b470eef58eabacf9c7820ce6d392506"><div class="ttname"><a href="a00062.htm#ga7b470eef58eabacf9c7820ce6d392506">txDump</a></div><div class="ttdeci">void txDump(const void *address, const char name[]=&quot;txDump()&quot;)</div><div class="ttdoc">Распечатывает дамп области памяти в консоли. </div></div>
<div class="ttc" id="a00016_htm_a39efe9383833aedb0839d2519173930e"><div class="ttname"><a href="a00016.htm#a39efe9383833aedb0839d2519173930e">txDialog::dialogProc</a></div><div class="ttdeci">virtual int dialogProc(HWND _wnd, UINT _msg, WPARAM _wParam, LPARAM _lParam)</div><div class="ttdoc">Функция обработки сообщений диалогового окна. </div></div>
<div class="ttc" id="a00059_htm_ga1a87b7cd3e5a74e4dc6828d42d03fffa"><div class="ttname"><a href="a00059.htm#ga1a87b7cd3e5a74e4dc6828d42d03fffa">txHSL2RGB</a></div><div class="ttdeci">COLORREF txHSL2RGB(COLORREF hslColor)</div><div class="ttdoc">Преобразует цвет из формата HSL в формат RGB. </div></div>
<div class="ttc" id="a00060_htm_ga9da82cc7df5b5e082153f20b206762b4"><div class="ttname"><a href="a00060.htm#ga9da82cc7df5b5e082153f20b206762b4">txMouseButtons</a></div><div class="ttdeci">unsigned txMouseButtons()</div><div class="ttdoc">Возвращает состояние Кнопок Мыши! </div></div>
<div class="ttc" id="a00059_htm_gaa148d2040d20ed74cf46ab186c35f9ed"><div class="ttname"><a href="a00059.htm#gaa148d2040d20ed74cf46ab186c35f9ed">txTextCursor</a></div><div class="ttdeci">bool txTextCursor(bool blink=true)</div><div class="ttdoc">Запрещает или разрешает рисование мигающего курсора в окне. </div></div>
<div class="ttc" id="a00062_htm_ga889b74443b3e918adee3e31fad4653f7"><div class="ttname"><a href="a00062.htm#ga889b74443b3e918adee3e31fad4653f7">asserted</a></div><div class="ttdeci">#define asserted</div><div class="ttdoc">Выводит диагностическое сообщение в случае нулевого или ложного результата. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03417">Example04/TXLib.h:3417</a></div></div>
<div class="ttc" id="a00063_htm_ga8fe4ec4c66cb69ce337747fe65dd0cc6"><div class="ttname"><a href="a00063.htm#ga8fe4ec4c66cb69ce337747fe65dd0cc6">txUnlock</a></div><div class="ttdeci">bool txUnlock()</div><div class="ttdoc">Разблокировка холста </div></div>
<div class="ttc" id="a00059_htm_ga06d8ecdb7983dc884692c2543fb579c6"><div class="ttname"><a href="a00059.htm#ga06d8ecdb7983dc884692c2543fb579c6">txGetModuleFileName</a></div><div class="ttdeci">const char * txGetModuleFileName(bool fileNameOnly=true)</div><div class="ttdoc">Возвращает имя исполняемого файла или изначальный заголовок окна TXLib. </div></div>
<div class="ttc" id="a00062_htm_ga74ff1048e0d6bc458c9904fbbe0a6026"><div class="ttname"><a href="a00062.htm#ga74ff1048e0d6bc458c9904fbbe0a6026">txSqr</a></div><div class="ttdeci">double txSqr(double x)</div><div class="ttdoc">Очень удобное возведение числа в квадрат. </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l03135">Example02/TXLib.h:3135</a></div></div>
<div class="ttc" id="a00059_htm_ga09488931ddf7b1e7e0b31529e1904887"><div class="ttname"><a href="a00059.htm#ga09488931ddf7b1e7e0b31529e1904887">txBitBlt</a></div><div class="ttdeci">bool txBitBlt(HDC dest, double xDest, double yDest, double width, double height, HDC src, double xSrc=0, double ySrc=0, DWORD rOp=SRCCOPY)</div><div class="ttdoc">Копирует изображение с одного холста (контекста рисования, DC) на другой. </div></div>
<div class="ttc" id="a00061_htm_gga5b47575087d696b5fddf972ce4d83657a289c2dfb5643a7b29a82b1911d7ad9d0"><div class="ttname"><a href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a289c2dfb5643a7b29a82b1911d7ad9d0">txDialog::STATIC</a></div><div class="ttdoc">Нередактируемый элемент (текст, картинка и т.д.) </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04378">Example02/TXLib.h:4378</a></div></div>
<div class="ttc" id="a00059_htm_gafce21ce98474d5559f316b3d47cdbfab"><div class="ttname"><a href="a00059.htm#gafce21ce98474d5559f316b3d47cdbfab">txCreateWindow</a></div><div class="ttdeci">HWND txCreateWindow(double sizeX, double sizeY, bool centered=true)</div><div class="ttdoc">Создание окна рисования </div></div>
<div class="ttc" id="a00062_htm_ga3e287c38947fea870d01588fbd2a5fc9"><div class="ttname"><a href="a00062.htm#ga3e287c38947fea870d01588fbd2a5fc9">_TX_BUILDMODE</a></div><div class="ttdeci">#define _TX_BUILDMODE</div><div class="ttdoc">Имя режима сборки </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03657">Example04/TXLib.h:3657</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5ae45f1e493cce7ef326f8bd9e8c684c6b"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ae45f1e493cce7ef326f8bd9e8c684c6b">TX_LIGHTGREEN</a></div><div class="ttdoc">Светло-зеленый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00859">Example04/TXLib.h:859</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5acc91e717a52d475213f0201bfae5341e"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5acc91e717a52d475213f0201bfae5341e">TX_LIGHTNESS</a></div><div class="ttdoc">Светлота цвета в модели HSL. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00873">Example04/TXLib.h:873</a></div></div>
<div class="ttc" id="a00059_htm_ga2f1b4b81b2b9280bb58c2d79930e2a63"><div class="ttname"><a href="a00059.htm#ga2f1b4b81b2b9280bb58c2d79930e2a63">txCreateCompatibleDC</a></div><div class="ttdeci">HDC txCreateCompatibleDC(double sizeX, double sizeY, HBITMAP bitmap=NULL)</div><div class="ttdoc">Создает дополнительный холст (контекст рисования, Device Context, DC) в памяти. </div></div>
<div class="ttc" id="a00059_htm_ga28123a5be2ad65c41550ccb558138476"><div class="ttname"><a href="a00059.htm#ga28123a5be2ad65c41550ccb558138476">txLoadImage</a></div><div class="ttdeci">HDC txLoadImage(const char filename[], unsigned imageFlags=IMAGE_BITMAP, unsigned loadFlags=LR_LOADFROMFILE)</div><div class="ttdoc">Загружает из файла изображение в формате BMP. Делает это довольно медленно. </div></div>
<div class="ttc" id="a00062_htm_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="a00062.htm#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdoc">Округляет число до целого </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03066">Example04/TXLib.h:3066</a></div></div>
<div class="ttc" id="a00062_htm_gaf13b370e460b5a25a00c37c1a1c10927"><div class="ttname"><a href="a00062.htm#gaf13b370e460b5a25a00c37c1a1c10927">SIZEARR</a></div><div class="ttdeci">#define SIZEARR(arr)            </div><div class="ttdoc">Замена макросу sizearr() для работы в Microsoft Visual Studio 6. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l02860">Example04/TXLib.h:2860</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a3f59cd6ad2f1c2cea3f1b4f93baae64d"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a3f59cd6ad2f1c2cea3f1b4f93baae64d">TX_CYAN</a></div><div class="ttdoc">Бирюзовый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00850">Example04/TXLib.h:850</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5ad71bcc76691c708c653567bc70129e4b"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ad71bcc76691c708c653567bc70129e4b">TX_BROWN</a></div><div class="ttdoc">Коричневый цвет. Некрасивый. Do it yourself with RGB(). </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00853">Example04/TXLib.h:853</a></div></div>
<div class="ttc" id="a00059_htm_ga14ba2d5b1dfdfd09e94248d3ecd808a3"><div class="ttname"><a href="a00059.htm#ga14ba2d5b1dfdfd09e94248d3ecd808a3">txArc</a></div><div class="ttdeci">bool txArc(double x0, double y0, double x1, double y1, double startAngle, double totalAngle, HDC dc=txDC(true))</div><div class="ttdoc">Рисует дугу эллипса. </div></div>
<div class="ttc" id="a00059_htm_ga96652018e2f835ab629ddf52c1686d67"><div class="ttname"><a href="a00059.htm#ga96652018e2f835ab629ddf52c1686d67">txSetDefaults</a></div><div class="ttdeci">bool txSetDefaults(HDC dc=txDC(true))</div><div class="ttdoc">Установка параметров рисования по умолчанию. </div></div>
<div class="ttc" id="a00059_htm_gab19f6b1ecae9e2fc07ad73bd34741391"><div class="ttname"><a href="a00059.htm#gab19f6b1ecae9e2fc07ad73bd34741391">txPixel</a></div><div class="ttdeci">bool txPixel(double x, double y, double red, double green, double blue, HDC dc=txDC(true))</div><div class="ttdoc">Рисует пиксель (точку на экране). </div></div>
<div class="ttc" id="a00059_htm_ga809dc04afd5348247846ee01ce9a06e6"><div class="ttname"><a href="a00059.htm#ga809dc04afd5348247846ee01ce9a06e6">txEnd</a></div><div class="ttdeci">int txEnd()</div><div class="ttdoc">Разблокирует обновление окна, заблокированное функцией txBegin(). </div></div>
<div class="ttc" id="a00059_htm_gaebe0b0f6b1324031ee6b9461ba5b0ab3"><div class="ttname"><a href="a00059.htm#gaebe0b0f6b1324031ee6b9461ba5b0ab3">txQueryPerformance</a></div><div class="ttdeci">double txQueryPerformance()</div><div class="ttdoc">Оценивает скорость работы компьютера. </div></div>
<div class="ttc" id="a00059_htm_ga1dc38c08e812d5f5a3c8f752a97c2bb2"><div class="ttname"><a href="a00059.htm#ga1dc38c08e812d5f5a3c8f752a97c2bb2">txFontExist</a></div><div class="ttdeci">LOGFONT * txFontExist(const char name[])</div><div class="ttdoc">Ищет шрифт по его названию. </div></div>
<div class="ttc" id="a00059_htm_gad96050bbebe02ac99a81ce3878b7b316"><div class="ttname"><a href="a00059.htm#gad96050bbebe02ac99a81ce3878b7b316">txExtractColor</a></div><div class="ttdeci">unsigned txExtractColor(COLORREF color, COLORREF component)</div><div class="ttdoc">Извлекает цветовую компоненту (цветовой канал) из смешанного цвета. </div></div>
<div class="ttc" id="a00064_htm_ga61836072e0c3887ed70841ff2d12c0d9"><div class="ttname"><a href="a00064.htm#ga61836072e0c3887ed70841ff2d12c0d9">_txConsoleFont</a></div><div class="ttdeci">const char * _txConsoleFont</div><div class="ttdoc">Шрифт консоли </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03932">Example04/TXLib.h:3932</a></div></div>
<div class="ttc" id="a00064_htm_gaf2070fcdbd473d328f17f130623db80a"><div class="ttname"><a href="a00064.htm#gaf2070fcdbd473d328f17f130623db80a">_txWindowUpdateInterval</a></div><div class="ttdeci">unsigned _txWindowUpdateInterval</div><div class="ttdoc">Интервал обновления холста (мс) </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03947">Example04/TXLib.h:3947</a></div></div>
<div class="ttc" id="a00062_htm_ga62a815bcebe103c8d30f23a878615988"><div class="ttname"><a href="a00062.htm#ga62a815bcebe103c8d30f23a878615988">MAX</a></div><div class="ttdeci">#define MAX(a, b)      </div><div class="ttdoc">Возвращает максимальное из двух чисел </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03019">Example04/TXLib.h:3019</a></div></div>
<div class="ttc" id="a00015_htm"><div class="ttname"><a href="a00015.htm">txAutoLock</a></div><div class="ttdoc">Класс для автоматической блокировки и разблокировки критической секции. </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04225">Example02/TXLib.h:4225</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a01fe8cb0f589868456167ee3a4652df8">TX_TRANSPARENT</a></div><div class="ttdoc">Прозрачный цвет. Отключает рисование. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00866">Example04/TXLib.h:866</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5abec0ab16c8a1ed55e137c20f80cdd25e"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5abec0ab16c8a1ed55e137c20f80cdd25e">TX_LIGHTGRAY</a></div><div class="ttdoc">Светло-серый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00857">Example04/TXLib.h:857</a></div></div>
<div class="ttc" id="a00059_htm_ga8826459bc7d9b47431c2c0ef214bce8b"><div class="ttname"><a href="a00059.htm#ga8826459bc7d9b47431c2c0ef214bce8b">txFillColor</a></div><div class="ttdeci">bool txFillColor(double red, double green, double blue, HDC dc=txDC(true))</div><div class="ttdoc">Устанавливает текущий цвет заполнения фигур. </div></div>
<div class="ttc" id="a00059_htm_ga2cb63c12d9206e9ed2b2c83c9a08f68e"><div class="ttname"><a href="a00059.htm#ga2cb63c12d9206e9ed2b2c83c9a08f68e">txClearConsole</a></div><div class="ttdeci">bool txClearConsole()</div><div class="ttdoc">Стирает текст консоли. </div></div>
<div class="ttc" id="a00057_htm"><div class="ttname"><a href="a00057.htm">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="a00059_htm_gaffd22a69ddbcfae7ac35ee3a6aac68a4"><div class="ttname"><a href="a00059.htm#gaffd22a69ddbcfae7ac35ee3a6aac68a4">txSetPixel</a></div><div class="ttdeci">bool txSetPixel(double x, double y, COLORREF color, HDC dc=txDC(true))</div><div class="ttdoc">Рисует пиксель (точку на экране). </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5ae197423002e969d08646554e8b647454"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ae197423002e969d08646554e8b647454">TX_PINK</a></div><div class="ttdoc">Розовый гламурный :) </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00863">Example04/TXLib.h:863</a></div></div>
<div class="ttc" id="a00062_htm_gae35d0d923c790c414ad586db1919852e"><div class="ttname"><a href="a00062.htm#gae35d0d923c790c414ad586db1919852e">txMessageBox</a></div><div class="ttdeci">int txMessageBox(const char *text, const char *header=&quot;TXLib сообщает&quot;, unsigned flags=0)</div><div class="ttdoc">Выводит сообщение в окне с помощью функции MessageBox. </div></div>
<div class="ttc" id="a00059_htm_ga269080a240637dd6d9060b6972c1c7c6"><div class="ttname"><a href="a00059.htm#ga269080a240637dd6d9060b6972c1c7c6">txGetTextExtentY</a></div><div class="ttdeci">int txGetTextExtentY(const char text[], HDC dc=txDC(true))</div><div class="ttdoc">Вычисляет высоту текстовой надписи. </div></div>
<div class="ttc" id="a00062_htm_ga3637c3398b6ebfa337171beec0770fe4"><div class="ttname"><a href="a00062.htm#ga3637c3398b6ebfa337171beec0770fe4">TX_COMMAND_MAP</a></div><div class="ttdeci">#define TX_COMMAND_MAP</div><div class="ttdoc">Начало карты команд (Command map) в карте сообщений. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04615">Example04/TXLib.h:4615</a></div></div>
<div class="ttc" id="a00059_htm_ga3e94cfad3d9080241f84129d6e5c09b5"><div class="ttname"><a href="a00059.htm#ga3e94cfad3d9080241f84129d6e5c09b5">txColors</a></div><div class="ttdeci">txColors</div><div class="ttdoc">Названия предопределенных цветов. </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l00844">Example02/TXLib.h:844</a></div></div>
<div class="ttc" id="a00062_htm_gab170f39ac0e379c324c73495f14a1309"><div class="ttname"><a href="a00062.htm#gab170f39ac0e379c324c73495f14a1309">__TX_FUNCTION__</a></div><div class="ttdeci">#define __TX_FUNCTION__</div><div class="ttdoc">Имя текущей функции </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03643">Example04/TXLib.h:3643</a></div></div>
<div class="ttc" id="a00059_htm_gae9c886ec2e8af26ce24325c5eebaaa9c"><div class="ttname"><a href="a00059.htm#gae9c886ec2e8af26ce24325c5eebaaa9c">txClear</a></div><div class="ttdeci">bool txClear(HDC dc=txDC(true))</div><div class="ttdoc">Стирает холст текущим цветом заполнения. </div></div>
<div class="ttc" id="a00016_htm_a971fb450a33205168aff3a7b186e04a3"><div class="ttname"><a href="a00016.htm#a971fb450a33205168aff3a7b186e04a3">txDialog::setLayout</a></div><div class="ttdeci">const Layout * setLayout(const Layout *layout)</div><div class="ttdoc">Устанавливает текущий макет диалогового окна. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5af3ef6cac77e7ca01e271a3562ceeb52f"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5af3ef6cac77e7ca01e271a3562ceeb52f">TX_LIGHTMAGENTA</a></div><div class="ttdoc">Светло-малиновый цвет. Еще менее лучшего оттенка. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00862">Example04/TXLib.h:862</a></div></div>
<div class="ttc" id="a00059_htm_ga6f5e36abe5f158a1b0a47e69c480f493"><div class="ttname"><a href="a00059.htm#ga6f5e36abe5f158a1b0a47e69c480f493">txGetExtentY</a></div><div class="ttdeci">int txGetExtentY(HDC dc=txDC(true))</div><div class="ttdoc">Возвращает высоту окна холста. </div></div>
<div class="ttc" id="a00013_htm"><div class="ttname"><a href="a00013.htm">txDialog::Layout</a></div><div class="ttdoc">Класс для описания элемента диалогового окна (контрола) </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04405">Example02/TXLib.h:4405</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5aac23422a0b96bfc917484ba1fb0990de"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aac23422a0b96bfc917484ba1fb0990de">TX_BLUE</a></div><div class="ttdoc">Темно-синий цвет. Плохо виден. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00848">Example04/TXLib.h:848</a></div></div>
<div class="ttc" id="a00015_htm_a838aae52b26597bf7aa0cd931611dca4"><div class="ttname"><a href="a00015.htm#a838aae52b26597bf7aa0cd931611dca4">txAutoLock::~txAutoLock</a></div><div class="ttdeci">~txAutoLock()</div><div class="ttdoc">Деструктор, разблокирует секцию </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l04287">Example04/TXLib.h:4287</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a18419bb9192c947fb25d517765dd04cc"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a18419bb9192c947fb25d517765dd04cc">TX_SATURATION</a></div><div class="ttdoc">Насыщенность цвета в модели HSL. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00872">Example04/TXLib.h:872</a></div></div>
<div class="ttc" id="a00064_htm_gacc95bfbcf7a0f9124e8cd5e80d0b3cd3"><div class="ttname"><a href="a00064.htm#gacc95bfbcf7a0f9124e8cd5e80d0b3cd3">_txCursorBlinkInterval</a></div><div class="ttdeci">unsigned _txCursorBlinkInterval</div><div class="ttdoc">Интервал мигания курсора консоли (мс) </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03939">Example04/TXLib.h:3939</a></div></div>
<div class="ttc" id="a00059_htm_gaf5f3dec18e058830a6eb85ca127472df"><div class="ttname"><a href="a00059.htm#gaf5f3dec18e058830a6eb85ca127472df">txTriangle</a></div><div class="ttdeci">bool txTriangle(double x1, double y1, double x2, double y2, double x3, double y3)</div><div class="ttdoc">Функция, которая должна бы рисовать треугольник. </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l01516">Example02/TXLib.h:1516</a></div></div>
<div class="ttc" id="a00062_htm_gadd1c9ccd036228402b807abaea14f7ee"><div class="ttname"><a href="a00062.htm#gadd1c9ccd036228402b807abaea14f7ee">__TX_COMPILER__</a></div><div class="ttdeci">#define __TX_COMPILER__</div><div class="ttdoc">Имя и версия текущего компилятора </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03599">Example04/TXLib.h:3599</a></div></div>
<div class="ttc" id="a00059_htm_gaa14e9c2a46cf713efaa1f850074d8adc"><div class="ttname"><a href="a00059.htm#gaa14e9c2a46cf713efaa1f850074d8adc">txCircle</a></div><div class="ttdeci">bool txCircle(double x, double y, double r)</div><div class="ttdoc">Рисует окружность или круг. </div></div>
<div class="ttc" id="a00062_htm_gada1fc1ec7742eaee6a6268966f7ac065"><div class="ttname"><a href="a00062.htm#gada1fc1ec7742eaee6a6268966f7ac065">MIN</a></div><div class="ttdeci">#define MIN(a, b)      </div><div class="ttdoc">Возвращает минимальное из двух чисел </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03042">Example04/TXLib.h:3042</a></div></div>
<div class="ttc" id="a00059_htm_gacd2416cd6b89106ab6700d0c75922bee"><div class="ttname"><a href="a00059.htm#gacd2416cd6b89106ab6700d0c75922bee">txVersionNumber</a></div><div class="ttdeci">unsigned txVersionNumber()</div><div class="ttdoc">Возвращает номер версии библиотеки. </div></div>
<div class="ttc" id="a00059_htm_ga93cecf6b117fc403c0488f388b78a6d1"><div class="ttname"><a href="a00059.htm#ga93cecf6b117fc403c0488f388b78a6d1">txIDontWantToHaveAPauseAfterMyProgramBeforeTheWindowWillClose_AndIWillNotBeAskingWhereIsMyPicture</a></div><div class="ttdeci">bool txIDontWantToHaveAPauseAfterMyProgramBeforeTheWindowWillClose_AndIWillNotBeAskingWhereIsMyPicture()</div><div class="ttdoc">Делает нечто иногда удобное. См. название функции. </div></div>
<div class="ttc" id="a00064_htm_ga8a148ac2f04e1f9c7414af69362e0668"><div class="ttname"><a href="a00064.htm#ga8a148ac2f04e1f9c7414af69362e0668">_txConsoleMode</a></div><div class="ttdeci">int _txConsoleMode</div><div class="ttdoc">Режим отображения консольного окна. Допустимы любые флаги функции ShowWindow. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03907">Example04/TXLib.h:3907</a></div></div>
<div class="ttc" id="a00059_htm_gadbf205883201eba91653fe541baedf71"><div class="ttname"><a href="a00059.htm#gadbf205883201eba91653fe541baedf71">txSaveImage</a></div><div class="ttdeci">bool txSaveImage(const char *filename, HDC dc=txDC())</div><div class="ttdoc">Сохраняет в файл изображение в формате BMP. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a05b6100527e0b7a96dcda198a1439382"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a05b6100527e0b7a96dcda198a1439382">TX_LIGHTCYAN</a></div><div class="ttdoc">Светло-бирюзовый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00860">Example04/TXLib.h:860</a></div></div>
<div class="ttc" id="a00062_htm_ga779aead84bda35892b48c54418144d4d"><div class="ttname"><a href="a00062.htm#ga779aead84bda35892b48c54418144d4d">ZERO</a></div><div class="ttdeci">#define ZERO(type)    </div><div class="ttdoc">Обнулитель типов, не имеющих конструкторов </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03212">Example04/TXLib.h:3212</a></div></div>
<div class="ttc" id="a00059_htm_ga0fc0db1a7c287bec31625bdf3a21922e"><div class="ttname"><a href="a00059.htm#ga0fc0db1a7c287bec31625bdf3a21922e">txVersion</a></div><div class="ttdeci">const char * txVersion()</div><div class="ttdoc">Возвращает строку с информацией о текущей версии библиотеки. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5aa13a0e0eb4587540bd06cb5d55083032"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5aa13a0e0eb4587540bd06cb5d55083032">TX_GREEN</a></div><div class="ttdoc">Зеленый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00849">Example04/TXLib.h:849</a></div></div>
<div class="ttc" id="a00059_htm_ga44dbdbacdbfd2d838f1c78b48c6c4475"><div class="ttname"><a href="a00059.htm#ga44dbdbacdbfd2d838f1c78b48c6c4475">txAlphaBlend</a></div><div class="ttdeci">bool txAlphaBlend(HDC dest, double xDest, double yDest, double width, double height, HDC src, double xSrc=0, double ySrc=0, double alpha=1.0, unsigned format=AC_SRC_ALPHA)</div><div class="ttdoc">Копирует изображение с одного холста (контекста рисования, DC) на другой с учетом полупрозрачности...</div></div>
<div class="ttc" id="a00059_htm_gad4545266069ed42c29d01e7aa68d82d6"><div class="ttname"><a href="a00059.htm#gad4545266069ed42c29d01e7aa68d82d6">txSelectObject</a></div><div class="ttdeci">bool txSelectObject(HGDIOBJ obj, HDC dc=txDC(true))</div><div class="ttdoc">Устанавливает текущий активный объект GDI. </div></div>
<div class="ttc" id="a00059_htm_ga6eb18624049385b1f2a6dbf29461092e"><div class="ttname"><a href="a00059.htm#ga6eb18624049385b1f2a6dbf29461092e">txRectangle</a></div><div class="ttdeci">bool txRectangle(double x0, double y0, double x1, double y1, HDC dc=txDC(true))</div><div class="ttdoc">Рисует прямоугольник. </div></div>
<div class="ttc" id="a00059_htm_gaa7451f04a577b18cd412100fc482471e"><div class="ttname"><a href="a00059.htm#gaa7451f04a577b18cd412100fc482471e">txDrawText</a></div><div class="ttdeci">bool txDrawText(double x0, double y0, double x1, double y1, const char text[], unsigned format=DT_CENTER|DT_VCENTER|DT_WORDBREAK|DT_WORD_ELLIPSIS, HDC dc=txDC(true))</div><div class="ttdoc">Рисует текст, размещенный в прямоугольной области. </div></div>
<div class="ttc" id="a00062_htm_gaf59817ad656dcbb3f9baebeb4d7f82f7"><div class="ttname"><a href="a00062.htm#gaf59817ad656dcbb3f9baebeb4d7f82f7">txPI</a></div><div class="ttdeci">const double txPI</div><div class="ttdoc">Число Пи </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03104">Example04/TXLib.h:3104</a></div></div>
<div class="ttc" id="a00059_htm_ga2bf158fe69c8341faec28e9b1c76c5ff"><div class="ttname"><a href="a00059.htm#ga2bf158fe69c8341faec28e9b1c76c5ff">txFloodFill</a></div><div class="ttdeci">bool txFloodFill(double x, double y, COLORREF color=TX_TRANSPARENT, DWORD mode=FLOODFILLSURFACE, HDC dc=txDC(true))</div><div class="ttdoc">Заливает произвольный контур текущим цветом заполнения. </div></div>
<div class="ttc" id="a00059_htm_ga002fcc89d39312a72777ca8f08b2359e"><div class="ttname"><a href="a00059.htm#ga002fcc89d39312a72777ca8f08b2359e">txSetColor</a></div><div class="ttdeci">bool txSetColor(COLORREF color, double thickness=1, HDC dc=txDC(true))</div><div class="ttdoc">Устанавливает текущий цвет и толщину линий, цвет текста. </div></div>
<div class="ttc" id="a00059_htm_ga5e96023070a7e836d57ff9f4fac8a341"><div class="ttname"><a href="a00059.htm#ga5e96023070a7e836d57ff9f4fac8a341">RGB</a></div><div class="ttdeci">COLORREF RGB(int red, int green, int blue)</div><div class="ttdoc">Создает (смешивает) цвет из трех базовых цветов (компонент). </div></div>
<div class="ttc" id="a00059_htm_gac6ec3514093e5ac1637a883bd65d9300"><div class="ttname"><a href="a00059.htm#gac6ec3514093e5ac1637a883bd65d9300">txEllipse</a></div><div class="ttdeci">bool txEllipse(double x0, double y0, double x1, double y1, HDC dc=txDC(true))</div><div class="ttdoc">Рисует эллипс. </div></div>
<div class="ttc" id="a00061_htm_gga5b47575087d696b5fddf972ce4d83657a324e2bc01d53ba0c37be13075d8f8677"><div class="ttname"><a href="a00061.htm#gga5b47575087d696b5fddf972ce4d83657a324e2bc01d53ba0c37be13075d8f8677">txDialog::EDIT</a></div><div class="ttdoc">Редактируемый текст </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04377">Example02/TXLib.h:4377</a></div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5a5308a5fc6c34169a8af67630a5a750d5"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5a5308a5fc6c34169a8af67630a5a750d5">TX_DARKGRAY</a></div><div class="ttdoc">Темно-серый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00856">Example04/TXLib.h:856</a></div></div>
<div class="ttc" id="a00061_htm_ga5b47575087d696b5fddf972ce4d83657"><div class="ttname"><a href="a00061.htm#ga5b47575087d696b5fddf972ce4d83657">txDialog::CONTROL</a></div><div class="ttdeci">CONTROL</div><div class="ttdoc">Константы для задания типа контрола. </div><div class="ttdef"><b>Definition:</b> <a href="a00049_source.htm#l04373">Example02/TXLib.h:4373</a></div></div>
<div class="ttc" id="a00060_htm_ga452a1a7dc5d3f467c8b79b9db3ea053e"><div class="ttname"><a href="a00060.htm#ga452a1a7dc5d3f467c8b79b9db3ea053e">txMousePos</a></div><div class="ttdeci">POINT txMousePos()</div><div class="ttdoc">Возвращает позицию Мыши! </div></div>
<div class="ttc" id="a00016_htm_a081a2029ed8e4ffd6726c9f39966a04c"><div class="ttname"><a href="a00016.htm#a081a2029ed8e4ffd6726c9f39966a04c">txDialog::txDialog</a></div><div class="ttdeci">txDialog()</div><div class="ttdoc">Конструктор. </div></div>
<div class="ttc" id="a00062_htm_ga2b7cded1074eb3d4b25af75b4ffed73a"><div class="ttname"><a href="a00062.htm#ga2b7cded1074eb3d4b25af75b4ffed73a">txOutputDebugPrintf</a></div><div class="ttdeci">int txOutputDebugPrintf(const char format[],...) _TX_CHECK_FORMAT(1)</div><div class="ttdoc">Выводит сообщение в отладчике. </div></div>
<div class="ttc" id="a00059_htm_gga3e94cfad3d9080241f84129d6e5c09b5ab192f19b013a2563740be0da4e7252d9"><div class="ttname"><a href="a00059.htm#gga3e94cfad3d9080241f84129d6e5c09b5ab192f19b013a2563740be0da4e7252d9">TX_ORANGE</a></div><div class="ttdoc">Оранжевый цвет. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00854">Example04/TXLib.h:854</a></div></div>
<div class="ttc" id="a00062_htm_ga5de732de72c46b992ac2feeac2de7e42"><div class="ttname"><a href="a00062.htm#ga5de732de72c46b992ac2feeac2de7e42">tx_fpreset</a></div><div class="ttdeci">void tx_fpreset()</div><div class="ttdoc">Переинициализирует математический сопроцессор </div></div>
<div class="ttc" id="a00059_htm_gaf26a3dff59c900b9b936f6947cffc1f3"><div class="ttname"><a href="a00059.htm#gaf26a3dff59c900b9b936f6947cffc1f3">txGetExtent</a></div><div class="ttdeci">POINT txGetExtent(HDC dc=txDC(true))</div><div class="ttdoc">Возвращает размер холста в виде структуры POINT. </div></div>
<div class="ttc" id="a00064_htm_gaa7273b2f613970c283053c5d9136addd"><div class="ttname"><a href="a00064.htm#gaa7273b2f613970c283053c5d9136addd">_TX_BIGBUFSIZE</a></div><div class="ttdeci">const unsigned _TX_BIGBUFSIZE</div><div class="ttdoc">Размеры внутренних статических строковых буферов TXLib. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l03979">Example04/TXLib.h:3979</a></div></div>
<div class="ttc" id="a00064_htm_ga6b76c63cd895c2be63ac8e690028623b"><div class="ttname"><a href="a00064.htm#ga6b76c63cd895c2be63ac8e690028623b">_TX_VER</a></div><div class="ttdeci">#define _TX_VER</div><div class="ttdoc">Версия библиотеки в целочисленном формате. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.htm#l00105">Example04/TXLib.h:105</a></div></div>
<div class="ttc" id="a00059_htm_ga2d410925d21cb3b243d3eff7c63d434f"><div class="ttname"><a href="a00059.htm#ga2d410925d21cb3b243d3eff7c63d434f">txChord</a></div><div class="ttdeci">bool txChord(double x0, double y0, double x1, double y1, double startAngle, double totalAngle, HDC dc=txDC(true))</div><div class="ttdoc">Рисует хорду эллипса. </div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e710a3cbc8905e6776e05c7f4ef4f9c6.htm">Out</a></li><li class="navelem"><a class="el" href="dir_1e135ed1863429a17a8a535faa651f9b.htm">Examples</a></li><li class="navelem"><a class="el" href="dir_7612f7536ae592ea6decb8f06cc0c808.htm">Example04</a></li><li class="navelem"><b>TXLib.h</b></li>
    <li class="footer">Создано системой
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
